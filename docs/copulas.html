<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Copulas | Quantitative Finance in R</title>
  <meta name="description" content="Chapter 6 Copulas | Quantitative Finance in R" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Copulas | Quantitative Finance in R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Copulas | Quantitative Finance in R" />
  
  
  

<meta name="author" content="Nikolas Anic" />


<meta name="date" content="2022-02-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="fixed-income-securities.html"/>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<script src="libs/bootbox-4.4.0/bootbox.min.js"></script>
<script src="libs/idb-keyvalue-3.2.0/idb-keyval-iife-compat.min.js"></script>
<link href="libs/tutorial-0.10.1/tutorial.css" rel="stylesheet" />
<script src="libs/tutorial-0.10.1/tutorial.js"></script>
<script src="libs/tutorial-autocompletion-0.10.1/tutorial-autocompletion.js"></script>
<script src="libs/tutorial-diagnostics-0.10.1/tutorial-diagnostics.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">quant_finance_r</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#general-structure"><i class="fa fa-check"></i><b>1.1</b> General structure</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#notation"><i class="fa fa-check"></i><b>1.2</b> Notation</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="statistical-properties.html"><a href="statistical-properties.html"><i class="fa fa-check"></i><b>2</b> Statistical Properties</a>
<ul>
<li class="chapter" data-level="2.1" data-path="statistical-properties.html"><a href="statistical-properties.html#introduction-to-probability"><i class="fa fa-check"></i><b>2.1</b> Introduction to Probability</a></li>
<li class="chapter" data-level="2.2" data-path="statistical-properties.html"><a href="statistical-properties.html#the-concept-of-probability-important-notions-and-definitions"><i class="fa fa-check"></i><b>2.2</b> The concept of Probability: Important Notions and Definitions</a></li>
<li class="chapter" data-level="2.3" data-path="statistical-properties.html"><a href="statistical-properties.html#random-variables"><i class="fa fa-check"></i><b>2.3</b> Random Variables</a></li>
<li class="chapter" data-level="2.4" data-path="statistical-properties.html"><a href="statistical-properties.html#univariate-probability-distributions"><i class="fa fa-check"></i><b>2.4</b> Univariate Probability Distributions</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="statistical-properties.html"><a href="statistical-properties.html#discrete-random-variables-and-distributions"><i class="fa fa-check"></i><b>2.4.1</b> Discrete Random Variables and Distributions</a></li>
<li class="chapter" data-level="2.4.2" data-path="statistical-properties.html"><a href="statistical-properties.html#continuous-random-variables-and-distributions"><i class="fa fa-check"></i><b>2.4.2</b> Continuous Random Variables and Distributions</a></li>
<li class="chapter" data-level="2.4.3" data-path="statistical-properties.html"><a href="statistical-properties.html#moments-of-probability-distributions-location-scale-and-shape"><i class="fa fa-check"></i><b>2.4.3</b> Moments of Probability Distributions: Location, Scale and Shape</a></li>
<li class="chapter" data-level="2.4.4" data-path="statistical-properties.html"><a href="statistical-properties.html#quantile-based-location-scale-and-shape-parameters"><i class="fa fa-check"></i><b>2.4.4</b> Quantile-Based Location, Scale, and Shape Parameters</a></li>
<li class="chapter" data-level="2.4.5" data-path="statistical-properties.html"><a href="statistical-properties.html#the-cumulative-distribution"><i class="fa fa-check"></i><b>2.4.5</b> The cumulative Distribution</a></li>
<li class="chapter" data-level="2.4.6" data-path="statistical-properties.html"><a href="statistical-properties.html#continuous-distributions-with-appealing-properties"><i class="fa fa-check"></i><b>2.4.6</b> Continuous Distributions with Appealing Properties</a></li>
<li class="chapter" data-level="2.4.7" data-path="statistical-properties.html"><a href="statistical-properties.html#generalized-error-distribution"><i class="fa fa-check"></i><b>2.4.7</b> Generalized Error Distribution</a></li>
<li class="chapter" data-level="2.4.8" data-path="statistical-properties.html"><a href="statistical-properties.html#creating-skewed-distributions-based-on-symmetric-distributions"><i class="fa fa-check"></i><b>2.4.8</b> Creating Skewed Distributions based on Symmetric Distributions</a></li>
<li class="chapter" data-level="2.4.9" data-path="statistical-properties.html"><a href="statistical-properties.html#kernel-density-estimation"><i class="fa fa-check"></i><b>2.4.9</b> Kernel Density Estimation</a></li>
<li class="chapter" data-level="2.4.10" data-path="statistical-properties.html"><a href="statistical-properties.html#heavy-tail-distributions"><i class="fa fa-check"></i><b>2.4.10</b> Heavy Tail Distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="statistical-properties.html"><a href="statistical-properties.html#bivariate-distributions"><i class="fa fa-check"></i><b>2.5</b> Bivariate distributions</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="statistical-properties.html"><a href="statistical-properties.html#bivariate-distributions-for-continuous-random-variables"><i class="fa fa-check"></i><b>2.5.1</b> Bivariate Distributions for continuous random variables</a></li>
<li class="chapter" data-level="2.5.2" data-path="statistical-properties.html"><a href="statistical-properties.html#standard-bivariate-normal-distribution"><i class="fa fa-check"></i><b>2.5.2</b> Standard bivariate normal distribution</a></li>
<li class="chapter" data-level="2.5.3" data-path="statistical-properties.html"><a href="statistical-properties.html#marginal-distributions"><i class="fa fa-check"></i><b>2.5.3</b> Marginal Distributions</a></li>
<li class="chapter" data-level="2.5.4" data-path="statistical-properties.html"><a href="statistical-properties.html#conditional-distributions"><i class="fa fa-check"></i><b>2.5.4</b> Conditional Distributions</a></li>
<li class="chapter" data-level="2.5.5" data-path="statistical-properties.html"><a href="statistical-properties.html#independence"><i class="fa fa-check"></i><b>2.5.5</b> Independence</a></li>
<li class="chapter" data-level="2.5.6" data-path="statistical-properties.html"><a href="statistical-properties.html#correlation-and-covariance"><i class="fa fa-check"></i><b>2.5.6</b> Correlation and Covariance</a></li>
<li class="chapter" data-level="2.5.7" data-path="statistical-properties.html"><a href="statistical-properties.html#expectation-and-variance-of-the-sum-of-two-random-variables"><i class="fa fa-check"></i><b>2.5.7</b> Expectation and variance of the sum of two random variables</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="statistical-properties.html"><a href="statistical-properties.html#multivariate-probability-distributions"><i class="fa fa-check"></i><b>2.6</b> Multivariate Probability Distributions</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="statistical-properties.html"><a href="statistical-properties.html#covariance-and-correlation-matrices"><i class="fa fa-check"></i><b>2.6.1</b> Covariance and Correlation Matrices</a></li>
<li class="chapter" data-level="2.6.2" data-path="statistical-properties.html"><a href="statistical-properties.html#linear-functions-of-random-variables"><i class="fa fa-check"></i><b>2.6.2</b> Linear Functions of random variables</a></li>
<li class="chapter" data-level="2.6.3" data-path="statistical-properties.html"><a href="statistical-properties.html#central-properties-of-multivariate-distributions"><i class="fa fa-check"></i><b>2.6.3</b> Central properties of multivariate distributions</a></li>
<li class="chapter" data-level="2.6.4" data-path="statistical-properties.html"><a href="statistical-properties.html#the-scatterplot-matrix"><i class="fa fa-check"></i><b>2.6.4</b> The Scatterplot Matrix</a></li>
<li class="chapter" data-level="2.6.5" data-path="statistical-properties.html"><a href="statistical-properties.html#multivariate-normal-distribution"><i class="fa fa-check"></i><b>2.6.5</b> Multivariate Normal Distribution</a></li>
<li class="chapter" data-level="2.6.6" data-path="statistical-properties.html"><a href="statistical-properties.html#normal-mixture-models"><i class="fa fa-check"></i><b>2.6.6</b> Normal Mixture Models</a></li>
<li class="chapter" data-level="2.6.7" data-path="statistical-properties.html"><a href="statistical-properties.html#the-fisher-information-matrix"><i class="fa fa-check"></i><b>2.6.7</b> The Fisher Information Matrix</a></li>
<li class="chapter" data-level="2.6.8" data-path="statistical-properties.html"><a href="statistical-properties.html#dimensionality-reduction-techniques-principal-component-analysis-pca"><i class="fa fa-check"></i><b>2.6.8</b> Dimensionality Reduction Techniques: Principal Component Analysis (PCA)</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="statistical-properties.html"><a href="statistical-properties.html#matrix-algebra-introduction"><i class="fa fa-check"></i><b>2.7</b> Matrix Algebra: Introduction</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="statistical-properties.html"><a href="statistical-properties.html#matrices-and-vectors"><i class="fa fa-check"></i><b>2.7.1</b> Matrices and Vectors</a></li>
<li class="chapter" data-level="2.7.2" data-path="statistical-properties.html"><a href="statistical-properties.html#basic-matrix-operations"><i class="fa fa-check"></i><b>2.7.2</b> Basic Matrix Operations</a></li>
<li class="chapter" data-level="2.7.3" data-path="statistical-properties.html"><a href="statistical-properties.html#summation-notation-in-matrix-form"><i class="fa fa-check"></i><b>2.7.3</b> Summation Notation in Matrix Form</a></li>
<li class="chapter" data-level="2.7.4" data-path="statistical-properties.html"><a href="statistical-properties.html#systems-of-linear-equations"><i class="fa fa-check"></i><b>2.7.4</b> Systems of Linear Equations</a></li>
<li class="chapter" data-level="2.7.5" data-path="statistical-properties.html"><a href="statistical-properties.html#positive-definite-pd-matrix"><i class="fa fa-check"></i><b>2.7.5</b> Positive Definite (PD) Matrix</a></li>
<li class="chapter" data-level="2.7.6" data-path="statistical-properties.html"><a href="statistical-properties.html#portfolio-construction-and-mathematical-properties-using-matrix-algebra"><i class="fa fa-check"></i><b>2.7.6</b> Portfolio Construction and Mathematical Properties using Matrix Algebra</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="resampling-distributions.html"><a href="resampling-distributions.html"><i class="fa fa-check"></i><b>3</b> Resampling Distributions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="resampling-distributions.html"><a href="resampling-distributions.html#estimating-the-moments-with-bootstraping"><i class="fa fa-check"></i><b>3.1</b> Estimating the Moments with Bootstraping</a></li>
<li class="chapter" data-level="3.2" data-path="resampling-distributions.html"><a href="resampling-distributions.html#bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>3.2</b> Bootstrap Confidence Intervals</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="resampling-distributions.html"><a href="resampling-distributions.html#bootstrap-of-normal-ci"><i class="fa fa-check"></i><b>3.2.1</b> Bootstrap of Normal CI</a></li>
<li class="chapter" data-level="3.2.2" data-path="resampling-distributions.html"><a href="resampling-distributions.html#bootstrap-of-t-ci"><i class="fa fa-check"></i><b>3.2.2</b> Bootstrap of t-CI</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="resampling-distributions.html"><a href="resampling-distributions.html#summary-on-data"><i class="fa fa-check"></i><b>3.3</b> Summary on Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html"><i class="fa fa-check"></i><b>4</b> Inductive Statistics and Regression Analysis Fundamentals</a>
<ul>
<li class="chapter" data-level="4.1" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#inductive-statistics"><i class="fa fa-check"></i><b>4.1</b> Inductive Statistics</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#point-estimators"><i class="fa fa-check"></i><b>4.1.1</b> Point Estimators</a></li>
<li class="chapter" data-level="4.1.2" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#confidence-intervals"><i class="fa fa-check"></i><b>4.1.2</b> Confidence Intervals</a></li>
<li class="chapter" data-level="4.1.3" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#hypothesis-testing"><i class="fa fa-check"></i><b>4.1.3</b> Hypothesis Testing</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#introduction-to-regression-analysis"><i class="fa fa-check"></i><b>4.2</b> Introduction to Regression Analysis</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#the-role-of-correlation"><i class="fa fa-check"></i><b>4.2.1</b> The role of correlation</a></li>
<li class="chapter" data-level="4.2.2" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#the-simple-univariate-regression-model"><i class="fa fa-check"></i><b>4.2.2</b> The simple / univariate regression model</a></li>
<li class="chapter" data-level="4.2.3" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#the-multivariate-regression-model"><i class="fa fa-check"></i><b>4.2.3</b> The multivariate regression model</a></li>
<li class="chapter" data-level="4.2.4" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#goodness-of-fit"><i class="fa fa-check"></i><b>4.2.4</b> Goodness of Fit</a></li>
<li class="chapter" data-level="4.2.5" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#assumption-and-diagnostic-tests-of-ols"><i class="fa fa-check"></i><b>4.2.5</b> Assumption and diagnostic tests of OLS</a></li>
<li class="chapter" data-level="4.2.6" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#properties-of-the-ols-estimator"><i class="fa fa-check"></i><b>4.2.6</b> Properties of the OLS Estimator</a></li>
<li class="chapter" data-level="4.2.7" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#expected-value-and-variance-of-the-multivarite-ols-estimator-if-the-assumptions-hold"><i class="fa fa-check"></i><b>4.2.7</b> Expected Value and Variance of the multivarite OLS estimator if the assumptions hold:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html"><i class="fa fa-check"></i><b>5</b> Fixed Income Securities</a>
<ul>
<li class="chapter" data-level="5.1" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#economic-analysis"><i class="fa fa-check"></i><b>5.1</b> Economic Analysis</a></li>
<li class="chapter" data-level="5.2" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#swiss-fixed-income-securities"><i class="fa fa-check"></i><b>5.2</b> Swiss Fixed Income Securities</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#shape-of-the-swiss-yield-curve"><i class="fa fa-check"></i><b>5.2.1</b> Shape of the Swiss Yield curve</a></li>
<li class="chapter" data-level="5.2.2" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#the-case-for-mean-reversion"><i class="fa fa-check"></i><b>5.2.2</b> The case for mean reversion</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#principal-component-analysis"><i class="fa fa-check"></i><b>5.3</b> Principal Component Analysis</a></li>
<li class="chapter" data-level="5.4" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#bond-valuation-strategies"><i class="fa fa-check"></i><b>5.4</b> Bond Valuation Strategies</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#the-most-common-bonds"><i class="fa fa-check"></i><b>5.4.1</b> The most common bonds</a></li>
<li class="chapter" data-level="5.4.2" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#yield-to-maturity-ytm"><i class="fa fa-check"></i><b>5.4.2</b> Yield-to-Maturity (YTM)</a></li>
<li class="chapter" data-level="5.4.3" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#term-structure"><i class="fa fa-check"></i><b>5.4.3</b> Term Structure</a></li>
<li class="chapter" data-level="5.4.4" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#estimating-the-term-structure---parametric-and-non-parametric-models"><i class="fa fa-check"></i><b>5.4.4</b> Estimating the Term Structure - Parametric and Non-Parametric Models</a></li>
<li class="chapter" data-level="5.4.5" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#sensitivity-of-the-price-to-yield-duration-and-convexity"><i class="fa fa-check"></i><b>5.4.5</b> Sensitivity of the Price to Yield: Duration and Convexity</a></li>
<li class="chapter" data-level="5.4.6" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#price-and-yield-full-valuation-and-approximations"><i class="fa fa-check"></i><b>5.4.6</b> Price and Yield: Full Valuation and Approximations</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#interest-rate-derivative-models"><i class="fa fa-check"></i><b>5.5</b> Interest Rate Derivative Models</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#black-model"><i class="fa fa-check"></i><b>5.5.1</b> Black Model</a></li>
<li class="chapter" data-level="5.5.2" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#pricing-interest-rate-caps-with-black"><i class="fa fa-check"></i><b>5.5.2</b> Pricing Interest Rate Caps with Black</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#short-rate-models"><i class="fa fa-check"></i><b>5.6</b> Short Rate Models</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#vasicek"><i class="fa fa-check"></i><b>5.6.1</b> Vasicek</a></li>
<li class="chapter" data-level="5.6.2" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#cox-ingersoll-and-ross---cir-model"><i class="fa fa-check"></i><b>5.6.2</b> Cox, Ingersoll, and Ross - CIR Model</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#convertible-bonds"><i class="fa fa-check"></i><b>5.7</b> Convertible Bonds</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#main-idea-of-cbs"><i class="fa fa-check"></i><b>5.7.1</b> Main Idea of CBs</a></li>
<li class="chapter" data-level="5.7.2" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#individual-constituents-of-cbs"><i class="fa fa-check"></i><b>5.7.2</b> Individual constituents of CBs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="copulas.html"><a href="copulas.html"><i class="fa fa-check"></i><b>6</b> Copulas</a>
<ul>
<li class="chapter" data-level="6.1" data-path="copulas.html"><a href="copulas.html#what-on-earth-are-copulas"><i class="fa fa-check"></i><b>6.1</b> What on earth are Copulas?</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="copulas.html"><a href="copulas.html#copula-properties"><i class="fa fa-check"></i><b>6.1.1</b> Copula Properties</a></li>
<li class="chapter" data-level="6.1.2" data-path="copulas.html"><a href="copulas.html#motivation-for-copulas"><i class="fa fa-check"></i><b>6.1.2</b> Motivation for Copulas</a></li>
<li class="chapter" data-level="6.1.3" data-path="copulas.html"><a href="copulas.html#copula-examples"><i class="fa fa-check"></i><b>6.1.3</b> Copula Examples</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="copulas.html"><a href="copulas.html#dependence-concepts-and-measures"><i class="fa fa-check"></i><b>6.2</b> Dependence Concepts and Measures</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="copulas.html"><a href="copulas.html#perfect-dependence"><i class="fa fa-check"></i><b>6.2.1</b> Perfect Dependence</a></li>
<li class="chapter" data-level="6.2.2" data-path="copulas.html"><a href="copulas.html#dependence-measures"><i class="fa fa-check"></i><b>6.2.2</b> Dependence Measures</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="copulas.html"><a href="copulas.html#normal-mixture-copulas"><i class="fa fa-check"></i><b>6.3</b> Normal Mixture Copulas</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="copulas.html"><a href="copulas.html#tail-dependence-1"><i class="fa fa-check"></i><b>6.3.1</b> Tail Dependence</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="copulas.html"><a href="copulas.html#archimedean-copulas"><i class="fa fa-check"></i><b>6.4</b> Archimedean Copulas</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="copulas.html"><a href="copulas.html#frank-copula-and-general-clayton-copula"><i class="fa fa-check"></i><b>6.4.1</b> Frank Copula and General Clayton Copula</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="copulas.html"><a href="copulas.html#applying-copulas-with-actual-data"><i class="fa fa-check"></i><b>6.5</b> Applying Copulas with actual data</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="copulas.html"><a href="copulas.html#estimating-copulas-method-of-moments-using-rank-correlations"><i class="fa fa-check"></i><b>6.5.1</b> Estimating Copulas: Method-of-Moments using Rank Correlations</a></li>
<li class="chapter" data-level="6.5.2" data-path="copulas.html"><a href="copulas.html#estimating-copulas-maximum-likelihood-estimation-mle"><i class="fa fa-check"></i><b>6.5.2</b> Estimating Copulas: Maximum Likelihood Estimation (MLE)</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative Finance in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="copulas" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> Copulas</h1>
<p>In the next chapter, we are going to focus on Copulas. Copulas are used to define dependency concepts for modelling a random vector of financial risk factors.</p>
<div id="what-on-earth-are-copulas" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> What on earth are Copulas?</h2>
<p>Copulas are a framework for modeling multivariate data and defining multivariate models. ACopulas isolate the description of the dependence structure of a joint distribution function for a random vector of risk factors. This is handy because it allows us to separate the joint dependence of risk from the marginal, individual risk. As such, they allow us to differentiate and quantify between idiosyncratic and systemic risk. Especially, the have three distinct advantages:</p>
<ul>
<li>Copulas show us how to define a number of useful alternative dependence measures to the correlation measures</li>
<li>Copulas express dependence on a <strong>quantile scale</strong>, as such they are better suited to explain the behaviour of extreme events</li>
<li>Copulas allow us to follow a bottom-up risk approach, in which we can combine the marginal behaviour of individual risk to obtain a general, overall risk structure</li>
<li>Copulas let us combine the marginal models with a variety of dependene models to understand the sensitivity of risk to the specification of dependence</li>
<li>Copulas are easily simulated. Thus, one can use Monte Carlo simulations to study them</li>
</ul>
<p>As such, they characterise the co-dependence of components of multivariate distributions and can be combined with any set of univariate marginal distributions to form a full joint distribution.</p>
<p>In essence, the primary financial use case for copula models is the management of portfolios that contain assets which have a strong correlation in their tails. That is, assets which may be mildly correlated in normal times but exhibit strong losses at the same time.</p>
<p>Let’s first consider the basic properties of Copulas</p>
<div id="copula-properties" class="section level3" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Copula Properties</h3>
<p>We define multivariate distribution functions that are copulas as <span class="math inline">\(C(\textbf{u}) = C(u_1,\dots,u_d)\)</span>. Mapping C to obtain: <span class="math inline">\(X:[0,1]^d \rightarrow [0,1]\)</span>, we define three properties:</p>
<ul>
<li><span class="math inline">\(C(u_1,\dots,u_d) = 0\)</span> if <span class="math inline">\(u_i = 0\)</span> for any i</li>
<li><span class="math inline">\(C(1,\dots, 1,u_i,1,\dots,1) = u_i\)</span> for all i <span class="math inline">\(\in [1,\dots,d]\)</span></li>
<li>For all <span class="math inline">\((a_1,\dots,a_d), (b_1,\dots,b_d) \in [0,1^d\)</span> with <span class="math inline">\(a_i \leq b_i\)</span> it holds that:</li>
</ul>
<p><span class="math display">\[
\sum_{i_1=1}^2\sum_{i_d=1}^2(-1)^{i_1 + \dots + i_d}C(u_{1i}, \dots, u_{di_d}) \geq 0
\]</span></p>
<p>whereas <span class="math inline">\(u_{j1} = a_j\)</span> and <span class="math inline">\(u_{j2} = b_j\)</span> for all j <span class="math inline">\(\in\)</span> [1,d].</p>
<p>This equality is also called <strong>rectangle inequality</strong> and it ensures that <span class="math inline">\(P(a_1 \leq U_1 \leq b_1, \dots, a_d \leq U_d \leq b_d)\)</span> is non-negative.</p>
<p>Any function which fulfills all three characteristics is a copula.</p>
<div id="quantile-transformation-properties" class="section level4" number="6.1.1.1">
<h4><span class="header-section-number">6.1.1.1</span> Quantile Transformation Properties</h4>
<p>In order to work with Copulas, we need to become familiar with <strong>quantile transformations</strong> as well as <strong>generalised inverses</strong>. Let’s define the properties. First, we assume that F is a distribution function and <span class="math inline">\(F^{-1}\)</span> is its general inverse. That is: <span class="math inline">\(F^{-1}(u) = inf[x:F(x)\geq u]\)</span>.</p>
<ul>
<li><p>Quantile Transformation: If <span class="math inline">\(U \sim U(0,1)\)</span> has a standard uniform distribution, then <span class="math inline">\(P(F^{-1}(U) \leq x) = F(x)\)</span></p></li>
<li><p>Proability Transformation: If X has a df F, where F is a continuous univariate df, then <span class="math inline">\(F(X) \sim U(0,1)\)</span></p></li>
</ul>
<p>The first proposition is the key to stochastic simulation. This is because if we can generate a uniform variable U and compute the inverse of a distribution function F, we are able to sample from the distribution function. This implies that we can transform risks with a <strong>particular continuous distribution function to have any other continuous distribution</strong>.</p>
</div>
<div id="sklars-theorem" class="section level4" number="6.1.1.2">
<h4><span class="header-section-number">6.1.1.2</span> Sklar’s Theorem</h4>
<p>Sklar’s theorem shows the importance of Copulas to study multivariate distributions. By the theorem it follows that all multivariate distributions contain copulas and that copulas may be used in conjunction with univariate dfs to construct multivariate distributions. Sklar states that if we let F be a joint distribution function with margins <span class="math inline">\(F_1, \dots, F_d\)</span>, then there exists a Copula such that, for all <span class="math inline">\(x_1, \dots, d_d\)</span> in <span class="math inline">\(\mathcal{R} = [-\infty, \infty]\)</span>:</p>
<p><span class="math display">\[
F(x_1,\dots,x_d) = C(F_1(x_1), \dots, F_d(x_d))
\]</span></p>
<p>If the margins are continuous, then C is unique - otherwise C is uniquely determined on <span class="math inline">\(Ran F_1 \times \dots \times Ran F_d\)</span> whereas <span class="math inline">\(Ran F_i\)</span> denotes the range of <span class="math inline">\(F_i\)</span>. This states that the distribution of any continuous random vector can be expressed using copula and the marginal distribution.</p>
<p>This states that the joint DF can be decomposed into two parts:</p>
<ul>
<li>The Copula C (containing all information about dependencies among random vectors)</li>
<li>The univariate, marginal DFs F (containing all information about the univariate, marginal distributions)</li>
</ul>
<p>It is easy to estimate the marginals of a random vector, so <strong>all we need is to estimate the copula function and this would lead to an estimator of the joint distribution</strong>.</p>
<p>We can visually explain Sklar’s theorem as well as the invariance property below. Doing so, we will take a sample from a t Copula whereas we define the following properties:</p>
<div class="sourceCode" id="cb9875"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9875-1"><a href="copulas.html#cb9875-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup</span></span>
<span id="cb9875-2"><a href="copulas.html#cb9875-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nvmix)</span>
<span id="cb9875-3"><a href="copulas.html#cb9875-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">271</span>)</span>
<span id="cb9875-4"><a href="copulas.html#cb9875-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9875-5"><a href="copulas.html#cb9875-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample from a t copula</span></span>
<span id="cb9875-6"><a href="copulas.html#cb9875-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb9875-7"><a href="copulas.html#cb9875-7" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span> </span>
<span id="cb9875-8"><a href="copulas.html#cb9875-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create correlation matrix </span></span>
<span id="cb9875-9"><a href="copulas.html#cb9875-9" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.65</span></span>
<span id="cb9875-10"><a href="copulas.html#cb9875-10" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">matrix</span>(rho, <span class="at">nrow =</span> d, <span class="at">ncol =</span> d)</span>
<span id="cb9875-11"><a href="copulas.html#cb9875-11" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(P) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9875-12"><a href="copulas.html#cb9875-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9875-13"><a href="copulas.html#cb9875-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the DOF</span></span>
<span id="cb9875-14"><a href="copulas.html#cb9875-14" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> <span class="fl">3.5</span></span>
<span id="cb9875-15"><a href="copulas.html#cb9875-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1996</span>)</span>
<span id="cb9875-16"><a href="copulas.html#cb9875-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9875-17"><a href="copulas.html#cb9875-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the distribution</span></span>
<span id="cb9875-18"><a href="copulas.html#cb9875-18" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rStudent</span>(n, <span class="at">df =</span> nu, <span class="at">scale =</span> P)</span>
<span id="cb9875-19"><a href="copulas.html#cb9875-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9875-20"><a href="copulas.html#cb9875-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create n IID realizations from the corresponding t copula</span></span>
<span id="cb9875-21"><a href="copulas.html#cb9875-21" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">pt</span>(X, <span class="at">df =</span> nu)</span>
<span id="cb9875-22"><a href="copulas.html#cb9875-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9875-23"><a href="copulas.html#cb9875-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformation of U to Exp(1) margins</span></span>
<span id="cb9875-24"><a href="copulas.html#cb9875-24" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">qexp</span>(U)</span></code></pre></div>
<p>As we elaborated, Sklar’s Theorem tells us that we can write the joint CDF in terms of the marginal CDFs and the Copula. Consequently, the combination both CDFs should provide us with the same dependence structure. Thus, we first, generate two RVs with a t distribution. They have the scale of a correlation matrix with <span class="math inline">\(\rho = 0.65\)</span>. We can plot their distribution and show three points:</p>
<div class="sourceCode" id="cb9876"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9876-1"><a href="copulas.html#cb9876-1" aria-hidden="true" tabindex="-1"></a>X <span class="sc">%&gt;%</span> </span>
<span id="cb9876-2"><a href="copulas.html#cb9876-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9876-3"><a href="copulas.html#cb9876-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2)) <span class="sc">+</span> </span>
<span id="cb9876-4"><a href="copulas.html#cb9876-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb9876-5"><a href="copulas.html#cb9876-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> X <span class="sc">%&gt;%</span> </span>
<span id="cb9876-6"><a href="copulas.html#cb9876-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9876-7"><a href="copulas.html#cb9876-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">filter</span>(V1 <span class="sc">==</span> X[ind[<span class="st">&quot;A&quot;</span>],<span class="dv">1</span>] <span class="sc">&amp;</span> V2 <span class="sc">==</span> X[ind[<span class="st">&quot;A&quot;</span>],<span class="dv">2</span>]), <span class="at">color =</span> <span class="st">&quot;violetred&quot;</span>, <span class="at">size =</span> <span class="fl">2.7</span>) <span class="sc">+</span> </span>
<span id="cb9876-8"><a href="copulas.html#cb9876-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> X <span class="sc">%&gt;%</span> </span>
<span id="cb9876-9"><a href="copulas.html#cb9876-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9876-10"><a href="copulas.html#cb9876-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">filter</span>(V1 <span class="sc">==</span> X[ind[<span class="st">&quot;B&quot;</span>],<span class="dv">1</span>] <span class="sc">&amp;</span> V2 <span class="sc">==</span> X[ind[<span class="st">&quot;B&quot;</span>],<span class="dv">2</span>]), <span class="at">color =</span> <span class="st">&quot;darkgoldenrod2&quot;</span>, <span class="at">size =</span> <span class="fl">2.7</span>) <span class="sc">+</span> </span>
<span id="cb9876-11"><a href="copulas.html#cb9876-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> X <span class="sc">%&gt;%</span> </span>
<span id="cb9876-12"><a href="copulas.html#cb9876-12" aria-hidden="true" tabindex="-1"></a>               <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9876-13"><a href="copulas.html#cb9876-13" aria-hidden="true" tabindex="-1"></a>               <span class="fu">filter</span>(V1 <span class="sc">==</span> X[ind[<span class="st">&quot;C&quot;</span>],<span class="dv">1</span>] <span class="sc">&amp;</span> V2 <span class="sc">==</span> X[ind[<span class="st">&quot;C&quot;</span>],<span class="dv">2</span>]), <span class="at">color =</span> <span class="st">&quot;cyan3&quot;</span>, <span class="at">size =</span> <span class="fl">2.7</span>) <span class="sc">+</span> </span>
<span id="cb9876-14"><a href="copulas.html#cb9876-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Bivariate t distribution values&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9876-15"><a href="copulas.html#cb9876-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;X2&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;X1&quot;</span>) <span class="sc">+</span></span>
<span id="cb9876-16"><a href="copulas.html#cb9876-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&quot;Est. Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9876-17"><a href="copulas.html#cb9876-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Actual Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9876-18"><a href="copulas.html#cb9876-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9876-19"><a href="copulas.html#cb9876-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust=</span><span class="fl">0.5</span>,</span>
<span id="cb9876-20"><a href="copulas.html#cb9876-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">lineheight=</span><span class="fl">1.2</span>, <span class="at">margin=</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">15</span>,<span class="dv">15</span>)), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9876-21"><a href="copulas.html#cb9876-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9876-22"><a href="copulas.html#cb9876-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9876-23"><a href="copulas.html#cb9876-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9876-24"><a href="copulas.html#cb9876-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9876-25"><a href="copulas.html#cb9876-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9876-26"><a href="copulas.html#cb9876-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9876-27"><a href="copulas.html#cb9876-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-270-1.png" width="672" /></p>
<p>This is the distribution of the bivariate t-values. We have highlighted three points to show make the theorem clear. We can now create the Copula of the bivariate t distribution with the command above. This will transform each RV based on the formula for the t-distribution Copula. In other words, we perform the <strong>first probability and quantile transformation</strong> to obtain different margins. Once we plot this, we obtain the following structure:</p>
<div class="sourceCode" id="cb9877"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9877-1"><a href="copulas.html#cb9877-1" aria-hidden="true" tabindex="-1"></a>U <span class="sc">%&gt;%</span> </span>
<span id="cb9877-2"><a href="copulas.html#cb9877-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9877-3"><a href="copulas.html#cb9877-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2)) <span class="sc">+</span> </span>
<span id="cb9877-4"><a href="copulas.html#cb9877-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb9877-5"><a href="copulas.html#cb9877-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> U <span class="sc">%&gt;%</span> </span>
<span id="cb9877-6"><a href="copulas.html#cb9877-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9877-7"><a href="copulas.html#cb9877-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">filter</span>(V1 <span class="sc">==</span> U[ind[<span class="st">&quot;A&quot;</span>],<span class="dv">1</span>] <span class="sc">&amp;</span> V2 <span class="sc">==</span> U[ind[<span class="st">&quot;A&quot;</span>],<span class="dv">2</span>]), <span class="at">color =</span> <span class="st">&quot;violetred&quot;</span>, <span class="at">size =</span> <span class="fl">2.7</span>) <span class="sc">+</span> </span>
<span id="cb9877-8"><a href="copulas.html#cb9877-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> U <span class="sc">%&gt;%</span> </span>
<span id="cb9877-9"><a href="copulas.html#cb9877-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9877-10"><a href="copulas.html#cb9877-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">filter</span>(V1 <span class="sc">==</span> U[ind[<span class="st">&quot;B&quot;</span>],<span class="dv">1</span>] <span class="sc">&amp;</span> V2 <span class="sc">==</span> U[ind[<span class="st">&quot;B&quot;</span>],<span class="dv">2</span>]), <span class="at">color =</span> <span class="st">&quot;darkgoldenrod2&quot;</span>, <span class="at">size =</span> <span class="fl">2.7</span>) <span class="sc">+</span> </span>
<span id="cb9877-11"><a href="copulas.html#cb9877-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> U <span class="sc">%&gt;%</span> </span>
<span id="cb9877-12"><a href="copulas.html#cb9877-12" aria-hidden="true" tabindex="-1"></a>               <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9877-13"><a href="copulas.html#cb9877-13" aria-hidden="true" tabindex="-1"></a>               <span class="fu">filter</span>(V1 <span class="sc">==</span> U[ind[<span class="st">&quot;C&quot;</span>],<span class="dv">1</span>] <span class="sc">&amp;</span> V2 <span class="sc">==</span> U[ind[<span class="st">&quot;C&quot;</span>],<span class="dv">2</span>]), <span class="at">color =</span> <span class="st">&quot;cyan3&quot;</span>, <span class="at">size =</span> <span class="fl">2.7</span>) <span class="sc">+</span> </span>
<span id="cb9877-14"><a href="copulas.html#cb9877-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Copula of Bivariate t distribution values&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9877-15"><a href="copulas.html#cb9877-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;U2&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;U1&quot;</span>) <span class="sc">+</span></span>
<span id="cb9877-16"><a href="copulas.html#cb9877-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&quot;Est. Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9877-17"><a href="copulas.html#cb9877-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Actual Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9877-18"><a href="copulas.html#cb9877-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9877-19"><a href="copulas.html#cb9877-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust=</span><span class="fl">0.5</span>,</span>
<span id="cb9877-20"><a href="copulas.html#cb9877-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">lineheight=</span><span class="fl">1.2</span>, <span class="at">margin=</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">15</span>,<span class="dv">15</span>)), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9877-21"><a href="copulas.html#cb9877-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9877-22"><a href="copulas.html#cb9877-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9877-23"><a href="copulas.html#cb9877-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9877-24"><a href="copulas.html#cb9877-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9877-25"><a href="copulas.html#cb9877-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9877-26"><a href="copulas.html#cb9877-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9877-27"><a href="copulas.html#cb9877-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-271-1.png" width="672" /></p>
<p>Transformed to the Copula, we can now proof the first part of the proof of Sklar. This tells us that each distribution can be expressed with a copula. That is, the relative locations of the points is the same as before, which shows the first connection of the bivariate distribution and its Copula.</p>
<p>Next, we can plot the second meta distribution (also known as t-meta distribution with Exp(1) margins) in order to set the margins according to the original t distribution and change the relative density to the original distribution. This is the second <strong>probability and quantile transformation</strong>.</p>
<div class="sourceCode" id="cb9878"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9878-1"><a href="copulas.html#cb9878-1" aria-hidden="true" tabindex="-1"></a>Y <span class="sc">%&gt;%</span> </span>
<span id="cb9878-2"><a href="copulas.html#cb9878-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9878-3"><a href="copulas.html#cb9878-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2)) <span class="sc">+</span> </span>
<span id="cb9878-4"><a href="copulas.html#cb9878-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb9878-5"><a href="copulas.html#cb9878-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> Y <span class="sc">%&gt;%</span> </span>
<span id="cb9878-6"><a href="copulas.html#cb9878-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9878-7"><a href="copulas.html#cb9878-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">filter</span>(V1 <span class="sc">==</span> Y[ind[<span class="st">&quot;A&quot;</span>],<span class="dv">1</span>] <span class="sc">&amp;</span> V2 <span class="sc">==</span> Y[ind[<span class="st">&quot;A&quot;</span>],<span class="dv">2</span>]), <span class="at">color =</span> <span class="st">&quot;violetred&quot;</span>, <span class="at">size =</span> <span class="fl">2.7</span>) <span class="sc">+</span> </span>
<span id="cb9878-8"><a href="copulas.html#cb9878-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> Y <span class="sc">%&gt;%</span> </span>
<span id="cb9878-9"><a href="copulas.html#cb9878-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9878-10"><a href="copulas.html#cb9878-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">filter</span>(V1 <span class="sc">==</span> Y[ind[<span class="st">&quot;B&quot;</span>],<span class="dv">1</span>] <span class="sc">&amp;</span> V2 <span class="sc">==</span> Y[ind[<span class="st">&quot;B&quot;</span>],<span class="dv">2</span>]), <span class="at">color =</span> <span class="st">&quot;darkgoldenrod2&quot;</span>, <span class="at">size =</span> <span class="fl">2.7</span>) <span class="sc">+</span> </span>
<span id="cb9878-11"><a href="copulas.html#cb9878-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> Y <span class="sc">%&gt;%</span> </span>
<span id="cb9878-12"><a href="copulas.html#cb9878-12" aria-hidden="true" tabindex="-1"></a>               <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9878-13"><a href="copulas.html#cb9878-13" aria-hidden="true" tabindex="-1"></a>               <span class="fu">filter</span>(V1 <span class="sc">==</span> Y[ind[<span class="st">&quot;C&quot;</span>],<span class="dv">1</span>] <span class="sc">&amp;</span> V2 <span class="sc">==</span> Y[ind[<span class="st">&quot;C&quot;</span>],<span class="dv">2</span>]), <span class="at">color =</span> <span class="st">&quot;cyan3&quot;</span>, <span class="at">size =</span> <span class="fl">2.7</span>) <span class="sc">+</span> </span>
<span id="cb9878-14"><a href="copulas.html#cb9878-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;t-meta distribution with Exp(1) margins&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9878-15"><a href="copulas.html#cb9878-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Y2&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Y1&quot;</span>) <span class="sc">+</span></span>
<span id="cb9878-16"><a href="copulas.html#cb9878-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&quot;Est. Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9878-17"><a href="copulas.html#cb9878-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Actual Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9878-18"><a href="copulas.html#cb9878-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9878-19"><a href="copulas.html#cb9878-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust=</span><span class="fl">0.5</span>,</span>
<span id="cb9878-20"><a href="copulas.html#cb9878-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">lineheight=</span><span class="fl">1.2</span>, <span class="at">margin=</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">15</span>,<span class="dv">15</span>)), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9878-21"><a href="copulas.html#cb9878-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9878-22"><a href="copulas.html#cb9878-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9878-23"><a href="copulas.html#cb9878-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9878-24"><a href="copulas.html#cb9878-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9878-25"><a href="copulas.html#cb9878-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9878-26"><a href="copulas.html#cb9878-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9878-27"><a href="copulas.html#cb9878-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-272-1.png" width="672" /></p>
<p>We see that the <em>relative</em> locations of all points remains the same still. As such, applying the probability and quantile transformations, we only change the marginal distributions, but not the probability, of the individual observations. This proves that the combination of a univariate CDF and a Copula follows results in an expression for a joint CDF.</p>
</div>
<div id="strictly-increasing-functions" class="section level4" number="6.1.1.3">
<h4><span class="header-section-number">6.1.1.3</span> Strictly increasing functions</h4>
<p>We can further state that if <span class="math inline">\(X_1, \dots, X_d\)</span> is a random vector with continuous margins and a copula C and <span class="math inline">\(T_1, \dots, T_d\)</span> are strictly increasing functions, then <span class="math inline">\(T_1(X_1) \dots, T_d(X_d)\)</span> also has Copulas.</p>
<p>This states that Copulas are invariant to strictly increasing transformations of the component variables. This can be proved by obtaining:</p>
<p><span class="math display">\[
\begin{align}
C(u_1, \dots, u_d) &amp;= P(X_1 \leq x_1, \dots, X_d \leq x_d) \\
&amp;= P(X_1 \leq F_1^{-1}(u_1), \dots, X_d \leq F_d^{-1}(u_d)) \\
&amp;= P(T_1(X_1) \leq T_1 \cdot F_1&#39;{-1}(u_1), \dots, T_d(D_x) \leq T_D \cdot F_d^{-1}(u_d)) \\
&amp;= P(T_1(X_1) \leq F_{T_1(X_1)}^{-1}(u_1), \dots, T_d(D_x) \leq F_{T_d(X_d)}^{-1}(u_d))
\end{align}
\]</span></p>
</div>
<div id="fréchet-bounds" class="section level4" number="6.1.1.4">
<h4><span class="header-section-number">6.1.1.4</span> Fréchet Bounds</h4>
<p>Fréchet Bounds are important concepts for Copulas as they have important dependence interpretations. Let’s define these bounds.</p>
<p>For each copula we have the bounds:</p>
<p><span class="math display">\[
max(\sum_{i=1}^d u_i + 1 - d, 0) \leq C(\textbf{u}) \leq \min(u_1, \dots, u_d)
\]</span></p>
</div>
<div id="meta-distribution-of-copulas" class="section level4" number="6.1.1.5">
<h4><span class="header-section-number">6.1.1.5</span> Meta Distribution of Copulas</h4>
<p>The Meta Distribution of Copulas essentially constructs multivariate distributions from univariate and copulas while it allows for <strong>arbitrary margins</strong>. As such, it constitutes the second part of the Sklar’s Theorem proof that we showed visually, where we stated the identity of the relative positions of three points and in the third plot extended the margins.</p>
</div>
</div>
<div id="motivation-for-copulas" class="section level3" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Motivation for Copulas</h3>
<p>Let’s quickly show why Copulas are handy tools to define the co-dependence structure of assets in risky scenarios.</p>
<p>For that, we use a pre-defined two simulated datasets which have an X1 and X2 variable.</p>
<div class="sourceCode" id="cb9879"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9879-1"><a href="copulas.html#cb9879-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> X <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9879-2"><a href="copulas.html#cb9879-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2)) <span class="sc">+</span> </span>
<span id="cb9879-3"><a href="copulas.html#cb9879-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;goldenrod&quot;</span>, <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9879-4"><a href="copulas.html#cb9879-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Copula Distribution of X1 and X2&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9879-5"><a href="copulas.html#cb9879-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;X1&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;X2&quot;</span>) <span class="sc">+</span></span>
<span id="cb9879-6"><a href="copulas.html#cb9879-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&quot;Est. Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9879-7"><a href="copulas.html#cb9879-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Actual Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9879-8"><a href="copulas.html#cb9879-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9879-9"><a href="copulas.html#cb9879-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust=</span><span class="fl">0.5</span>,</span>
<span id="cb9879-10"><a href="copulas.html#cb9879-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">lineheight=</span><span class="fl">1.2</span>, <span class="at">margin=</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">15</span>,<span class="dv">15</span>)), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9879-11"><a href="copulas.html#cb9879-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9879-12"><a href="copulas.html#cb9879-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9879-13"><a href="copulas.html#cb9879-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9879-14"><a href="copulas.html#cb9879-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9879-15"><a href="copulas.html#cb9879-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9879-16"><a href="copulas.html#cb9879-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9879-17"><a href="copulas.html#cb9879-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>)) </span>
<span id="cb9879-18"><a href="copulas.html#cb9879-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9879-19"><a href="copulas.html#cb9879-19" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> Y <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9879-20"><a href="copulas.html#cb9879-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2)) <span class="sc">+</span> </span>
<span id="cb9879-21"><a href="copulas.html#cb9879-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;goldenrod&quot;</span>, <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9879-22"><a href="copulas.html#cb9879-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Copula Distribution of Y1 and Y2&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9879-23"><a href="copulas.html#cb9879-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Y1&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Y2&quot;</span>) <span class="sc">+</span></span>
<span id="cb9879-24"><a href="copulas.html#cb9879-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&quot;Est. Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9879-25"><a href="copulas.html#cb9879-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Actual Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9879-26"><a href="copulas.html#cb9879-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9879-27"><a href="copulas.html#cb9879-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust=</span><span class="fl">0.5</span>,</span>
<span id="cb9879-28"><a href="copulas.html#cb9879-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">lineheight=</span><span class="fl">1.2</span>, <span class="at">margin=</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">15</span>,<span class="dv">15</span>)), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9879-29"><a href="copulas.html#cb9879-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9879-30"><a href="copulas.html#cb9879-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9879-31"><a href="copulas.html#cb9879-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9879-32"><a href="copulas.html#cb9879-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9879-33"><a href="copulas.html#cb9879-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9879-34"><a href="copulas.html#cb9879-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9879-35"><a href="copulas.html#cb9879-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>)) </span>
<span id="cb9879-36"><a href="copulas.html#cb9879-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9879-37"><a href="copulas.html#cb9879-37" aria-hidden="true" tabindex="-1"></a>a <span class="sc">+</span> b <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-274-1.png" width="672" /></p>
<p>We may now be inclined to ask for which data the dependence between both variables is larger. This is difficult to answer, as both have different scales and ranges. We can circumvent this by transforming the data using to have the same marginals. Doing so, we estimate the df by their empirical dfs (edfs) and then apply these marginal empirical dfs to the respective data columns. The function pobs() does this.</p>
<div class="sourceCode" id="cb9880"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9880-1"><a href="copulas.html#cb9880-1" aria-hidden="true" tabindex="-1"></a>U  <span class="ot">&lt;-</span> <span class="fu">pobs</span>(X)</span>
<span id="cb9880-2"><a href="copulas.html#cb9880-2" aria-hidden="true" tabindex="-1"></a>U_d <span class="ot">&lt;-</span> <span class="fu">pobs</span>(Y)</span>
<span id="cb9880-3"><a href="copulas.html#cb9880-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9880-4"><a href="copulas.html#cb9880-4" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> U <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9880-5"><a href="copulas.html#cb9880-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2)) <span class="sc">+</span> </span>
<span id="cb9880-6"><a href="copulas.html#cb9880-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;goldenrod&quot;</span>, <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9880-7"><a href="copulas.html#cb9880-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Copula Distribution of X1 and X2, scaled&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9880-8"><a href="copulas.html#cb9880-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;X1&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;X2&quot;</span>) <span class="sc">+</span></span>
<span id="cb9880-9"><a href="copulas.html#cb9880-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&quot;Est. Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9880-10"><a href="copulas.html#cb9880-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Actual Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9880-11"><a href="copulas.html#cb9880-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9880-12"><a href="copulas.html#cb9880-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust=</span><span class="fl">0.5</span>,</span>
<span id="cb9880-13"><a href="copulas.html#cb9880-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">lineheight=</span><span class="fl">1.2</span>, <span class="at">margin=</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">15</span>,<span class="dv">15</span>)), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9880-14"><a href="copulas.html#cb9880-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9880-15"><a href="copulas.html#cb9880-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9880-16"><a href="copulas.html#cb9880-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9880-17"><a href="copulas.html#cb9880-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9880-18"><a href="copulas.html#cb9880-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9880-19"><a href="copulas.html#cb9880-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9880-20"><a href="copulas.html#cb9880-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>)) </span>
<span id="cb9880-21"><a href="copulas.html#cb9880-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9880-22"><a href="copulas.html#cb9880-22" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> U_d <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9880-23"><a href="copulas.html#cb9880-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2)) <span class="sc">+</span> </span>
<span id="cb9880-24"><a href="copulas.html#cb9880-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;goldenrod&quot;</span>, <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9880-25"><a href="copulas.html#cb9880-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Copula Distribution of Y1 and Y2, scaled&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9880-26"><a href="copulas.html#cb9880-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Y1&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Y2&quot;</span>) <span class="sc">+</span></span>
<span id="cb9880-27"><a href="copulas.html#cb9880-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&quot;Est. Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9880-28"><a href="copulas.html#cb9880-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Actual Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9880-29"><a href="copulas.html#cb9880-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9880-30"><a href="copulas.html#cb9880-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust=</span><span class="fl">0.5</span>,</span>
<span id="cb9880-31"><a href="copulas.html#cb9880-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">lineheight=</span><span class="fl">1.2</span>, <span class="at">margin=</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">15</span>,<span class="dv">15</span>)), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9880-32"><a href="copulas.html#cb9880-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9880-33"><a href="copulas.html#cb9880-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9880-34"><a href="copulas.html#cb9880-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9880-35"><a href="copulas.html#cb9880-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9880-36"><a href="copulas.html#cb9880-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9880-37"><a href="copulas.html#cb9880-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9880-38"><a href="copulas.html#cb9880-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>)) </span>
<span id="cb9880-39"><a href="copulas.html#cb9880-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9880-40"><a href="copulas.html#cb9880-40" aria-hidden="true" tabindex="-1"></a>c <span class="sc">+</span> d <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-275-1.png" width="672" /></p>
<p>Having transformed these distributions, we can see that both factors have <strong>the same dependence structure</strong>. As such, if we want to study the dependence independently of the margins, we need to <strong>study the distributions of random vectors with U(0,1) marginals</strong>, which are also called <strong>copulas</strong>.</p>
</div>
<div id="copula-examples" class="section level3" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> Copula Examples</h3>
<p>In general, we can distinguish between three forms of Copulas.</p>
<ul>
<li>fundamental copulas</li>
<li>implicit copulas (taken from well-known multivariate distributions using Sklar’s Theorem)</li>
<li>explicit copulas</li>
</ul>
<p>We will introduce each copula and plot distinct plots to show you the behaviour of these copulas. Specially, we show</p>
<ul>
<li>Perspective plots</li>
<li>Contour plots</li>
<li>Wire frames</li>
<li>Scatter Plots</li>
</ul>
<p>To show the joint dependent behaviour of each Copula.</p>
<div id="fundamental-copulas" class="section level4" number="6.1.3.1">
<h4><span class="header-section-number">6.1.3.1</span> Fundamental Copulas</h4>
<p>We define three Copulas in this section.</p>
<div id="the-independence-copula" class="section level5" number="6.1.3.1.1">
<h5><span class="header-section-number">6.1.3.1.1</span> The independence copula</h5>
<p>The independence copula is given by:</p>
<p><span class="math display">\[
\prod(u_1, \dots, u_d) = \prod_{i=1}^du_i
\]</span></p>
<p>Let0s show their distributional properties.</p>
<p>First, let’s look at the wire frame and level curves (the countour plot).</p>
<div class="sourceCode" id="cb9881"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9881-1"><a href="copulas.html#cb9881-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Define the independence copula object</span></span>
<span id="cb9881-2"><a href="copulas.html#cb9881-2" aria-hidden="true" tabindex="-1"></a>indec <span class="ot">&lt;-</span> <span class="fu">indepCopula</span>()</span>
<span id="cb9881-3"><a href="copulas.html#cb9881-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9881-4"><a href="copulas.html#cb9881-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Copula (wire frame and level curves)</span></span>
<span id="cb9881-5"><a href="copulas.html#cb9881-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">wireframe2</span>(indec, <span class="at">FUN =</span> pCopula)</span>
<span id="cb9881-6"><a href="copulas.html#cb9881-6" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">contourplot2</span>(indec, <span class="at">FUN =</span> pCopula)</span>
<span id="cb9881-7"><a href="copulas.html#cb9881-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9881-8"><a href="copulas.html#cb9881-8" aria-hidden="true" tabindex="-1"></a>a</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-277-1.png" width="672" /></p>
<div class="sourceCode" id="cb9882"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9882-1"><a href="copulas.html#cb9882-1" aria-hidden="true" tabindex="-1"></a>b</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-277-2.png" width="672" /></p>
<p>Note that both show the same dependency structure, just once in 2D and once in 3D. Importantly, we understand that the value of the copula is zero if either <span class="math inline">\(u_1\)</span> or <span class="math inline">\(u_2\)</span> are zero. As such, we obtain that the value of the copula (the dependence measure) increases in an eliptic fashion in both parameters. As such, there is only a limited combination of both parameters. Consequently, the independence copula is a copula for two or more RVs which are <strong>largely independent</strong>.</p>
<p>Now, let’s look at scatterplots to show the combination of up to five random variables which can be defined by the independence copula. Doing so, we define random variables with <code>runif()</code>.</p>
<div class="sourceCode" id="cb9883"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9883-1"><a href="copulas.html#cb9883-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Scatter plots</span></span>
<span id="cb9883-2"><a href="copulas.html#cb9883-2" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n<span class="sc">*</span>d), <span class="at">ncol =</span> <span class="dv">5</span>)</span>
<span id="cb9883-3"><a href="copulas.html#cb9883-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9883-4"><a href="copulas.html#cb9883-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot the 2D scatterplot for independent data</span></span>
<span id="cb9883-5"><a href="copulas.html#cb9883-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(U[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">xlab =</span> <span class="fu">expression</span>(U[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(U[<span class="dv">2</span>])) <span class="co"># d = 2</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-278-1.png" width="672" /></p>
<div class="sourceCode" id="cb9884"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9884-1"><a href="copulas.html#cb9884-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot the 3D scatterplot for independent data</span></span>
<span id="cb9884-2"><a href="copulas.html#cb9884-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">cloud2</span>(U[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">xlab =</span> <span class="fu">expression</span>(U[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(U[<span class="dv">2</span>]), <span class="at">zlab =</span> <span class="fu">expression</span>(U[<span class="dv">3</span>]))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-278-2.png" width="672" /></p>
<div class="sourceCode" id="cb9885"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9885-1"><a href="copulas.html#cb9885-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot different the 2D scatterplots for independent data</span></span>
<span id="cb9885-2"><a href="copulas.html#cb9885-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs2</span>(U) <span class="co"># d = 5</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-278-3.png" width="672" /></p>
<p>As we can see, the data has <strong>no dependence structure</strong>. If this is the case for multivariate data, then we know that it can be modelled by a <strong>independent copula</strong>.</p>
</div>
<div id="comonotonicity-copula" class="section level5" number="6.1.3.1.2">
<h5><span class="header-section-number">6.1.3.1.2</span> Comonotonicity Copula</h5>
<p>The comonotonicity copula is the Fréchet upper bound copula, also given as:</p>
<p><span class="math display">\[
M(u_1, \dots, u_d) = min(u_1, \dots, u_d)
\]</span></p>
<p>This copula is also the joint df of the random vector (U,…,U), whereas <span class="math inline">\(U \sim U(0,1)\)</span>. If <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>:</p>
<ul>
<li>have continuous dfs</li>
<li>are perfectly positively dependent (<span class="math inline">\(X_2\)</span> is almost surely a strict increasing function of <span class="math inline">\(X_1\)</span>)</li>
</ul>
<p>then the Comonotonicity Copula is their Copula.</p>
<div class="sourceCode" id="cb9886"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9886-1"><a href="copulas.html#cb9886-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Copulas (wire frame and level curves)</span></span>
<span id="cb9886-2"><a href="copulas.html#cb9886-2" aria-hidden="true" tabindex="-1"></a>n.grid <span class="ot">&lt;-</span> <span class="dv">26</span> <span class="co"># number of grid points</span></span>
<span id="cb9886-3"><a href="copulas.html#cb9886-3" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> n.grid) <span class="co"># subdivison points in each dimension</span></span>
<span id="cb9886-4"><a href="copulas.html#cb9886-4" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="st">&quot;u[1]&quot;</span> <span class="ot">=</span> u, <span class="st">&quot;u[2]&quot;</span> <span class="ot">=</span> u) <span class="co"># build a grid</span></span>
<span id="cb9886-5"><a href="copulas.html#cb9886-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9886-6"><a href="copulas.html#cb9886-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the upper bound Fréchet Copula</span></span>
<span id="cb9886-7"><a href="copulas.html#cb9886-7" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">pmax</span>(grid[,<span class="dv">1</span>] <span class="sc">+</span> grid[,<span class="dv">2</span>] <span class="sc">-</span> <span class="dv">1</span>, <span class="dv">0</span>) <span class="co"># values of W on grid</span></span>
<span id="cb9886-8"><a href="copulas.html#cb9886-8" aria-hidden="true" tabindex="-1"></a>val.W <span class="ot">&lt;-</span> <span class="fu">cbind</span>(grid, <span class="st">&quot;W(u[1],u[2])&quot;</span> <span class="ot">=</span> W) <span class="co"># append grid</span></span>
<span id="cb9886-9"><a href="copulas.html#cb9886-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9886-10"><a href="copulas.html#cb9886-10" aria-hidden="true" tabindex="-1"></a><span class="fu">wireframe2</span>(val.W) <span class="co"># wire frame plot of W</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-279-1.png" width="672" /></p>
<div class="sourceCode" id="cb9887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9887-1"><a href="copulas.html#cb9887-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contourplot2</span>(val.W, <span class="at">xlim =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">ylim =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>) <span class="co"># level curves of W</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-279-2.png" width="672" /></p>
<p>Here, we can see the value distribution of the comonotonicity copula. The first non-zero value is at (0.5,0.5) and then increases monotonically. This is why it is called monotonicity copula and any data which is monotonically decreasing and continuous can be modelled accordingly. We can plot the 2-D Scatterplot (remember it is only defined for 2D).</p>
<div class="sourceCode" id="cb9888"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9888-1"><a href="copulas.html#cb9888-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cbind</span>(U, <span class="dv">1</span><span class="sc">-</span>U), <span class="at">xlab =</span> <span class="fu">expression</span>(U[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(U[<span class="dv">2</span>]), <span class="at">col =</span> <span class="fu">tblack</span>(<span class="fl">0.5</span>)) <span class="co"># sample of W for d = 2</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-280-1.png" width="672" /></p>
<p>Here we can see the monotonically decreasing functional form of the data which includes the Copula above.</p>
</div>
<div id="countermonotonicity-copula" class="section level5" number="6.1.3.1.3">
<h5><span class="header-section-number">6.1.3.1.3</span> Countermonotonicity Copula</h5>
<p>The countermonotonicity copula is the two-dimensional Fre ́chet lower bound copula from:</p>
<p><span class="math display">\[
W(u_1, u_2) = max(u_1, + u_2 - 1,0)
\]</span></p>
<p>This copula is the joint df of the random vector (U,1 − U), where <span class="math inline">\(U \sim U(0,1)\)</span>. If <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>:</p>
<ul>
<li>have continuous dfs</li>
<li>are perfectly negatively dependent (<span class="math inline">\(X_2\)</span> is almost surely a strict decreasing function of <span class="math inline">\(X_1\)</span>)</li>
</ul>
<p>then the Countermonotonicity Copula is their Copula.</p>
<div class="sourceCode" id="cb9889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9889-1"><a href="copulas.html#cb9889-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">pmin</span>(grid[,<span class="dv">1</span>], grid[,<span class="dv">2</span>]) <span class="co"># values of M on grid</span></span>
<span id="cb9889-2"><a href="copulas.html#cb9889-2" aria-hidden="true" tabindex="-1"></a>val.M <span class="ot">&lt;-</span> <span class="fu">cbind</span>(grid, <span class="st">&quot;M(u[1],u[2])&quot;</span> <span class="ot">=</span> M) <span class="co"># append grid</span></span>
<span id="cb9889-3"><a href="copulas.html#cb9889-3" aria-hidden="true" tabindex="-1"></a><span class="fu">wireframe2</span>(val.M) <span class="co"># wire frame plot of M</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-281-1.png" width="672" /></p>
<div class="sourceCode" id="cb9890"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9890-1"><a href="copulas.html#cb9890-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contourplot2</span>(val.M, <span class="at">xlim =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">ylim =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>) <span class="co"># level curves of M</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-281-2.png" width="672" /></p>
<p>As opposed to the comonotonicity, we have here a more direct and stronger connection for the copula. That is, the max value incorporates that the copula value is sooner different from zero for a given correlation of the assets. Also, we can plot the distribution for strict monotonically increasing functions in more than a 2D scatterplot.</p>
<div class="sourceCode" id="cb9891"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9891-1"><a href="copulas.html#cb9891-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Scatter plots</span></span>
<span id="cb9891-2"><a href="copulas.html#cb9891-2" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb9891-3"><a href="copulas.html#cb9891-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cbind</span>(U, U), <span class="at">xlab =</span> <span class="fu">expression</span>(U[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(U[<span class="dv">2</span>]), <span class="at">col =</span> <span class="fu">tblack</span>(<span class="fl">0.5</span>)) <span class="co"># sample of M for d = 2</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-282-1.png" width="672" /></p>
<div class="sourceCode" id="cb9892"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9892-1"><a href="copulas.html#cb9892-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cloud2</span>(<span class="fu">do.call</span>(cbind, <span class="fu">rep</span>(<span class="fu">list</span>(U), <span class="dv">3</span>)), <span class="at">col =</span> <span class="fu">tblack</span>(<span class="fl">0.05</span>), <span class="co"># sample of M for d = 3</span></span>
<span id="cb9892-2"><a href="copulas.html#cb9892-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="fu">expression</span>(U[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(U[<span class="dv">2</span>]), <span class="at">zlab =</span> <span class="fu">expression</span>(U[<span class="dv">3</span>]))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-282-2.png" width="672" /></p>
<div class="sourceCode" id="cb9893"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9893-1"><a href="copulas.html#cb9893-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs2</span>(<span class="fu">do.call</span>(cbind, <span class="fu">rep</span>(<span class="fu">list</span>(U), d)), <span class="at">col =</span> <span class="fu">tblack</span>(<span class="fl">0.05</span>)) <span class="co"># sample of M for d = 5</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-282-3.png" width="672" /></p>
<p>Here, we can clearly see the distributional properties for which such a copula form is appropriate.</p>
</div>
</div>
<div id="implicit-copulas" class="section level4" number="6.1.3.2">
<h4><span class="header-section-number">6.1.3.2</span> Implicit Copulas</h4>
<div id="gauss-copula" class="section level5" number="6.1.3.2.1">
<h5><span class="header-section-number">6.1.3.2.1</span> Gauss Copula</h5>
<p>If <span class="math inline">\(X \sim N(\mu, sigma^2)\)</span> is a multivariate normal random vector, then its copula is a so-called Gauss copula (or Gaussian copula). By definition, this is given as:</p>
<p><span class="math display">\[
C_P^{Ga}(\textbf{u}) = \Phi_P(\phi^{-1}(u_1), \dots, \phi^{-1}(u_d))
\]</span></p>
<p>whereas <span class="math inline">\(\phi\)</span> denotes the standard univariate normal distribution and <span class="math inline">\(\Phi_P\)</span> is the joint density function. This Copula is automatically parametarised by the the d(d − 1)/2 parameters of the correlation matrix. The Gauss copula does not have a simple closed form, but can be expressed as an integral over the density of <span class="math inline">\(\textbf{X}\)</span>.</p>
<p>In two dimensions the Gauss copula can be thought of as a <strong>dependence structure that interpolates between perfect positive and negative dependence</strong>, where the parameter <span class="math inline">\(\rho\)</span> represents the strength of dependence.</p>
<div class="sourceCode" id="cb9894"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9894-1"><a href="copulas.html#cb9894-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Define the normal copula object</span></span>
<span id="cb9894-2"><a href="copulas.html#cb9894-2" aria-hidden="true" tabindex="-1"></a>th <span class="ot">&lt;-</span> <span class="fu">iTau</span>(<span class="fu">normalCopula</span>(), <span class="at">tau =</span> tau)</span>
<span id="cb9894-3"><a href="copulas.html#cb9894-3" aria-hidden="true" tabindex="-1"></a>nc <span class="ot">&lt;-</span> <span class="fu">normalCopula</span>(th)</span>
<span id="cb9894-4"><a href="copulas.html#cb9894-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9894-5"><a href="copulas.html#cb9894-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Copula (wire frame and level curves)</span></span>
<span id="cb9894-6"><a href="copulas.html#cb9894-6" aria-hidden="true" tabindex="-1"></a><span class="fu">wireframe2</span>(nc, <span class="at">FUN =</span> pCopula)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-283-1.png" width="672" /></p>
<div class="sourceCode" id="cb9895"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9895-1"><a href="copulas.html#cb9895-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contourplot2</span>(nc, <span class="at">FUN =</span> pCopula)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-283-2.png" width="672" /></p>
<p>We can also plot the densities of the copula</p>
<div class="sourceCode" id="cb9896"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9896-1"><a href="copulas.html#cb9896-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Copula density (wire frame and level curves)</span></span>
<span id="cb9896-2"><a href="copulas.html#cb9896-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wireframe2</span>(nc, <span class="at">FUN =</span> dCopula, <span class="at">delta =</span> <span class="fl">0.02</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-284-1.png" width="672" /></p>
<div class="sourceCode" id="cb9897"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9897-1"><a href="copulas.html#cb9897-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contourplot2</span>(nc, <span class="at">FUN =</span> dCopula)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-284-2.png" width="672" /></p>
<p>and show the multidimensional structure</p>
<div class="sourceCode" id="cb9898"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9898-1"><a href="copulas.html#cb9898-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Scatter plots</span></span>
<span id="cb9898-2"><a href="copulas.html#cb9898-2" aria-hidden="true" tabindex="-1"></a>nc. <span class="ot">&lt;-</span> <span class="fu">normalCopula</span>(th, <span class="at">dim =</span> <span class="dv">5</span>)</span>
<span id="cb9898-3"><a href="copulas.html#cb9898-3" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">rCopula</span>(n, <span class="at">copula =</span> nc.)</span>
<span id="cb9898-4"><a href="copulas.html#cb9898-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(U[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">xlab =</span> <span class="fu">expression</span>(U[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(U[<span class="dv">2</span>])) <span class="co"># d = 2</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-285-1.png" width="672" /></p>
<div class="sourceCode" id="cb9899"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9899-1"><a href="copulas.html#cb9899-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cloud2</span>(U[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="co"># d = 3</span></span>
<span id="cb9899-2"><a href="copulas.html#cb9899-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="fu">expression</span>(U[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(U[<span class="dv">2</span>]), <span class="at">zlab =</span> <span class="fu">expression</span>(U[<span class="dv">3</span>]))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-285-2.png" width="672" /></p>
<div class="sourceCode" id="cb9900"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9900-1"><a href="copulas.html#cb9900-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs2</span>(U, <span class="at">cex =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="fu">tblack</span>(<span class="fl">0.5</span>)) <span class="co"># d = 5</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-285-3.png" width="672" /></p>
</div>
<div id="t-copula" class="section level5" number="6.1.3.2.2">
<h5><span class="header-section-number">6.1.3.2.2</span> t Copula</h5>
<p>We can extract a Copula from any other continuous distribution in the same way aas we did for the Gaussian Copula. In this case, we obtain the following parametric form:</p>
<p><span class="math display">\[
c_{v,P}^t(\textbf{u}) = t_{v,P}(t_v^{-1}(u_1), \dots, t_v^{-1}(u_d)) 
\]</span></p>
<p>whereas <span class="math inline">\(t_v\)</span> is the distribution of a standard univariate t distribution with ν degrees of freedom, <span class="math inline">\(t_{v,P)\)</span> is the joint distribution of <span class="math inline">\(\textbf{X}\)</span> and P is the correlation matrix.</p>
<div class="sourceCode" id="cb9901"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9901-1"><a href="copulas.html#cb9901-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Define the t copula object</span></span>
<span id="cb9901-2"><a href="copulas.html#cb9901-2" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># degrees of freedom</span></span>
<span id="cb9901-3"><a href="copulas.html#cb9901-3" aria-hidden="true" tabindex="-1"></a>th <span class="ot">&lt;-</span> <span class="fu">iTau</span>(<span class="fu">tCopula</span>(, <span class="at">df =</span> nu), <span class="at">tau =</span> tau) <span class="co"># correlation parameter</span></span>
<span id="cb9901-4"><a href="copulas.html#cb9901-4" aria-hidden="true" tabindex="-1"></a>tc <span class="ot">&lt;-</span> <span class="fu">tCopula</span>(th, <span class="at">df =</span> nu)</span>
<span id="cb9901-5"><a href="copulas.html#cb9901-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9901-6"><a href="copulas.html#cb9901-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Copula (wire frame and level curves)</span></span>
<span id="cb9901-7"><a href="copulas.html#cb9901-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Note: pCopula() is only available for integer degrees of freedom</span></span>
<span id="cb9901-8"><a href="copulas.html#cb9901-8" aria-hidden="true" tabindex="-1"></a><span class="fu">wireframe2</span>(tc, <span class="at">FUN =</span> pCopula)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-286-1.png" width="672" /></p>
<div class="sourceCode" id="cb9902"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9902-1"><a href="copulas.html#cb9902-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contourplot2</span>(tc, <span class="at">FUN =</span> pCopula)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-286-2.png" width="672" /></p>
<p>We can plot the densities and realise their larger dependence on the tails.</p>
<div class="sourceCode" id="cb9903"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9903-1"><a href="copulas.html#cb9903-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Copula density (wire frame and level curves)</span></span>
<span id="cb9903-2"><a href="copulas.html#cb9903-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wireframe2</span>(tc, <span class="at">FUN =</span> dCopula, <span class="at">delta =</span> <span class="fl">0.02</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-287-1.png" width="672" /></p>
<div class="sourceCode" id="cb9904"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9904-1"><a href="copulas.html#cb9904-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contourplot2</span>(tc, <span class="at">FUN =</span> dCopula)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-287-2.png" width="672" /></p>
<p>Also, the scatter plots of the t-Copula are defined by this structure:</p>
<div class="sourceCode" id="cb9905"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9905-1"><a href="copulas.html#cb9905-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Scatter plots</span></span>
<span id="cb9905-2"><a href="copulas.html#cb9905-2" aria-hidden="true" tabindex="-1"></a>tc. <span class="ot">&lt;-</span> <span class="fu">tCopula</span>(th, <span class="at">dim =</span> <span class="dv">5</span>, <span class="at">df =</span> nu)</span>
<span id="cb9905-3"><a href="copulas.html#cb9905-3" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">rCopula</span>(n, <span class="at">copula =</span> tc.)</span>
<span id="cb9905-4"><a href="copulas.html#cb9905-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(U[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">xlab =</span> <span class="fu">expression</span>(U[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(U[<span class="dv">2</span>])) <span class="co"># d = 2</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-288-1.png" width="672" /></p>
<div class="sourceCode" id="cb9906"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9906-1"><a href="copulas.html#cb9906-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cloud2</span>(U[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="co"># d = 3</span></span>
<span id="cb9906-2"><a href="copulas.html#cb9906-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="fu">expression</span>(U[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(U[<span class="dv">2</span>]), <span class="at">zlab =</span> <span class="fu">expression</span>(U[<span class="dv">3</span>]))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-288-2.png" width="672" /></p>
<div class="sourceCode" id="cb9907"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9907-1"><a href="copulas.html#cb9907-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs2</span>(U, <span class="at">cex =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="fu">tblack</span>(<span class="fl">0.5</span>)) <span class="co"># d = 5</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-288-3.png" width="672" /></p>
<p>As we can see, the t-Copula incorporates nicely the dependence structure on the individual tail distributions.</p>
</div>
</div>
<div id="explicit-copulas" class="section level4" number="6.1.3.3">
<h4><span class="header-section-number">6.1.3.3</span> Explicit Copulas</h4>
<p>Explicit Copulas are Copulas which have a <strong>closed form solution</strong>. We will encounter four such Copulas.</p>
<div id="gumbel-copula" class="section level5" number="6.1.3.3.1">
<h5><span class="header-section-number">6.1.3.3.1</span> Gumbel Copula</h5>
<p>The Gumbel Copula is a bivariate Copula with form:</p>
<p><span class="math display">\[
C_\theta^{Gu} = exp(-((-\ln u_1)^\theta + (-\ln u_2)^\theta)^{1/\theta})
\]</span></p>
<p>whereas <span class="math inline">\(1 \leq \theta \leq \infty\)</span>. The Copula has following specifications:</p>
<ul>
<li>If <span class="math inline">\(\theta = 1\)</span>, we obtain the independence Copula</li>
<li>If <span class="math inline">\(\theta \rightarrow \infty\)</span>, we obtain the two-dimensional comonotonicity copula (= lower Fréchet Copula)</li>
</ul>
<p>As such, the Gumbel Copula is also a swing copula, which varies between independence and perfect dependence, with the parameter <span class="math inline">\(\theta\)</span> quantifying the strength of the dependence.</p>
<p>Let’s look at the Gumbel Copula more closely.</p>
<div class="sourceCode" id="cb9908"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9908-1"><a href="copulas.html#cb9908-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Define the Gumbel copula object</span></span>
<span id="cb9908-2"><a href="copulas.html#cb9908-2" aria-hidden="true" tabindex="-1"></a>th <span class="ot">&lt;-</span> <span class="fu">iTau</span>(<span class="fu">gumbelCopula</span>(), <span class="at">tau =</span> tau)</span>
<span id="cb9908-3"><a href="copulas.html#cb9908-3" aria-hidden="true" tabindex="-1"></a>gc <span class="ot">&lt;-</span> <span class="fu">gumbelCopula</span>(th)</span>
<span id="cb9908-4"><a href="copulas.html#cb9908-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9908-5"><a href="copulas.html#cb9908-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Create the frame and contour plot</span></span>
<span id="cb9908-6"><a href="copulas.html#cb9908-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9908-7"><a href="copulas.html#cb9908-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Copula (wire frame and level curves)</span></span>
<span id="cb9908-8"><a href="copulas.html#cb9908-8" aria-hidden="true" tabindex="-1"></a><span class="fu">wireframe2</span>(gc, <span class="at">FUN =</span> pCopula)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-289-1.png" width="672" /></p>
<div class="sourceCode" id="cb9909"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9909-1"><a href="copulas.html#cb9909-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contourplot2</span>(gc, <span class="at">FUN =</span> pCopula)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-289-2.png" width="672" /></p>
<p>Compared to the Gaussian copula, the Gumble copula is slightly “wavier”, implying its contours are smoother. Given the logarithmic scales, this is to be expected.</p>
<div class="sourceCode" id="cb9910"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9910-1"><a href="copulas.html#cb9910-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Copula density (wire frame and level curves)</span></span>
<span id="cb9910-2"><a href="copulas.html#cb9910-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wireframe2</span>(gc, <span class="at">FUN =</span> dCopula, <span class="at">delta =</span> <span class="fl">0.02</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-290-1.png" width="672" /></p>
<div class="sourceCode" id="cb9911"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9911-1"><a href="copulas.html#cb9911-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contourplot2</span>(gc, <span class="at">FUN =</span> dCopula)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-290-2.png" width="672" /></p>
<p>We can further see that the density of the Copula is far higher compared to the Gaussian Copula, but the highest densities have a lower concentration at both edges.</p>
<div class="sourceCode" id="cb9912"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9912-1"><a href="copulas.html#cb9912-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Scatter plots</span></span>
<span id="cb9912-2"><a href="copulas.html#cb9912-2" aria-hidden="true" tabindex="-1"></a>gc. <span class="ot">&lt;-</span> <span class="fu">gumbelCopula</span>(th, <span class="at">dim =</span> <span class="dv">5</span>)</span>
<span id="cb9912-3"><a href="copulas.html#cb9912-3" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">rCopula</span>(n, <span class="at">copula =</span> gc.)</span>
<span id="cb9912-4"><a href="copulas.html#cb9912-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(U[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">xlab =</span> <span class="fu">expression</span>(U[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(U[<span class="dv">2</span>])) <span class="co"># d = 2</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-291-1.png" width="672" /></p>
<div class="sourceCode" id="cb9913"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9913-1"><a href="copulas.html#cb9913-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cloud2</span>(U[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="co"># d = 3</span></span>
<span id="cb9913-2"><a href="copulas.html#cb9913-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="fu">expression</span>(U[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(U[<span class="dv">2</span>]), <span class="at">zlab =</span> <span class="fu">expression</span>(U[<span class="dv">3</span>]))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-291-2.png" width="672" /></p>
<div class="sourceCode" id="cb9914"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9914-1"><a href="copulas.html#cb9914-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs2</span>(U, <span class="at">cex =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="fu">tblack</span>(<span class="fl">0.5</span>)) <span class="co"># d = 5</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-291-3.png" width="672" /></p>
<p>The concentration in the edges of the two factors is especially prominent when looking at the scatterplot matrix. Also the multidimensional dependency plots show a continuous tail dependency which is strong for all components.</p>
<p>Another interesting Copula is the survival Gumbel Compula. This is defined as:</p>
<div class="sourceCode" id="cb9915"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9915-1"><a href="copulas.html#cb9915-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Scatter plot of a survival Gumbel copula</span></span>
<span id="cb9915-2"><a href="copulas.html#cb9915-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs2</span>(<span class="dv">1</span><span class="sc">-</span>U, <span class="at">cex =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="fu">tblack</span>(<span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-292-1.png" width="672" /></p>
<p>A survival Gumbel Copula has even larger tail dependencies and can thus represent even better catastrophic events.</p>
</div>
<div id="clayton-copula" class="section level5" number="6.1.3.3.2">
<h5><span class="header-section-number">6.1.3.3.2</span> Clayton copula</h5>
<p>The Clayton Copula is also a bivariate Copula represented by:</p>
<p><span class="math display">\[
C_\theta^{Cl}(u_1, u_2) = (u_1^{-\theta} + u_2^{-\theta} - 1)^{-1/\theta}
\]</span></p>
<p>Whereas <span class="math inline">\(0 \leq \theta \leq \infty\)</span>.</p>
<p>Also for this Copula, we have that:</p>
<ul>
<li>If <span class="math inline">\(\theta = 1\)</span>, we obtain the independence Copula</li>
<li>If <span class="math inline">\(\theta \rightarrow \infty\)</span>, we obtain the two-dimensional comonotonicity copula (= lower Fréchet Copula)</li>
</ul>
<p>Both Gumbel and Clayton belong to the <strong>Archimedean Copula Family</strong>.</p>
<p>Let’s look at the Clayton Copula</p>
<div class="sourceCode" id="cb9916"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9916-1"><a href="copulas.html#cb9916-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Define the Clayton copula object</span></span>
<span id="cb9916-2"><a href="copulas.html#cb9916-2" aria-hidden="true" tabindex="-1"></a>th <span class="ot">&lt;-</span> <span class="fu">iTau</span>(<span class="fu">claytonCopula</span>(), <span class="at">tau =</span> <span class="fl">0.5</span>)</span>
<span id="cb9916-3"><a href="copulas.html#cb9916-3" aria-hidden="true" tabindex="-1"></a>cc <span class="ot">&lt;-</span> <span class="fu">claytonCopula</span>(th)</span>
<span id="cb9916-4"><a href="copulas.html#cb9916-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9916-5"><a href="copulas.html#cb9916-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Copula (wire frame and level curves)</span></span>
<span id="cb9916-6"><a href="copulas.html#cb9916-6" aria-hidden="true" tabindex="-1"></a><span class="fu">wireframe2</span>(cc, <span class="at">FUN =</span> pCopula)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-293-1.png" width="672" /></p>
<div class="sourceCode" id="cb9917"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9917-1"><a href="copulas.html#cb9917-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contourplot2</span>(cc, <span class="at">FUN =</span> pCopula)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-293-2.png" width="672" /></p>
<p>As we can see, the Contour shows us that the ranges are smoother and their smoothness increases with increasing dependency.</p>
<div class="sourceCode" id="cb9918"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9918-1"><a href="copulas.html#cb9918-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Copula density (wire frame and level curves)</span></span>
<span id="cb9918-2"><a href="copulas.html#cb9918-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wireframe2</span>(cc, <span class="at">FUN =</span> dCopula, <span class="at">delta =</span> <span class="fl">0.02</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-294-1.png" width="672" /></p>
<div class="sourceCode" id="cb9919"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9919-1"><a href="copulas.html#cb9919-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contourplot2</span>(cc, <span class="at">FUN =</span> dCopula)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-294-2.png" width="672" /></p>
<p>The density plot shows an even larger concentration of the Copula values in the extremes. As such, if both RVs have either very low or high values, we see a strong level of the Copula value. However, it quickly decays and is practically zero in central areas.</p>
<div class="sourceCode" id="cb9920"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9920-1"><a href="copulas.html#cb9920-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Scatter plots</span></span>
<span id="cb9920-2"><a href="copulas.html#cb9920-2" aria-hidden="true" tabindex="-1"></a>cc. <span class="ot">&lt;-</span> <span class="fu">claytonCopula</span>(th, <span class="at">dim =</span> <span class="dv">5</span>)</span>
<span id="cb9920-3"><a href="copulas.html#cb9920-3" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">rCopula</span>(n, <span class="at">copula =</span> cc.)</span>
<span id="cb9920-4"><a href="copulas.html#cb9920-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(U[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">xlab =</span> <span class="fu">expression</span>(U[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(U[<span class="dv">2</span>])) <span class="co"># d = 2</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-295-1.png" width="672" /></p>
<div class="sourceCode" id="cb9921"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9921-1"><a href="copulas.html#cb9921-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cloud2</span>(U[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="co"># d = 3</span></span>
<span id="cb9921-2"><a href="copulas.html#cb9921-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="fu">expression</span>(U[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(U[<span class="dv">2</span>]), <span class="at">zlab =</span> <span class="fu">expression</span>(U[<span class="dv">3</span>]))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-295-2.png" width="672" /></p>
<div class="sourceCode" id="cb9922"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9922-1"><a href="copulas.html#cb9922-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs2</span>(U, <span class="at">cex =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="fu">tblack</span>(<span class="fl">0.5</span>)) <span class="co"># d = 5</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-295-3.png" width="672" /></p>
<p>Interestingly enough, the Clayton copula is not symmetric in the sense that both extremes share the same concentration and thus you would see an elliptic form. Rather they appear to be fairly concentrated at the bottom and spread out, in the same way as you would see it in a <em>heteroskedastictiy</em> scenario.</p>
<p>Let’s quickly make a comparison to show you the effects depending on <span class="math inline">\(\theta\)</span>. For that we set the factor to 0.1 as well as 0.9</p>
<div class="sourceCode" id="cb9923"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9923-1"><a href="copulas.html#cb9923-1" aria-hidden="true" tabindex="-1"></a>th1 <span class="ot">&lt;-</span> <span class="fu">iTau</span>(<span class="fu">claytonCopula</span>(), <span class="at">tau =</span> <span class="fl">0.1</span>)</span>
<span id="cb9923-2"><a href="copulas.html#cb9923-2" aria-hidden="true" tabindex="-1"></a>th9 <span class="ot">&lt;-</span> <span class="fu">iTau</span>(<span class="fu">claytonCopula</span>(), <span class="at">tau =</span> <span class="fl">0.9</span>)</span>
<span id="cb9923-3"><a href="copulas.html#cb9923-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9923-4"><a href="copulas.html#cb9923-4" aria-hidden="true" tabindex="-1"></a>cc<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">claytonCopula</span>(th1, <span class="at">dim =</span> <span class="dv">5</span>)</span>
<span id="cb9923-5"><a href="copulas.html#cb9923-5" aria-hidden="true" tabindex="-1"></a>U1 <span class="ot">&lt;-</span> <span class="fu">rCopula</span>(n, <span class="at">copula =</span> cc<span class="fl">.1</span>)</span>
<span id="cb9923-6"><a href="copulas.html#cb9923-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9923-7"><a href="copulas.html#cb9923-7" aria-hidden="true" tabindex="-1"></a>cc<span class="fl">.9</span> <span class="ot">&lt;-</span> <span class="fu">claytonCopula</span>(th9, <span class="at">dim =</span> <span class="dv">5</span>)</span>
<span id="cb9923-8"><a href="copulas.html#cb9923-8" aria-hidden="true" tabindex="-1"></a>U9 <span class="ot">&lt;-</span> <span class="fu">rCopula</span>(n, <span class="at">copula =</span> cc<span class="fl">.9</span>)</span>
<span id="cb9923-9"><a href="copulas.html#cb9923-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9923-10"><a href="copulas.html#cb9923-10" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs2</span>(U1, <span class="at">cex =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="fu">tblack</span>(<span class="fl">0.5</span>)) <span class="co"># d = 5</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-296-1.png" width="672" /></p>
<div class="sourceCode" id="cb9924"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9924-1"><a href="copulas.html#cb9924-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs2</span>(U9, <span class="at">cex =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="fu">tblack</span>(<span class="fl">0.5</span>)) <span class="co"># d = 5</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-296-2.png" width="672" /></p>
<p>As we can see, the Copula greatly differentiates depending on <span class="math inline">\(\theta\)</span>. As such, the larger <span class="math inline">\(\theta\)</span>, the larger the comonotonicity.</p>
</div>
</div>
<div id="summary-of-the-usual-copulas" class="section level4" number="6.1.3.4">
<h4><span class="header-section-number">6.1.3.4</span> Summary of the usual Copulas</h4>
<p>We give you a small overview of the most common copulas: The Normal, t, Gumbel and Clayton Copula. Therein, we show you again the (I) Copula distribution with fixed margins (II) Meta Copula distribution (= with arbitrary margins) (III) Meta Copula density with N(0,1) margin and the (IV) Contour plots</p>
<div class="sourceCode" id="cb9925"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9925-1"><a href="copulas.html#cb9925-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data</span></span>
<span id="cb9925-2"><a href="copulas.html#cb9925-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb9925-3"><a href="copulas.html#cb9925-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9925-4"><a href="copulas.html#cb9925-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample size and seed</span></span>
<span id="cb9925-5"><a href="copulas.html#cb9925-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb9925-6"><a href="copulas.html#cb9925-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">271</span>)</span>
<span id="cb9925-7"><a href="copulas.html#cb9925-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9925-8"><a href="copulas.html#cb9925-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the correlation parameters and Copulas</span></span>
<span id="cb9925-9"><a href="copulas.html#cb9925-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Normal Copula</span></span>
<span id="cb9925-10"><a href="copulas.html#cb9925-10" aria-hidden="true" tabindex="-1"></a>gauss_cop <span class="ot">&lt;-</span> <span class="fu">normalCopula</span>(<span class="fl">0.6</span>)</span>
<span id="cb9925-11"><a href="copulas.html#cb9925-11" aria-hidden="true" tabindex="-1"></a><span class="do">## t Copula </span></span>
<span id="cb9925-12"><a href="copulas.html#cb9925-12" aria-hidden="true" tabindex="-1"></a>t_cop <span class="ot">&lt;-</span> <span class="fu">tCopula</span>(<span class="fl">0.71</span>)</span>
<span id="cb9925-13"><a href="copulas.html#cb9925-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Gumbel Copula</span></span>
<span id="cb9925-14"><a href="copulas.html#cb9925-14" aria-hidden="true" tabindex="-1"></a>gumbel_cop <span class="ot">&lt;-</span> <span class="fu">gumbelCopula</span>(<span class="dv">2</span>)</span>
<span id="cb9925-15"><a href="copulas.html#cb9925-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Clayton Copula</span></span>
<span id="cb9925-16"><a href="copulas.html#cb9925-16" aria-hidden="true" tabindex="-1"></a>clayton_cop <span class="ot">&lt;-</span> <span class="fu">claytonCopula</span>(<span class="fl">2.2</span>)</span>
<span id="cb9925-17"><a href="copulas.html#cb9925-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9925-18"><a href="copulas.html#cb9925-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate Copula Data</span></span>
<span id="cb9925-19"><a href="copulas.html#cb9925-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Normal Copula</span></span>
<span id="cb9925-20"><a href="copulas.html#cb9925-20" aria-hidden="true" tabindex="-1"></a>U_gauss <span class="ot">&lt;-</span> <span class="fu">rCopula</span>(n, <span class="at">copula =</span> gauss_cop)</span>
<span id="cb9925-21"><a href="copulas.html#cb9925-21" aria-hidden="true" tabindex="-1"></a><span class="do">## t Copula</span></span>
<span id="cb9925-22"><a href="copulas.html#cb9925-22" aria-hidden="true" tabindex="-1"></a>U_t <span class="ot">&lt;-</span> <span class="fu">rCopula</span>(n, <span class="at">copula =</span> t_cop)</span>
<span id="cb9925-23"><a href="copulas.html#cb9925-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Gumbel Copula</span></span>
<span id="cb9925-24"><a href="copulas.html#cb9925-24" aria-hidden="true" tabindex="-1"></a>U_gumb <span class="ot">&lt;-</span> <span class="fu">rCopula</span>(n, <span class="at">copula =</span> gumbel_cop)</span>
<span id="cb9925-25"><a href="copulas.html#cb9925-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Clayton Copula</span></span>
<span id="cb9925-26"><a href="copulas.html#cb9925-26" aria-hidden="true" tabindex="-1"></a>U_clay <span class="ot">&lt;-</span> <span class="fu">rCopula</span>(n, <span class="at">copula =</span> clayton_cop)</span>
<span id="cb9925-27"><a href="copulas.html#cb9925-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9925-28"><a href="copulas.html#cb9925-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the mapping to N(0,1) for Meta Copula</span></span>
<span id="cb9925-29"><a href="copulas.html#cb9925-29" aria-hidden="true" tabindex="-1"></a>X_gauss <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(U_gauss)</span>
<span id="cb9925-30"><a href="copulas.html#cb9925-30" aria-hidden="true" tabindex="-1"></a>X_t <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(U_t)</span>
<span id="cb9925-31"><a href="copulas.html#cb9925-31" aria-hidden="true" tabindex="-1"></a>X_gumb <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(U_gumb)</span>
<span id="cb9925-32"><a href="copulas.html#cb9925-32" aria-hidden="true" tabindex="-1"></a>X_clay <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(U_clay)</span>
<span id="cb9925-33"><a href="copulas.html#cb9925-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9925-34"><a href="copulas.html#cb9925-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate Mapping for Density plots</span></span>
<span id="cb9925-35"><a href="copulas.html#cb9925-35" aria-hidden="true" tabindex="-1"></a>n.grid <span class="ot">&lt;-</span> <span class="dv">26</span> <span class="co"># number of grid points</span></span>
<span id="cb9925-36"><a href="copulas.html#cb9925-36" aria-hidden="true" tabindex="-1"></a>lim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span>)</span>
<span id="cb9925-37"><a href="copulas.html#cb9925-37" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">seq</span>(lim[<span class="dv">1</span>], lim[<span class="dv">2</span>], <span class="at">length.out =</span> n.grid)</span>
<span id="cb9925-38"><a href="copulas.html#cb9925-38" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">expand.grid</span>(<span class="st">&quot;x[1]&quot;</span> <span class="ot">=</span> s, <span class="st">&quot;x[2]&quot;</span> <span class="ot">=</span> s))</span>
<span id="cb9925-39"><a href="copulas.html#cb9925-39" aria-hidden="true" tabindex="-1"></a>V_gauss <span class="ot">&lt;-</span> <span class="fu">cbind</span>(grid, <span class="st">&quot;f(x[1],x[2])&quot;</span> <span class="ot">=</span> <span class="fu">dMetaCopulaN01</span>(grid, <span class="at">copula =</span> gauss_cop))</span>
<span id="cb9925-40"><a href="copulas.html#cb9925-40" aria-hidden="true" tabindex="-1"></a>V_t <span class="ot">&lt;-</span> <span class="fu">cbind</span>(grid, <span class="st">&quot;f(x[1],x[2])&quot;</span> <span class="ot">=</span> <span class="fu">dMetaCopulaN01</span>(grid, <span class="at">copula =</span> t_cop))</span>
<span id="cb9925-41"><a href="copulas.html#cb9925-41" aria-hidden="true" tabindex="-1"></a>V_gumb <span class="ot">&lt;-</span> <span class="fu">cbind</span>(grid, <span class="st">&quot;f(x[1],x[2])&quot;</span> <span class="ot">=</span> <span class="fu">dMetaCopulaN01</span>(grid, <span class="at">copula =</span> gumbel_cop))</span>
<span id="cb9925-42"><a href="copulas.html#cb9925-42" aria-hidden="true" tabindex="-1"></a>V_clay <span class="ot">&lt;-</span> <span class="fu">cbind</span>(grid, <span class="st">&quot;f(x[1],x[2])&quot;</span> <span class="ot">=</span> <span class="fu">dMetaCopulaN01</span>(grid, <span class="at">copula =</span> clayton_cop))</span>
<span id="cb9925-43"><a href="copulas.html#cb9925-43" aria-hidden="true" tabindex="-1"></a>zlim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(val.n[,<span class="dv">3</span>], val.g[,<span class="dv">3</span>], val.c[,<span class="dv">3</span>], val.t[,<span class="dv">3</span>]))</span></code></pre></div>
<p>Based on the setting, we can now create the different plots.</p>
<div class="sourceCode" id="cb9926"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9926-1"><a href="copulas.html#cb9926-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the copulas</span></span>
<span id="cb9926-2"><a href="copulas.html#cb9926-2" aria-hidden="true" tabindex="-1"></a><span class="do">## First, the Copula distribution with fixed margins</span></span>
<span id="cb9926-3"><a href="copulas.html#cb9926-3" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb9926-4"><a href="copulas.html#cb9926-4" aria-hidden="true" tabindex="-1"></a>lay <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>) <span class="co"># layout matrix</span></span>
<span id="cb9926-5"><a href="copulas.html#cb9926-5" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(lay) <span class="co"># layout</span></span>
<span id="cb9926-6"><a href="copulas.html#cb9926-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(U_gauss[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">xlab =</span> <span class="fu">expression</span>(U_gauss[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(U_gauss[<span class="dv">2</span>]))</span>
<span id="cb9926-7"><a href="copulas.html#cb9926-7" aria-hidden="true" tabindex="-1"></a><span class="do">## t Copula</span></span>
<span id="cb9926-8"><a href="copulas.html#cb9926-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(U_t[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">xlab =</span> <span class="fu">expression</span>(U_t[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(U_t[<span class="dv">2</span>]))</span>
<span id="cb9926-9"><a href="copulas.html#cb9926-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Gumbel Copula</span></span>
<span id="cb9926-10"><a href="copulas.html#cb9926-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(U_gumb[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">xlab =</span> <span class="fu">expression</span>(U_gumb[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(U_gumb[<span class="dv">2</span>]))</span>
<span id="cb9926-11"><a href="copulas.html#cb9926-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Clayton Copula</span></span>
<span id="cb9926-12"><a href="copulas.html#cb9926-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(U_clay[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">xlab =</span> <span class="fu">expression</span>(U_clay[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(U_clay[<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-298-1.png" width="672" /></p>
<div class="sourceCode" id="cb9927"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9927-1"><a href="copulas.html#cb9927-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Then, the Meta Copula distribution </span></span>
<span id="cb9927-2"><a href="copulas.html#cb9927-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">abs</span>(X_gauss), <span class="fu">abs</span>(X_t), <span class="fu">abs</span>(X_gumb), <span class="fu">abs</span>(X_clay))</span>
<span id="cb9927-3"><a href="copulas.html#cb9927-3" aria-hidden="true" tabindex="-1"></a>lim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span>m, m)</span>
<span id="cb9927-4"><a href="copulas.html#cb9927-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X_gauss, <span class="at">xlim =</span> lim, <span class="at">ylim =</span> lim, <span class="co"># meta-Gauss</span></span>
<span id="cb9927-5"><a href="copulas.html#cb9927-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(X[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(X[<span class="dv">2</span>]),</span>
<span id="cb9927-6"><a href="copulas.html#cb9927-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.4</span>, <span class="at">main =</span> <span class="st">&quot;Meta-Gauss sample&quot;</span>)</span>
<span id="cb9927-7"><a href="copulas.html#cb9927-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;N(0,1) margins&quot;</span>, <span class="at">side =</span> <span class="dv">4</span>, <span class="at">line =</span> <span class="fl">0.25</span>, <span class="at">adj =</span> <span class="dv">0</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb9927-8"><a href="copulas.html#cb9927-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X_t, <span class="at">xlim =</span> lim, <span class="at">ylim =</span> lim,</span>
<span id="cb9927-9"><a href="copulas.html#cb9927-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(X[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(X[<span class="dv">2</span>]), <span class="co"># meta-Gumbel</span></span>
<span id="cb9927-10"><a href="copulas.html#cb9927-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.4</span>, <span class="at">main =</span> <span class="st">&quot;Meta-t sample&quot;</span>)</span>
<span id="cb9927-11"><a href="copulas.html#cb9927-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;N(0,1) margins&quot;</span>, <span class="at">side =</span> <span class="dv">4</span>, <span class="at">line =</span> <span class="fl">0.25</span>, <span class="at">adj =</span> <span class="dv">0</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb9927-12"><a href="copulas.html#cb9927-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X_gumb, <span class="at">xlim =</span> lim, <span class="at">ylim =</span> lim, <span class="co"># meta-Clayton</span></span>
<span id="cb9927-13"><a href="copulas.html#cb9927-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(X[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(X[<span class="dv">2</span>]),</span>
<span id="cb9927-14"><a href="copulas.html#cb9927-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.4</span>, <span class="at">main =</span> <span class="st">&quot;Meta-Gumbel sample&quot;</span>)</span>
<span id="cb9927-15"><a href="copulas.html#cb9927-15" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;N(0,1) margins&quot;</span>, <span class="at">side =</span> <span class="dv">4</span>, <span class="at">line =</span> <span class="fl">0.25</span>, <span class="at">adj =</span> <span class="dv">0</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb9927-16"><a href="copulas.html#cb9927-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X_clay, <span class="at">xlim =</span> lim, <span class="at">ylim =</span> lim, <span class="co"># meta-t_4</span></span>
<span id="cb9927-17"><a href="copulas.html#cb9927-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(X[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(X[<span class="dv">2</span>]),</span>
<span id="cb9927-18"><a href="copulas.html#cb9927-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.4</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="st">&quot;Meta-Clayton sample&quot;</span>)))</span>
<span id="cb9927-19"><a href="copulas.html#cb9927-19" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;N(0,1) margins&quot;</span>, <span class="at">side =</span> <span class="dv">4</span>, <span class="at">line =</span> <span class="fl">0.25</span>, <span class="at">adj =</span> <span class="dv">0</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-298-2.png" width="672" /></p>
<div class="sourceCode" id="cb9928"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9928-1"><a href="copulas.html#cb9928-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar) <span class="co"># restore graphical parameters</span></span>
<span id="cb9928-2"><a href="copulas.html#cb9928-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9928-3"><a href="copulas.html#cb9928-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Next, the Meta density plots</span></span>
<span id="cb9928-4"><a href="copulas.html#cb9928-4" aria-hidden="true" tabindex="-1"></a>scs <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">arrows =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">cex =</span> <span class="fl">0.6</span>) <span class="co"># scale down ticks</span></span>
<span id="cb9928-5"><a href="copulas.html#cb9928-5" aria-hidden="true" tabindex="-1"></a>tcx <span class="ot">&lt;-</span> <span class="fl">0.95</span> <span class="co"># scale back titles</span></span>
<span id="cb9928-6"><a href="copulas.html#cb9928-6" aria-hidden="true" tabindex="-1"></a>w.n <span class="ot">&lt;-</span> <span class="fu">wireframe2</span>(V_gauss, <span class="at">xlim =</span> lim, <span class="at">ylim =</span> lim, <span class="at">zlim =</span> zlim, <span class="at">zoom =</span> zm, <span class="at">scales =</span> scs,</span>
<span id="cb9928-7"><a href="copulas.html#cb9928-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">main =</span> <span class="fu">list</span>(<span class="at">label =</span> <span class="st">&quot;Meta-Gauss density with N(0,1) margins&quot;</span>, <span class="at">cex =</span> tcx))</span>
<span id="cb9928-8"><a href="copulas.html#cb9928-8" aria-hidden="true" tabindex="-1"></a>w.g <span class="ot">&lt;-</span> <span class="fu">wireframe2</span>(V_t, <span class="at">xlim =</span> lim, <span class="at">ylim =</span> lim, <span class="at">zlim =</span> zlim, <span class="at">zoom =</span> zm, <span class="at">scales =</span> scs,</span>
<span id="cb9928-9"><a href="copulas.html#cb9928-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">main =</span> <span class="fu">list</span>(<span class="at">label =</span> <span class="st">&quot;Meta-t density with N(0,1) margins&quot;</span>, <span class="at">cex =</span> tcx))</span>
<span id="cb9928-10"><a href="copulas.html#cb9928-10" aria-hidden="true" tabindex="-1"></a>w.c <span class="ot">&lt;-</span> <span class="fu">wireframe2</span>(V_gumb, <span class="at">xlim =</span> lim, <span class="at">ylim =</span> lim, <span class="at">zlim =</span> zlim, <span class="at">zoom =</span> zm, <span class="at">scales =</span> scs,</span>
<span id="cb9928-11"><a href="copulas.html#cb9928-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">main =</span> <span class="fu">list</span>(<span class="at">label =</span> <span class="st">&quot;Meta-Clayton density with N(0,1) margins&quot;</span>, <span class="at">cex =</span> tcx))</span>
<span id="cb9928-12"><a href="copulas.html#cb9928-12" aria-hidden="true" tabindex="-1"></a>w.t <span class="ot">&lt;-</span> <span class="fu">wireframe2</span>(V_clay, <span class="at">xlim =</span> lim, <span class="at">ylim =</span> lim, <span class="at">zlim =</span> zlim, <span class="at">zoom =</span> zm, <span class="at">scales =</span> scs,</span>
<span id="cb9928-13"><a href="copulas.html#cb9928-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">main =</span> <span class="fu">list</span>(<span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="st">&quot;Meta-Gumbel density with N(0,1) margins&quot;</span>)),</span>
<span id="cb9928-14"><a href="copulas.html#cb9928-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">cex =</span> tcx))</span>
<span id="cb9928-15"><a href="copulas.html#cb9928-15" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(w.n, w.g, w.c, w.t, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-298-3.png" width="672" /></p>
<div class="sourceCode" id="cb9929"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9929-1"><a href="copulas.html#cb9929-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Lastly plot the contour plots</span></span>
<span id="cb9929-2"><a href="copulas.html#cb9929-2" aria-hidden="true" tabindex="-1"></a>tcx <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb9929-3"><a href="copulas.html#cb9929-3" aria-hidden="true" tabindex="-1"></a>c.n <span class="ot">&lt;-</span> <span class="fu">contourplot2</span>(V_gauss, <span class="at">xlim =</span> lim, <span class="at">ylim =</span> lim,</span>
<span id="cb9929-4"><a href="copulas.html#cb9929-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">main =</span> <span class="fu">list</span>(<span class="at">label =</span> <span class="st">&quot;Meta-Gauss contours with N(0,1) margins&quot;</span>, <span class="at">cex =</span> tcx))</span>
<span id="cb9929-5"><a href="copulas.html#cb9929-5" aria-hidden="true" tabindex="-1"></a>c.g <span class="ot">&lt;-</span> <span class="fu">contourplot2</span>(V_t, <span class="at">xlim =</span> lim, <span class="at">ylim =</span> lim,</span>
<span id="cb9929-6"><a href="copulas.html#cb9929-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">main =</span> <span class="fu">list</span>(<span class="at">label =</span> <span class="st">&quot;Meta-Gumbel contours with N(0,1) margins&quot;</span>, <span class="at">cex =</span> tcx))</span>
<span id="cb9929-7"><a href="copulas.html#cb9929-7" aria-hidden="true" tabindex="-1"></a>c.c <span class="ot">&lt;-</span> <span class="fu">contourplot2</span>(V_gumb, <span class="at">xlim =</span> lim, <span class="at">ylim =</span> lim,</span>
<span id="cb9929-8"><a href="copulas.html#cb9929-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">main =</span> <span class="fu">list</span>(<span class="at">label =</span> <span class="st">&quot;Meta-Clayton contours with N(0,1) margins&quot;</span>, <span class="at">cex =</span> tcx))</span>
<span id="cb9929-9"><a href="copulas.html#cb9929-9" aria-hidden="true" tabindex="-1"></a>c.t <span class="ot">&lt;-</span> <span class="fu">contourplot2</span>(V_clay, <span class="at">xlim =</span> lim, <span class="at">ylim =</span> lim,</span>
<span id="cb9929-10"><a href="copulas.html#cb9929-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">main =</span> <span class="fu">list</span>(<span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="st">&quot;Meta-&quot;</span><span class="sc">*</span><span class="fu">italic</span>(t)[<span class="dv">4</span>]<span class="sc">~</span><span class="st">&quot;contours with N(0,1) margins&quot;</span>)),</span>
<span id="cb9929-11"><a href="copulas.html#cb9929-11" aria-hidden="true" tabindex="-1"></a>                                <span class="at">cex =</span> tcx))</span>
<span id="cb9929-12"><a href="copulas.html#cb9929-12" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(c.n, c.g, c.c, c.t, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-298-4.png" width="672" /></p>
</div>
</div>
</div>
<div id="dependence-concepts-and-measures" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Dependence Concepts and Measures</h2>
<p>In this subchapter, we will introduce the concepts of perfect dependence, both positive and negative. Later on, we will focus on the three most common forms of dependence measures:</p>
<ul>
<li>Pearson linear correlation</li>
<li>Rank correlation</li>
<li>Coefficients of tail dependence</li>
</ul>
<p>All these dependence measures provide us with a scalar to quantify the strength of the co-dependence of two RVs.</p>
<div id="perfect-dependence" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Perfect Dependence</h3>
<p>We already defined the concepts of perfect negative and positive dependence when looking at the fundamental copulas. Therein, we saw the terms of comonotonicity and countermonotonicity. Let’s elaborate these two terms a little.</p>
<p><strong>comonotonicity</strong> are quasi undiversifiable RVs. Mathematically speaking, this means that the RVs <span class="math inline">\(X_1, \dots, X_d\)</span> are comonotonic if they have as a Copula the Fréchet upper bound <span class="math inline">\(min(u_1, \dots, u_d)\)</span>.</p>
<p>In other words, we can show that <strong>comonotonic RVs are monotonically increasing functions of a single RV</strong>. As such, we can propose that <span class="math inline">\(X_1, \dots, X_d\)</span> are comonotonic if and only if</p>
<p><span class="math display">\[
(X_1, \dots, X_d) =^d (\nu_1(Z), \dots, \nu_d(Z)) 
\]</span></p>
<p>for some RV Z and increasing functions <span class="math inline">\(\nu_i\)</span>.</p>
<p>An important result of comonotonicity is the <strong>additivity of the quantile functions</strong>. This concept applies to distortion risk measures, which we use to compute the Expected Shortfall (ES) of a distribution. As such we propose the following:</p>
<p>Let <span class="math inline">\(0 &lt; \alpha &lt; 1\)</span> and <span class="math inline">\(X_1, \dots, X_d\)</span> be comonotonic RVs with distribution functions <span class="math inline">\(F_1, \dots, F_d\)</span>. Then:</p>
<p><span class="math display">\[
F^{-1}_{X_1+\dots+X_d}(\alpha) = F^{-1}_1(\alpha) + \dots + F_d^{-1}(\alpha)
\]</span></p>
<p>With the same principles, we can also define the <strong>countermonotonicity</strong>. Two RVs are countermonotonic if their copula is the lower Fréchet Bound <span class="math inline">\(max(u_1 + u_2 -1,0)\)</span>. As such, we can propose the following:</p>
<p><span class="math inline">\(_1\)</span> and <span class="math inline">\(X_2\)</span> are countermonotonic if and only if:</p>
<p><span class="math display">\[
(X_1, X_2) =^d (\nu_1(Z), \nu_2(Z))
\]</span></p>
<p>for some RV Z with <span class="math inline">\(\nu_1\)</span> increasing and <span class="math inline">\(\nu_2\)</span> decreasing, or vice versa.</p>
<p>The concept of countermonotonicity does not generalize to higher dimensions. The Frechet lower bound is not itself a copula for d &gt; 2 since it is not a proper distribution function.</p>
</div>
<div id="dependence-measures" class="section level3" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Dependence Measures</h3>
<p>When we look at dependence measures, we most directly imply linear correlation measures. These are the most common tools used in finance. However, this dependence measure has certain important pitfalls when it comes to finance. This is because the concept of correlation is only really applicable in the concept of <strong>multivariate normal</strong> models.</p>
<p>The reason for this is that only multivariate normal distributions are fully described by the first two moments. That is, the mean vector and the covariance matrix. Basically, the Copula from such models depends solely on the correlation matrix and the characteristics function. Because of that, the correlation matrix has a parametric role in such models, which it <strong>does not have in more general multivariate models</strong>.</p>
<p>Based on this, using linear correlation measures has decisive pitfalls which we need to address once we are in non-multivariate Gaussian distributions. And the concepts of Copulas can help us to show these pitfalls.</p>
<div id="linear-correlation" class="section level4" number="6.2.2.1">
<h4><span class="header-section-number">6.2.2.1</span> Linear Correlation</h4>
<p>The correlation <span class="math inline">\(\rho(X_1,X_2)\)</span> between two RVs is a form of <em>linear dependence</em> taking values from -1 to 1.</p>
<p>Further, linear dependence is <em>invariant under strictly increasing linear transformations</em>, which implies that:</p>
<p><span class="math display">\[
\rho(\alpha_1 + \beta_1X_1, \alpha_2 + \beta_2X_2) = \rho(X_1,X_2)
\]</span></p>
<p>Furthermore, we need to stress that correlation is only defined if the <strong>variances of the RVs are finite</strong>. This restriction to finite-variance models is not ideal for a dependence measure and can cause problems when we work with heavy-tailed distributions.</p>
<p>Based on these properties, let’s now see certain important fallacies of linear correlation. We believe these fallacies are worth highlighting because they illustrate the dangers of attempting to construct multivariate risk models starting from marginal distributions and estimates of the correlations between risks.</p>
<div id="fallacy-1-the-marginal-distributions-and-pairwise-correlations-of-a-random-vector-determine-its-joint-distribution" class="section level5" number="6.2.2.1.1">
<h5><span class="header-section-number">6.2.2.1.1</span> Fallacy 1: The marginal distributions and pairwise correlations of a random vector determine its joint distribution</h5>
<p>This is not the case. If we have two RVs <span class="math inline">\(X_1, X_2\)</span> that have continuous marginal distributions <span class="math inline">\(F_1, F_2\)</span> and joint CDF <span class="math inline">\(C(F_1(x_1), F_2(x_2))\)</span> (=Sklar) for some Copula C with a correlation of <span class="math inline">\(\rho\)</span>, then it will be possible to construct an alternative copula <span class="math inline">\(C_2 \neq C\)</span> and to construct a random vector with the same CDF as before such that we will again obtain as a correlation factor <span class="math inline">\(\rho\)</span>.</p>
<p>We can make an example below. Doing so, assum that we have two RVs with profits and losses on two portfolios. Suppose we are given the information that both risks have standard normal distributions and that their correlation is 0. We construct two random vectors that are consistent with this information.</p>
<ul>
<li>Model 1: <span class="math inline">\(X\sim N_2(0, I_2)\)</span></li>
<li>Model 2: P(V=1) = P(V=-1) = 0.5 <span class="math inline">\(\rightarrow (Y_1, Y_2) = (X_1, VX_1)\)</span></li>
</ul>
<p>Based on the two apparently different models which still have the same standard normal distribution properties, we can show that the correlsation of the risk does not depend on their copula.</p>
<div class="sourceCode" id="cb9930"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9930-1"><a href="copulas.html#cb9930-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simple example with same margins, rho = 0, but (obviously) different models</span></span>
<span id="cb9930-2"><a href="copulas.html#cb9930-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb9930-3"><a href="copulas.html#cb9930-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">271</span>)</span>
<span id="cb9930-4"><a href="copulas.html#cb9930-4" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb9930-5"><a href="copulas.html#cb9930-5" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb9930-6"><a href="copulas.html#cb9930-6" aria-hidden="true" tabindex="-1"></a>V <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, n)</span>
<span id="cb9930-7"><a href="copulas.html#cb9930-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9930-8"><a href="copulas.html#cb9930-8" aria-hidden="true" tabindex="-1"></a>V[U <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span> <span class="co"># =&gt; V in {-1,1}, each with probability 1/2</span></span>
<span id="cb9930-9"><a href="copulas.html#cb9930-9" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Z, Z<span class="sc">*</span>V) <span class="co"># convex combination of W and M (each with prob. 1/2 =&gt; rho = 0)</span></span>
<span id="cb9930-10"><a href="copulas.html#cb9930-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(X)[<span class="dv">2</span>,<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] -0.09244841</code></pre>
<div class="sourceCode" id="cb9932"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9932-1"><a href="copulas.html#cb9932-1" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> <span class="dv">2</span>), <span class="at">ncol =</span> <span class="dv">2</span>) <span class="co"># independent N(0,1) (=&gt; rho = 0)</span></span>
<span id="cb9932-2"><a href="copulas.html#cb9932-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(Y)[<span class="dv">2</span>,<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] -0.03559857</code></pre>
<div class="sourceCode" id="cb9934"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9934-1"><a href="copulas.html#cb9934-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plots</span></span>
<span id="cb9934-2"><a href="copulas.html#cb9934-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X, <span class="at">xlab =</span> <span class="fu">expression</span>(X[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(X[<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-299-1.png" width="672" /></p>
<div class="sourceCode" id="cb9935"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9935-1"><a href="copulas.html#cb9935-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Y, <span class="at">xlab =</span> <span class="fu">expression</span>(Y[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(Y[<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-299-2.png" width="672" /></p>
</div>
<div id="or-given-univariate-distributions-f_1-and-f_2-and-any-correlation-rho-in--11-it-is-always-possible-to-construct-a-joint-distribution-f-with-margins-f_1-f_2-and-correlation-rho." class="section level5" number="6.2.2.1.2">
<h5><span class="header-section-number">6.2.2.1.2</span> or given univariate distributions <span class="math inline">\(F_1\)</span> and <span class="math inline">\(F_2\)</span> and any correlation <span class="math inline">\(\rho\)</span> in [-1,1] it is always possible to construct a joint distribution F with margins <span class="math inline">\(F_1, F_2\)</span> and correlation <span class="math inline">\(\rho\)</span>.</h5>
<p>This is only true in the case that <span class="math inline">\(F_1\)</span> and <span class="math inline">\(F_2\)</span> are margins of multivariate distributions. We can form a <strong>strict subset</strong> of [-1,1] for the correlation properties of two RVs when we have different distribution. This is known as <strong>Attainable Correlations</strong>. This can be shown by the following theorem.</p>
<p>For that, assume that we have <span class="math inline">\(X_1, X_2\)</span> that has joint distribution F and marginal distributions <span class="math inline">\(F_1, F_2\)</span>. Then, the covariance of <span class="math inline">\(X_1, X_2\)</span>, when finite, is given by:</p>
<p><span class="math display">\[
cov(X_1, X_2) = \int^\infty_{-\infty}\int^\infty_{-\infty}(F(x_1, x_2) - F_1(x_1)F_2(x_2))dx_1dx_2
\]</span></p>
<p>Consequently, it is not defined for the entire span of <span class="math inline">\([-\infty, \infts]\)</span> if we deviate from multivariate normal distribution.</p>
<p>In essence, attainable correlation is a fact which theorem stating that two RVs can only attain a finite and limited correlation between [-1,1], but never actually reach the entire possible spectrum, unless they follow a multivariate normal distribution. As such, the possible range of correlations:</p>
<ul>
<li>depend on the distribution</li>
<li>depend on the type of each RV</li>
<li>depend on the variance of the RV</li>
</ul>
<p>More precisely, they state:</p>
<ul>
<li>The attainable correlations form a closed interval with <span class="math inline">\(\rho_\min &lt; 0 &lt; \rho_\max\)</span></li>
<li>The minimum correlation is only possible for countermonotonic RVs and the maximum only for comonotonic RVs</li>
<li><span class="math inline">\(\rho =-1\)</span> or <span class="math inline">\(\rho = 1\)</span> only if both RVs are of the <em>same type</em></li>
</ul>
<p>Let’s look at <strong>lognormal distributions</strong> as a simple example. Let’s suppose that <span class="math inline">\(X_1 \sim N(0,1\)</span> and <span class="math inline">\(X_2 \sim N(0, \sigma^2)\)</span>. For <span class="math inline">\(\sigma \neq 1\)</span>, both RVs have a different type, so we will never reach the maximum or minimum correlation value. If both RVs are comonotonic, then we know that <span class="math inline">\((X_1, X_2) =^d (e^Z, e^{\sigma Z})\)</span>. As such, we obtain <span class="math inline">\(\rho_\min = \rho(e^Z, e^{\sigma Z})\)</span> and <span class="math inline">\(\rho_\max = \rho(e^Z, e^{-\sigma Z})\)</span>. We can analytically insert this relation into the RVs and obtain minimum and maximum values for the log-normal variable:</p>
<p><span class="math display">\[
\rho_\min = \frac{e^{-\sigma} - 1}{\sqrt{(e-1)(e^{\sigma^2} - 1)}}
\]</span></p>
<p><span class="math display">\[
\rho_\max = \frac{e^{\sigma} - 1}{\sqrt{(e-1)(e^{\sigma^2} - 1)}}
\]</span></p>
<p>Consequently, we can see that the bound of the correlations depends on the variance of both RVs.</p>
</div>
</div>
<div id="rank-correlation" class="section level4" number="6.2.2.2">
<h4><span class="header-section-number">6.2.2.2</span> Rank Correlation</h4>
<p>Rank correlations are simple scalar measures of dependence that depend <strong>only on the copula of a bivariate distribution</strong> and <strong>not on the marginal distributions</strong>, unlike linear correlation, which depends on both. To quantify these correlations, we only need to know the ordering of the sample for each variable of interest and not the actual numerical values.</p>
<p>The main practical reason for looking at rank correlations is that they can be used to <strong>calibrate copulas to empirical data</strong>.</p>
<p>There are two main varieties of rank correlation, <strong>Kendall’s and Spearman’s</strong>, and both can be understood as a measure of <strong>concordance</strong> for bivariate random vectors. Let’s quickly define this term.</p>
<p>Two points defined by (<span class="math inline">\(x_1, x_2\)</span>) and <span class="math inline">\((y_1,y_2)\)</span> are concordant if <span class="math inline">\((x_1, x_2)(y_1,y_2) &gt; 0\)</span>. In other words, they are concordant if the ranking of <span class="math inline">\(x_1\)</span> relative to <span class="math inline">\(y_1\)</span> is the same as for <span class="math inline">\(x_2\)</span> and <span class="math inline">\(y_2\)</span>. Similarily, they are discordant if <span class="math inline">\((x_1, x_2)(y_1,y_2) &lt; 0\)</span>.</p>
<div id="kendalls-tau" class="section level5" number="6.2.2.2.1">
<h5><span class="header-section-number">6.2.2.2.1</span> Kendall’s Tau</h5>
<p>Based on this, we can define the term <strong>Kendall’s Tau</strong>. Kendall’s tau is the probability of a concordant pair minus the probability of a discordant pair. Therefore, it is given by:</p>
<p><span class="math display">\[
\rho_\tau(X_1, X_2) = E(sign((x_1-y_1)(x_2-y_2)))
\]</span></p>
<p>In other word,s if <span class="math inline">\(x_1\)</span> tends to increase with <span class="math inline">\(x_2\)</span>, then we expect the probability of concordance to be high relative to the probability of discordance, and vice versa.</p>
<p>Further, we can show that Kendall’s tau is invariant to monotonically increasing transformations. If g and h are the marginal CDFs of <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> then <span class="math inline">\(\rho\tau(g(X_1), h(X_2))\)</span> value of Kendall’s tau for a <strong>pair of random variables distributed according to the copula of</strong> <span class="math inline">\(C(X_1, X_2)\)</span>. This shows that Kendall’s tau depends only on the *<strong>copula of a bivariate random vector.</strong></p>
</div>
<div id="spearmans-rho" class="section level5" number="6.2.2.2.2">
<h5><span class="header-section-number">6.2.2.2.2</span> Spearman’s rho</h5>
<p>For a sample, Spearman’s correlation coefficient is simply the <strong>usual Pearson correlation calculated from the marginal ranks of the data</strong>. Consequently, the coefficient for a bivariate random vector is denoted as <span class="math inline">\(\rho_s(X_1, X_2)\)</span> and is defined as:</p>
<p><span class="math display">\[
\rho_s(X_1, X_2) = corr(F_{X_1}(X_1), F_{X_2}(X_2))
\]</span></p>
<p>which is the Pearson coefficient. Since the joint CDF of <span class="math inline">\((F_{X_1}(X_1), F_{X_2}(X_2)\)</span> is the Copula of <span class="math inline">\((X_1, X_2)\)</span>, rho also depends <strong>only on the copula function</strong>.</p>
</div>
</div>
<div id="tail-dependence" class="section level4" number="6.2.2.3">
<h4><span class="header-section-number">6.2.2.3</span> Tail Dependence</h4>
<p>Tail dependence measures association between the extreme values of two random variables and depends only on their copula. The first definition is lower tail dependence. We look at these measures to quantify the strength of dependence in the tails of a bivariate distribution.</p>
<p>In the case of upper (lower) tail dependence we consider the probability that <span class="math inline">\(X_2\)</span> exceeds its q-quantile (1-q quantile), given that <span class="math inline">\(X_1\)</span> exceeds its q-quantile (1-q quantile). Then we consider the limit as q approaches one.</p>
<p>For instance, we obtain the coefficient of lower tail dependence, which is denoted by <span class="math inline">\(\lambda_l\)</span> and is defined as:</p>
<p><span class="math display">\[
\begin{align}
\lambda_l &amp;= \lim_{q \downarrow 0}P(X_2 \leq F_{X_2}^{-1}(q)|X_1 \leq F_{X_1}^{-1}(q))\\
&amp;= \lim_{q \downarrow 0}\frac{P(X_2 \leq F_{X_2}^{-1}(q), X_1 \leq F_{X_1}^{-1}(q))}{P(X_1 \leq F_{X_1}^{-1}(q))} \\
&amp;= \lim_{q \downarrow 0}\frac{P(X_2 F_{X_2}\leq q, X_1F_{X_1} \leq q}{P(X_1F_{X_1} \leq q)} \\
&amp;= \lim_{q \downarrow 0} \frac{C_x(q,q)}{q}
\end{align}
\]</span></p>
<p>We simply derive the functional value of the lower tail risk as the probability that <span class="math inline">\(X_2\)</span> is less than or equal its q’th quantile, conditional on that <span class="math inline">\(X_1\)</span> is less than or equal its q’th quantile. We then transform this to a conditional probability statement and finally figure that the numerator is, by definition, the copula, as it gives us a quantile value for the specific RVs, conditional on the other RV.</p>
<p>The coefficient of upper tail dependence can be derived accordingly. It is given by:</p>
<p><span class="math display">\[
\begin{align}
\lambda_u &amp;= \lim_{q \uparrow 1} \frac{P(X_2F_{X_2} \geq q, P(X_1F_{X_1} \geq q)}{P(X_1F_{X_1} \geq q)} \\
&amp;= \lim_{q \uparrow 1} \frac{\hat C_x(1-q, 1-q)}{1-q}
\end{align}
\]</span></p>
<p>whereas <span class="math inline">\(\hat C\)</span> is the <em>survival copula of C</em>.</p>
</div>
</div>
</div>
<div id="normal-mixture-copulas" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Normal Mixture Copulas</h2>
<p>We understand that <strong>each multivariate distribution with continuous marginal distributions</strong> contains a unique copula. Instead of a multivariate normal distribution, we have also encountered different multivariate distributions, which we labelled as <strong>multivariate mixture distributions</strong>. As such, we can also create copulas from these distributions.</p>
<p>Whenever we fit normal mixture distributions to multivariate returns or use them in multivariate time-series models, we use <strong>normal mixture copulas</strong>.</p>
<div id="tail-dependence-1" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Tail Dependence</h3>
<p>The tail dependence coefficients of normal mixture copulas the importance of a <strong>joint quantile exceedance probability</strong>. That is, the probability that d returns exceed a certain threshold at one given trading period. In other words, it can show us in how many trading periods we can expect to obtain such an event on average.</p>
<p>Why do we consider mixture models here? Remember, we showed that the multivariate normal distribution is not likely to accurately reflect security returns in the tails. As such, we used different (symmetric and skewed) multivariate distributions which better suit the requirement. Some of the models considered were called Normal Mixture Models. Since Copulas define the conditional likelihood of two RVs exceeding a given threshold, and since these models have also Copulas, we may assume that these Copulas are better suited to quantify said probability of exceeding a given threshold.</p>
<p>Since we have reasoned the use of these copulas, we can define the <strong>coefficient of tail dependence for normal mixture copulas</strong>. This is given by:</p>
<p><span class="math display">\[
\lambda = lim_{q \downarrow 0} \frac{dC(q,q)}{dq} = lim_{q \downarrow 0} P(U_2 \leq q | U_1 = q) + lim_{q \downarrow 0} P(U_1 \leq q | U_2 = q) = 2 lim_{q \downarrow 0} P(U_2 \leq q | U_1 = q)
\]</span></p>
<p>Let’s consider now two important normal mixture copulas: The Gaussian and the t Copula.</p>
<div id="asymptotic-independence-of-gauss-copula-and-asymptotic-dependence-of-t-copula" class="section level4" number="6.3.1.1">
<h4><span class="header-section-number">6.3.1.1</span> asymptotic independence of Gauss Copula and asymptotic dependence of t Copula</h4>
<p>We can show that the Gaussian Copula is <strong>asymptotically independent in the tails</strong>. This is theoretically intuitive, as we state that the Gaussian Copula does not assume tail dependence,long as <span class="math inline">\(\rho &lt; 1\)</span>. Regardless of how high a correlation we choose, if we go far enough into the tail, <strong>extreme events appear to occur independently in each margin</strong>.</p>
<p>We can show this by the following definitions. We let <span class="math inline">\((X_1, X_2) = m(\phi^{-1}(U_1),\phi^{-1}(U_2))\)</span>. As such, <span class="math inline">\(X_1, X_2\)</span> has a bivariate normal distribution with standard margins and correlation <span class="math inline">\(\rho\)</span>. Then we have:</p>
<p><span class="math display">\[
\begin{align}
\lambda &amp;= \lim_{x \rightarrow -\infty} P(X_2 \leq x| X_1 = x)
\end{align}
\]</span></p>
<p>Using that <span class="math inline">\(X_2|X_1 = x \sim N(\rho x, 1- \rho^2)\)</span>, we can calculate:</p>
<p><span class="math display">\[
\lambda = 2 \lim_{x \rightarrow \infty \phi(x\sqrt{1-\rho})/\sqrt{1-\rho}} = 0
\]</span></p>
<p>And, as such, there is no tail dependence even for increasing <span class="math inline">\(\rho\)</span>.</p>
<p>As opposed we can show that the t Copula with a univariate t distribution and <span class="math inline">\(\nu\)</span> DOF, has the following tail dependence:</p>
<p><span class="math display">\[
\lambda = 2t_{\nu+1}(-\sqrt{(\nu + 1)(1-\rho)}{1+\rho})
\]</span></p>
<p>We deliberately only quantify the t and Gauss here because it can be shown that most other normal mixture model copulas have the same tail properties as the Gaussian (such as hyperbolic or NIG). That is, they are asymptotically independent in the tails. Interestingly, we can claim the following: The decision whether a normal mixture variable has asymptotic tail dependence depends on the <strong>distribution of W</strong>. If <strong>W has a distribution with a power tail, then we get tail dependence, otherwise we get asymptotic independence.</strong></p>
<div class="sourceCode" id="cb9936"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9936-1"><a href="copulas.html#cb9936-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s compute the tail probabilities. That is, the probability that, at any given day, the value of each individual asset will be below its 1% quantile value of its underlying distribution. Since we model the common part of the marginal continuous distributions of an overall joint distribution with Copulas, we can use them to compare t and normal distributions. </span></span>
<span id="cb9936-2"><a href="copulas.html#cb9936-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9936-3"><a href="copulas.html#cb9936-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Make the set up to comparison </span></span>
<span id="cb9936-4"><a href="copulas.html#cb9936-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">80</span></span>
<span id="cb9936-5"><a href="copulas.html#cb9936-5" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fl">0.99</span> <span class="co"># quantile to exceed </span></span>
<span id="cb9936-6"><a href="copulas.html#cb9936-6" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>)</span>
<span id="cb9936-7"><a href="copulas.html#cb9936-7" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">9</span>, <span class="dv">10000</span>) <span class="co"># DOF </span></span>
<span id="cb9936-8"><a href="copulas.html#cb9936-8" aria-hidden="true" tabindex="-1"></a>len <span class="ot">&lt;-</span> <span class="fu">length</span>(rho) <span class="sc">*</span> <span class="fu">length</span>(nu)</span>
<span id="cb9936-9"><a href="copulas.html#cb9936-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9936-10"><a href="copulas.html#cb9936-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Create tail probs </span></span>
<span id="cb9936-11"><a href="copulas.html#cb9936-11" aria-hidden="true" tabindex="-1"></a>tail_probs <span class="ot">&lt;-</span> <span class="fu">matrix</span>(, <span class="at">nrow =</span> <span class="fu">length</span>(d), <span class="at">ncol =</span> len <span class="sc">+</span> <span class="dv">1</span>,</span>
<span id="cb9936-12"><a href="copulas.html#cb9936-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="at">rownames =</span> <span class="fu">seq_along</span>(d), </span>
<span id="cb9936-13"><a href="copulas.html#cb9936-13" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">colnames =</span> <span class="fu">c</span>(<span class="st">&quot;d&quot;</span>, </span>
<span id="cb9936-14"><a href="copulas.html#cb9936-14" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">&quot;rho=0.9-nu=3&quot;</span>, <span class="st">&quot;rho=0.9-nu=5&quot;</span>, <span class="st">&quot;rho=0.9-nu=9&quot;</span>, <span class="st">&quot;rho=0.9-nu=10000&quot;</span>,</span>
<span id="cb9936-15"><a href="copulas.html#cb9936-15" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">&quot;rho=0.6-nu=3&quot;</span>, <span class="st">&quot;rho=0.6-nu=5&quot;</span>, <span class="st">&quot;rho=0.6-nu=9&quot;</span>, <span class="st">&quot;rho=0.6-nu=10000&quot;</span>,</span>
<span id="cb9936-16"><a href="copulas.html#cb9936-16" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">&quot;rho=0.3-nu=3&quot;</span>, <span class="st">&quot;rho=0.3-nu=5&quot;</span>, <span class="st">&quot;rho=0.3-nu=9&quot;</span>, <span class="st">&quot;rho=0.3-nu=10000&quot;</span>)))</span>
<span id="cb9936-17"><a href="copulas.html#cb9936-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9936-18"><a href="copulas.html#cb9936-18" aria-hidden="true" tabindex="-1"></a>tail_probs[,<span class="dv">1</span>] <span class="ot">&lt;-</span> d</span>
<span id="cb9936-19"><a href="copulas.html#cb9936-19" aria-hidden="true" tabindex="-1"></a>expr <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;expression&quot;</span>, len) <span class="co"># vector of expressions</span></span>
<span id="cb9936-20"><a href="copulas.html#cb9936-20" aria-hidden="true" tabindex="-1"></a>ltys <span class="ot">&lt;-</span> <span class="fu">numeric</span>(len) <span class="co"># line types</span></span>
<span id="cb9936-21"><a href="copulas.html#cb9936-21" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">numeric</span>(len) <span class="co"># colors</span></span>
<span id="cb9936-22"><a href="copulas.html#cb9936-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9936-23"><a href="copulas.html#cb9936-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Now creation of double loop in order to fill the matrix with the different values</span></span>
<span id="cb9936-24"><a href="copulas.html#cb9936-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9936-25"><a href="copulas.html#cb9936-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(rho)) { <span class="co"># rho</span></span>
<span id="cb9936-26"><a href="copulas.html#cb9936-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="fu">seq_along</span>(nu)) { <span class="co"># degrees of freedom</span></span>
<span id="cb9936-27"><a href="copulas.html#cb9936-27" aria-hidden="true" tabindex="-1"></a>        k <span class="ot">&lt;-</span> <span class="fu">length</span>(nu)<span class="sc">*</span>(i<span class="dv">-1</span>)<span class="sc">+</span>j</span>
<span id="cb9936-28"><a href="copulas.html#cb9936-28" aria-hidden="true" tabindex="-1"></a>        tail_probs <span class="ot">&lt;-</span> <span class="fu">cbind</span>(tail_probs, <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(d)))</span>
<span id="cb9936-29"><a href="copulas.html#cb9936-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(l <span class="cf">in</span> <span class="fu">seq_along</span>(d)) { <span class="co"># dimension</span></span>
<span id="cb9936-30"><a href="copulas.html#cb9936-30" aria-hidden="true" tabindex="-1"></a>            <span class="do">## Create the copula</span></span>
<span id="cb9936-31"><a href="copulas.html#cb9936-31" aria-hidden="true" tabindex="-1"></a>            cop <span class="ot">&lt;-</span> <span class="fu">ellipCopula</span>(<span class="st">&quot;t&quot;</span>, <span class="at">param=</span>rho[i], <span class="at">dim=</span>d[l], <span class="at">df=</span>nu[j])</span>
<span id="cb9936-32"><a href="copulas.html#cb9936-32" aria-hidden="true" tabindex="-1"></a>            <span class="do">## Evaluate P(U_1 &gt; u, ..., U_d &gt; u) = P(U_1 &lt;= 1-u, ..., U_d &lt;= 1-u)</span></span>
<span id="cb9936-33"><a href="copulas.html#cb9936-33" aria-hidden="true" tabindex="-1"></a>            tail_probs[l,k<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">pCopula</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">-</span>u, d[l]), <span class="at">copula=</span>cop)</span>
<span id="cb9936-34"><a href="copulas.html#cb9936-34" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb9936-35"><a href="copulas.html#cb9936-35" aria-hidden="true" tabindex="-1"></a>        <span class="do">## Create plot information</span></span>
<span id="cb9936-36"><a href="copulas.html#cb9936-36" aria-hidden="true" tabindex="-1"></a>        expr[k] <span class="ot">&lt;-</span> <span class="fu">as.expression</span>(</span>
<span id="cb9936-37"><a href="copulas.html#cb9936-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">substitute</span>(<span class="fu">group</span>(<span class="st">&quot;(&quot;</span>, <span class="fu">list</span>(rho, nu), <span class="st">&quot;)&quot;</span>)<span class="sc">==</span><span class="fu">group</span>(<span class="st">&quot;(&quot;</span>, <span class="fu">list</span>(r., n.), <span class="st">&quot;)&quot;</span>),</span>
<span id="cb9936-38"><a href="copulas.html#cb9936-38" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">list</span>(<span class="at">r.=</span>rho[i], <span class="at">n.=</span><span class="cf">if</span>(nu[j]<span class="sc">==</span><span class="dv">10000</span>) <span class="fu">bquote</span>(infinity) <span class="cf">else</span> nu[j])))</span>
<span id="cb9936-39"><a href="copulas.html#cb9936-39" aria-hidden="true" tabindex="-1"></a>        ltys[k] <span class="ot">&lt;-</span> <span class="fu">length</span>(rho)<span class="sc">-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb9936-40"><a href="copulas.html#cb9936-40" aria-hidden="true" tabindex="-1"></a>        cols[k] <span class="ot">&lt;-</span> col[j]</span>
<span id="cb9936-41"><a href="copulas.html#cb9936-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9936-42"><a href="copulas.html#cb9936-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9936-43"><a href="copulas.html#cb9936-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9936-44"><a href="copulas.html#cb9936-44" aria-hidden="true" tabindex="-1"></a><span class="do">## Standardize w.r.t. Gauss case: tail probabilities as factors in comparison to Gauss case</span></span>
<span id="cb9936-45"><a href="copulas.html#cb9936-45" aria-hidden="true" tabindex="-1"></a>tail_probs_fact <span class="ot">&lt;-</span> tail_probs</span>
<span id="cb9936-46"><a href="copulas.html#cb9936-46" aria-hidden="true" tabindex="-1"></a>tail_probs_fact[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> tail_probs_fact[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]<span class="sc">/</span>tail_probs_fact[,<span class="dv">5</span>]</span>
<span id="cb9936-47"><a href="copulas.html#cb9936-47" aria-hidden="true" tabindex="-1"></a>tail_probs_fact[,<span class="dv">6</span><span class="sc">:</span><span class="dv">9</span>] <span class="ot">&lt;-</span> tail_probs_fact[,<span class="dv">6</span><span class="sc">:</span><span class="dv">9</span>]<span class="sc">/</span>tail_probs_fact[,<span class="dv">9</span>]</span>
<span id="cb9936-48"><a href="copulas.html#cb9936-48" aria-hidden="true" tabindex="-1"></a>tail_probs_fact[,<span class="dv">10</span><span class="sc">:</span><span class="dv">13</span>] <span class="ot">&lt;-</span> tail_probs_fact[,<span class="dv">10</span><span class="sc">:</span><span class="dv">13</span>]<span class="sc">/</span>tail_probs_fact[,<span class="dv">13</span>]</span>
<span id="cb9936-49"><a href="copulas.html#cb9936-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9936-50"><a href="copulas.html#cb9936-50" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot </span></span>
<span id="cb9936-51"><a href="copulas.html#cb9936-51" aria-hidden="true" tabindex="-1"></a>tail_probs_fact <span class="sc">%&gt;%</span> </span>
<span id="cb9936-52"><a href="copulas.html#cb9936-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9936-53"><a href="copulas.html#cb9936-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">13</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9936-54"><a href="copulas.html#cb9936-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">&quot;key&quot;</span>, <span class="at">value =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9936-55"><a href="copulas.html#cb9936-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">79</span>,<span class="dv">1</span>), <span class="dv">12</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb9936-56"><a href="copulas.html#cb9936-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>d, <span class="at">y =</span> value, <span class="at">color =</span> key)) <span class="sc">+</span> </span>
<span id="cb9936-57"><a href="copulas.html#cb9936-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb9936-58"><a href="copulas.html#cb9936-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="co"># Log scale</span></span>
<span id="cb9936-59"><a href="copulas.html#cb9936-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Tail probability of t standardized by Gaussian distribution&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9936-60"><a href="copulas.html#cb9936-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="sc">~</span><span class="fu">log</span>(<span class="fu">P</span>(U[<span class="dv">1</span>]<span class="sc">&gt;</span>u,..,U[d]<span class="sc">&gt;</span>u))) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Assets in Portfolio&quot;</span>) <span class="sc">+</span></span>
<span id="cb9936-61"><a href="copulas.html#cb9936-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9936-62"><a href="copulas.html#cb9936-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9936-63"><a href="copulas.html#cb9936-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">lineheight=</span><span class="fl">1.2</span>, <span class="at">margin=</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">15</span>,<span class="dv">15</span>)), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9936-64"><a href="copulas.html#cb9936-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9936-65"><a href="copulas.html#cb9936-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9936-66"><a href="copulas.html#cb9936-66" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9936-67"><a href="copulas.html#cb9936-67" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9936-68"><a href="copulas.html#cb9936-68" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9936-69"><a href="copulas.html#cb9936-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9936-70"><a href="copulas.html#cb9936-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-300-1.png" width="672" /></p>
<p>The above example shows a plot with dimensions of the Copula on the x-axis and the tail probability standardised by Gauss. In essence, this table states us how many times more likely a tail probability is given different combinations of the t distribution, compared to the Copula indicated by the Gaussian distribution. In order to interpret this plot, let us assume that we have daily stock returns. Let’s now take that <span class="math inline">\(\rho = 0.6\)</span> and <span class="math inline">\(\nu = 5\)</span> as well as that d = 20. In this case, we assume that the correlation between each asset is 0.6 and we have 5 DOF and we have 10 securities. Based on this, the table tells us the following: When we assume that each return follows this t distribution configuration, we assign an approximately 10! times higher likelihood to the event that on any day all returns are below the 1% quantiles of their respective distributions, compared to modelling the returns as multivariate Gaussian.</p>
<p>This shows us that t Copulas are far better equipped to measure tail risk, and the difference can be dramatic! As such, having Copulas for t distributions are more likely to better measure or estimate joint tail risks (respectively, the part of the distribution which represents the joint risk component).</p>
</div>
</div>
</div>
<div id="archimedean-copulas" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Archimedean Copulas</h2>
<p>Besides Clayton and Gumbel, there are two further Copulas which are frequently used in credit risk management. In general, this family has proved useful for modelling <strong>portfolio credit risk</strong>.</p>
<div id="frank-copula-and-general-clayton-copula" class="section level3" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Frank Copula and General Clayton Copula</h3>
<p>The first copula is the Frank copula. It is defined as:</p>
<p><span class="math display">\[
C_\theta^{Fr}(u_1, u_2) = -\frac{1}{\theta}\ln(1 + \frac{(e^{-\theta u_1}-1)(e^{\theta u_2}-1)}{e^{-\theta}-1})
\]</span></p>
<p>The second is called the General Clayton Copula. It is defined as:</p>
<p><span class="math display">\[
C_{\theta, \delta}^{GC}(u_1, u_2) = (((u_1^{-\theta}-1)^\delta + (u_2^{-\delta} - 1)^\delta)^{1/\delta} + 1)^{-1/\delta}
\]</span></p>
<p>We can show that, if <span class="math inline">\(\theta\)</span> is within the ranges specified for each Copula, then all four examples of the Copulas have the form:</p>
<p><span class="math display">\[
C(u_1, u_2) = \vega(\vega^{-1}(u_1)+\vega^{-1}(u_2))
\]</span></p>
<p>where <span class="math inline">\(\vega: [0,\infty) \rightarrow [0,1]\)</span> is a decreasing and continuous function with <span class="math inline">\(\vega(0) = 1\)</span> and the limit at 0. As such this is a function that is <strong>convex</strong>.</p>
<p>This <span class="math inline">\(\vega\)</span> function is also known as th <strong>generator function</strong>. We need these generators in order to calculate the <strong>Kendall’s rank correlations</strong> pf the copulas by taking the inverse of each generator.</p>
<p>We will provide you with a summary table which shows the generators, permissible parameter values and limiting special cases for the Archimedan copulas. Further, we will also provide you with Kendall’s rank correlations and coefficients of tail dependence for the copulas, in order to understand the critical values for calculating the risk correlation properties of these copulas.</p>
<div class="figure">
<img src="Images/Archi_Gen.jpg" alt="" />
<p class="caption">Figure 1: Archimedean Copulas: Table summarizing the generators, permissible parameter values and limiting special cases</p>
</div>
<div class="figure">
<img src="Images/Archi_Ken.jpg" alt="" />
<p class="caption">Figure 2: Kendall’s rank correlations and coefficients of tail dependence for the copulas</p>
</div>
</div>
</div>
<div id="applying-copulas-with-actual-data" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Applying Copulas with actual data</h2>
<p>We have now had a pretty extensive discussion on copulas and their advantages. We have shown their theoretical properties and their differences as well as given examples for distributions of multivariate data depending on different copulas. Now, it is time to finally set them into action for real-life data.</p>
<p>For that we will look at financial returns of the big four companies. We also make the usual assumptions to form copulas. That is, we assume that <strong>X</strong> has a continuous distribution function with continuous margins <strong>F</strong>, such that, under sklar, we can represent <span class="math inline">\(F(x) = C(F_1(x_1), \dots, F_d(x_d))\)</span>.</p>
<p>We now attempt to find a model which can describe both the <strong>marginal behaviour</strong> of its individual constituents as well as the <strong>dependence structure</strong> of the underlying multivariate RV. We can separate both parts by using copulas. In order to do so, we need to estimate the factor <span class="math inline">\(\theta\)</span> from the Copula <span class="math inline">\(C_\theta\)</span>.</p>
<p>Doing so, we will use the Rank correlation coefficients as well as the <strong>Maximum Likelihood Method</strong> which we discussed in Chapter 4.</p>
<div id="estimating-copulas-method-of-moments-using-rank-correlations" class="section level3" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Estimating Copulas: Method-of-Moments using Rank Correlations</h3>
<p>Depending on which particular copula we want to fit, it may be easier to use empirical estimates of either Spearman’s or Kendall’s rank correlation to infer an estimate for the copula parameter.</p>
<p>As such, we can either use sample rank correlation in order to calibrate the Copulas under consideration.</p>
<div id="spearmans-rho-1" class="section level4" number="6.5.1.1">
<h4><span class="header-section-number">6.5.1.1</span> Spearman’s Rho</h4>
<p>Note that we stated we can estimate <span class="math inline">\(\rho_S(X_i, X_j)\)</span> by calculating the usual <strong>correlation coefficient for the pseudo-observations</strong> <span class="math inline">\(F_{i,n}(X_{t,i), F_{j,n}(X_{t,j))\)</span>. Since this is equal to the <strong>Spearman rank correlation coefficient</strong> when there are no tied observations, we estimate <span class="math inline">\(\rho_S(X_i, X_j)\)</span> by calculating the Spearman’s rank correlation coefficient.</p>
<p>This rank is just the position of <span class="math inline">\(X_{i,t}\)</span> in the ordered sample of observations. In the case of tied observations, we just assign them the average rank we would have if there were no tied observations. E.g.: [2, 3, 2, 1] would have ranks [2.5, 4, 2.5, 1].</p>
<p>Based on this, we obtain the usual formula for the Spearman Rank correlation coefficient. The copula calibrates are then just the ranks of the observations.</p>
</div>
<div id="kendalls-tau-1" class="section level4" number="6.5.1.2">
<h4><span class="header-section-number">6.5.1.2</span> Kendall’s Tau</h4>
<p>Another way to calibrate the copulas is with the same idea but under usage of a different rank correlation coefficient: Kendall’s Tau. This will provide you with the same results, but with a different methodology, for finding the ranks of the distribution. Again, we can then collect pairwise Kendall’s rank correlation coefficients in a matrix.</p>
</div>
</div>
<div id="estimating-copulas-maximum-likelihood-estimation-mle" class="section level3" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Estimating Copulas: Maximum Likelihood Estimation (MLE)</h3>
<p>We can also estimate copulas through MLE. We usually require besides the copula estimate also the estimates of the margins to create a full multivariate model, since we need margins to estimate copulas.</p>
<p>We usually do this by following <strong>two steps</strong>:</p>
<ul>
<li>Forming a Pseudo-sample from the Copula to estimate the margins</li>
<li>Estimating the Copulas from the Pseudo-sample</li>
</ul>
<div id="forming-a-pseudo-sample-from-the-copula-for-estimation-of-the-margins" class="section level4" number="6.5.2.1">
<h4><span class="header-section-number">6.5.2.1</span> Forming a Pseudo-sample from the Copula for Estimation of the Margins</h4>
<p>First, we need to create pseudo observations. That is due to the Sklar’s theorem (the backbone of the copula model). From Sklar’s theorem, the copula is a <strong>function of uniform margins</strong>. Hence, you need to transform the <strong>margins of your dataset to the standard uniform margins</strong> in order to obtain copula data.</p>
<p>We let <span class="math inline">\(\hat F_1, \dots, \hat F_d\)</span> denote the estimates of the marginal distribution functions. Then the pseudo-sample from the copula consists of the vectors <span class="math inline">\(\hat U_1, \dots, \hat U_d\)</span>, where:</p>
<p><span class="math display">\[
\hat U_t = (\hat F_1 (X_{t,1}), \dots, \hat F_d(X_{t,d})&#39;
\]</span></p>
<p>As such, the pseudo observations are just the usual observations transformed such that they have uniform margins.</p>
<p>To calculate the pseudo observations, we first need to estimate the marginal distribution functions. We have two ways of estimating <span class="math inline">\(\hat F_t\)</span>:</p>
<p><strong>Parametric Estimation</strong></p>
<p>We choose an appropriate parametric model for the data in question and fit it by ML.</p>
<ul>
<li>for financial risk-factor return data: GH, NIG or t</li>
<li>for insurance or operational loss data: Pareto or lognormal</li>
</ul>
<p><strong>Non-Parametric Estimation</strong></p>
<p>We assume that we can estimate F using:</p>
<p><span class="math display">\[
F_{i,n}^*(x) = \frac{1}{1+n}\sum_{t=1}^n I_{X_{t,i} \leq x}
\]</span></p>
</div>
<div id="estimating-the-copulas-from-the-pseudo-sample" class="section level4" number="6.5.2.2">
<h4><span class="header-section-number">6.5.2.2</span> Estimating the Copulas from the Pseudo-sample</h4>
<p>Let <span class="math inline">\(C_\theta\)</span> be a parametric copula, where <span class="math inline">\(\theta\)</span> is the vector of parameters to be estimated. Then, the MLE is obtained by maximising:</p>
<p><span class="math display">\[
\ln L(\theta;\hat U_1, \dots, \hat U_n) = \sum_{t=1}^n \ln c_\theta(\hat U_t)
\]</span></p>
<p>whereas <span class="math inline">\(c(u)\)</span> denotes the copula density and <span class="math inline">\(\hat U_t\)</span> denotes a <strong>pseudo-observation from the copula</strong>.</p>
<p>Consequently, to implement the MLE technique we need to derive the density of the copula.</p>
<ul>
<li>For <strong>Archimedean copulas</strong>, we have numerical methods to find a closed form solution. These are given in Figure 2 above.</li>
<li>For <strong>implicit Copulas</strong> like Gauss or t, we use the MLE and find the log-likelihood function.</li>
</ul>
<p>Note that, in both cases, we need to solve w.r.t. the correlation matrix as it is responsible for the part which quantifies the joint risk behaviour.</p>
</div>
<div id="applying-mle-to-the-big-four-dataset-to-estimate-different-copulas" class="section level4" number="6.5.2.3">
<h4><span class="header-section-number">6.5.2.3</span> Applying MLE to the Big Four dataset to Estimate different Copulas</h4>
<p>Having discussed the theoretical approach to estimating different copulas, we now set this into motion by applying it with the respective functions on the Swiss Market data.</p>
<div class="sourceCode" id="cb9937"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9937-1"><a href="copulas.html#cb9937-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s load the data again and use it for our purposes</span></span>
<span id="cb9937-2"><a href="copulas.html#cb9937-2" aria-hidden="true" tabindex="-1"></a>all_stocks <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;~/Desktop/Master UZH/Data/A1_dataset_01.txt&quot;</span>, <span class="at">header =</span> T, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb9937-3"><a href="copulas.html#cb9937-3" aria-hidden="true" tabindex="-1"></a>bigfour <span class="ot">&lt;-</span> all_stocks <span class="sc">%&gt;%</span> </span>
<span id="cb9937-4"><a href="copulas.html#cb9937-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(Date, Nestle_PS, Novartis_N, Roche_Holding, UBS_N)) <span class="sc">%&gt;%</span> </span>
<span id="cb9937-5"><a href="copulas.html#cb9937-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="st">&quot;1996-12-31&quot;</span>)</span>
<span id="cb9937-6"><a href="copulas.html#cb9937-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9937-7"><a href="copulas.html#cb9937-7" aria-hidden="true" tabindex="-1"></a>bigfour_ts <span class="ot">&lt;-</span> <span class="fu">as.xts</span>(bigfour[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">order.by =</span> <span class="fu">ymd</span>(bigfour<span class="sc">$</span>Date))</span></code></pre></div>
<p>We can now create the Pseudo Observations (U) to estimate the margins and plot them. Note that this is estimates exactly the part of the joint risk which exists between the four companies.</p>
<div class="sourceCode" id="cb9938"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9938-1"><a href="copulas.html#cb9938-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create negative log returns </span></span>
<span id="cb9938-2"><a href="copulas.html#cb9938-2" aria-hidden="true" tabindex="-1"></a>bigfour_ts_ret_neg <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span><span class="fu">Return.calculate</span>(bigfour_ts, <span class="at">method =</span> <span class="st">&quot;log&quot;</span>)[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb9938-3"><a href="copulas.html#cb9938-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9938-4"><a href="copulas.html#cb9938-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Pseudo Observations parametrically</span></span>
<span id="cb9938-5"><a href="copulas.html#cb9938-5" aria-hidden="true" tabindex="-1"></a>U_hat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">pobs</span>(bigfour_ts_ret_neg))</span>
<span id="cb9938-6"><a href="copulas.html#cb9938-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9938-7"><a href="copulas.html#cb9938-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the bivariate copulas</span></span>
<span id="cb9938-8"><a href="copulas.html#cb9938-8" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs2</span>(U_hat, <span class="at">cex =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">&quot;black&quot;</span>, <span class="at">alpha.f =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-302-1.png" width="672" /></p>
<p>As we can see, there appears to be a slight stronger dependency between novartis and Roche as well as Nestle. This implies that the three stocks are likely to behave similarly in the tail distribution. As such, we are more likely to see that they have joint negative returns.</p>
<p>Now, we can fit the Copula on the Pseudo Observations of the negative log returns. Based on them, we can then fit individual copulas on the observations. We calculate these copulas either directly (because they have a closed form solution) or indirectly through MLE (for Gauss and t).</p>
<div class="sourceCode" id="cb9939"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9939-1"><a href="copulas.html#cb9939-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the appropriate dimensions</span></span>
<span id="cb9939-2"><a href="copulas.html#cb9939-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(U_hat) <span class="co"># sample size</span></span>
<span id="cb9939-3"><a href="copulas.html#cb9939-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">ncol</span>(U_hat) <span class="co"># dimension</span></span>
<span id="cb9939-4"><a href="copulas.html#cb9939-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9939-5"><a href="copulas.html#cb9939-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Compare various bivariate copulas</span></span>
<span id="cb9939-6"><a href="copulas.html#cb9939-6" aria-hidden="true" tabindex="-1"></a>fit.N <span class="ot">&lt;-</span> <span class="fu">fitCopula</span>(<span class="fu">normalCopula</span>(<span class="at">dim =</span> d),  <span class="at">data =</span> U_hat)</span>
<span id="cb9939-7"><a href="copulas.html#cb9939-7" aria-hidden="true" tabindex="-1"></a>fit.t <span class="ot">&lt;-</span> <span class="fu">fitCopula</span>(<span class="fu">tCopula</span>(<span class="at">dim =</span> d, <span class="at">dispstr=</span><span class="st">&quot;un&quot;</span>), <span class="at">data =</span> U_hat, <span class="at">method =</span> <span class="st">&quot;itau.mpl&quot;</span>) <span class="co"># df of freedom are estimated, too</span></span>
<span id="cb9939-8"><a href="copulas.html#cb9939-8" aria-hidden="true" tabindex="-1"></a>fit.C <span class="ot">&lt;-</span> <span class="fu">fitCopula</span>(<span class="fu">claytonCopula</span>(<span class="at">dim =</span> d), <span class="at">data =</span> U_hat)</span>
<span id="cb9939-9"><a href="copulas.html#cb9939-9" aria-hidden="true" tabindex="-1"></a>fit.G <span class="ot">&lt;-</span> <span class="fu">fitCopula</span>(<span class="fu">gumbelCopula</span>(<span class="at">dim =</span> d),  <span class="at">data =</span> U_hat, <span class="at">method =</span> <span class="st">&quot;mpl&quot;</span>)</span>
<span id="cb9939-10"><a href="copulas.html#cb9939-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9939-11"><a href="copulas.html#cb9939-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparing the likelihoods</span></span>
<span id="cb9939-12"><a href="copulas.html#cb9939-12" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">c</span>(<span class="at">N =</span> fit.N<span class="sc">@</span>loglik, <span class="at">t =</span> fit.t<span class="sc">@</span>loglik, <span class="at">C =</span> fit.C<span class="sc">@</span>loglik, <span class="at">G =</span> fit.G<span class="sc">@</span>loglik),</span>
<span id="cb9939-13"><a href="copulas.html#cb9939-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##         t         N         G         C 
## 118.08027  90.50829  85.42201  58.77965</code></pre>
<p>As we can see, the t Copula delivers the best log likelihood score. This means that the t-Copula is likely the best model to capture the joint risk behaviour of the four assets.</p>
<p>We can go further and calculate the correlation between the individual assets based on their respective copulas to understand that we can compute them identically compared to the MLE method.</p>
<div class="sourceCode" id="cb9941"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9941-1"><a href="copulas.html#cb9941-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the fitted copula parameters</span></span>
<span id="cb9941-2"><a href="copulas.html#cb9941-2" aria-hidden="true" tabindex="-1"></a>fit.NC <span class="ot">&lt;-</span> fit.N<span class="sc">@</span>copula</span>
<span id="cb9941-3"><a href="copulas.html#cb9941-3" aria-hidden="true" tabindex="-1"></a>fit.tC <span class="ot">&lt;-</span> fit.t<span class="sc">@</span>copula</span>
<span id="cb9941-4"><a href="copulas.html#cb9941-4" aria-hidden="true" tabindex="-1"></a>fit.CC <span class="ot">&lt;-</span> fit.C<span class="sc">@</span>copula</span>
<span id="cb9941-5"><a href="copulas.html#cb9941-5" aria-hidden="true" tabindex="-1"></a>fit.GC <span class="ot">&lt;-</span> fit.G<span class="sc">@</span>copula</span>
<span id="cb9941-6"><a href="copulas.html#cb9941-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9941-7"><a href="copulas.html#cb9941-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute matrices of pairwise Kendall&#39;s tau and upper tail-dependence coefficients</span></span>
<span id="cb9941-8"><a href="copulas.html#cb9941-8" aria-hidden="true" tabindex="-1"></a>kendall_tau_P2P_NC <span class="ot">&lt;-</span> <span class="fu">p2P</span>(<span class="fu">tau</span>(fit.NC))</span>
<span id="cb9941-9"><a href="copulas.html#cb9941-9" aria-hidden="true" tabindex="-1"></a>Upper_Tail_P2P_NC <span class="ot">&lt;-</span> <span class="fu">p2P</span>(<span class="fu">lambda</span>(fit.NC)[(<span class="fu">choose</span>(d,<span class="dv">2</span>)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(d<span class="sc">*</span>(d<span class="dv">-1</span>))])</span>
<span id="cb9941-10"><a href="copulas.html#cb9941-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9941-11"><a href="copulas.html#cb9941-11" aria-hidden="true" tabindex="-1"></a>kendall_tau_P2P_tC <span class="ot">&lt;-</span> <span class="fu">p2P</span>(<span class="fu">tau</span>(fit.tC))</span>
<span id="cb9941-12"><a href="copulas.html#cb9941-12" aria-hidden="true" tabindex="-1"></a>Upper_Tail_P2P_tC <span class="ot">&lt;-</span> <span class="fu">p2P</span>(<span class="fu">lambda</span>(fit.tC)[(<span class="fu">choose</span>(d,<span class="dv">2</span>)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(d<span class="sc">*</span>(d<span class="dv">-1</span>))])</span>
<span id="cb9941-13"><a href="copulas.html#cb9941-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9941-14"><a href="copulas.html#cb9941-14" aria-hidden="true" tabindex="-1"></a>kendall_tau_P2P_CC <span class="ot">&lt;-</span> <span class="fu">p2P</span>(<span class="fu">tau</span>(fit.CC))</span>
<span id="cb9941-15"><a href="copulas.html#cb9941-15" aria-hidden="true" tabindex="-1"></a>Upper_Tail_P2P_CC <span class="ot">&lt;-</span> <span class="fu">p2P</span>(<span class="fu">lambda</span>(fit.CC)[(<span class="fu">choose</span>(d,<span class="dv">2</span>)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(d<span class="sc">*</span>(d<span class="dv">-1</span>))])</span>
<span id="cb9941-16"><a href="copulas.html#cb9941-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9941-17"><a href="copulas.html#cb9941-17" aria-hidden="true" tabindex="-1"></a>kendall_tau_P2P_GC <span class="ot">&lt;-</span> <span class="fu">p2P</span>(<span class="fu">tau</span>(fit.GC))</span>
<span id="cb9941-18"><a href="copulas.html#cb9941-18" aria-hidden="true" tabindex="-1"></a>Upper_Tail_P2P_GC <span class="ot">&lt;-</span> <span class="fu">p2P</span>(<span class="fu">lambda</span>(fit.GC)[(<span class="fu">choose</span>(d,<span class="dv">2</span>)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(d<span class="sc">*</span>(d<span class="dv">-1</span>))])</span></code></pre></div>
<p>Following standard statistical practice we usually fit a number of copula models to data and compare the quality of the fitted models using tools like the Akaike information criterion. We may also carry out goodness-of-fit tests to assess the plausibility that the data come from any given copula.</p>
<div class="sourceCode" id="cb9942"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9942-1"><a href="copulas.html#cb9942-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the Goodness of Fit </span></span>
<span id="cb9942-2"><a href="copulas.html#cb9942-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># Should be larger, e.g. 100&#39;000 (but large runtime then)</span></span>
<span id="cb9942-3"><a href="copulas.html#cb9942-3" aria-hidden="true" tabindex="-1"></a>gof.NC <span class="ot">&lt;-</span> <span class="fu">gofCopula</span>(fit.NC, <span class="at">x =</span> U_hat, <span class="at">N =</span> N)</span></code></pre></div>
<pre><code>## Warning in .gofPB(copula, x, N = N, method = method, estim.method = estim.method, : argument &#39;ties&#39; set to TRUE</code></pre>
<pre><code>## ===================================================================================================================================================</code></pre>
<div class="sourceCode" id="cb9945"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9945-1"><a href="copulas.html#cb9945-1" aria-hidden="true" tabindex="-1"></a>gof.CC <span class="ot">&lt;-</span> <span class="fu">gofCopula</span>(fit.CC, <span class="at">x =</span> U_hat, <span class="at">N =</span> N)</span></code></pre></div>
<pre><code>## Warning in .gofPB(copula, x, N = N, method = method, estim.method = estim.method, : argument &#39;ties&#39; set to TRUE</code></pre>
<pre><code>## =================================</code></pre>
<pre><code>## Warning in fitCopula.ml(copula, u = data, method = method, start = start, : possible convergence problem: optim() gave code=52</code></pre>
<pre><code>## ======================</code></pre>
<pre><code>## Warning in fitCopula.ml(copula, u = data, method = method, start = start, : possible convergence problem: optim() gave code=52</code></pre>
<pre><code>## =====================</code></pre>
<pre><code>## Warning in fitCopula.ml(copula, u = data, method = method, start = start, : possible convergence problem: optim() gave code=52</code></pre>
<pre><code>## ======================================</code></pre>
<pre><code>## Warning in fitCopula.ml(copula, u = data, method = method, start = start, : possible convergence problem: optim() gave code=52</code></pre>
<pre><code>## =================================</code></pre>
<div class="sourceCode" id="cb9956"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9956-1"><a href="copulas.html#cb9956-1" aria-hidden="true" tabindex="-1"></a>gof.GC <span class="ot">&lt;-</span> <span class="fu">gofCopula</span>(fit.GC, <span class="at">x =</span> U_hat, <span class="at">N =</span> N)</span></code></pre></div>
<pre><code>## Warning in .gofPB(copula, x, N = N, method = method, estim.method = estim.method, : argument &#39;ties&#39; set to TRUE</code></pre>
<pre><code>## =============</code></pre>
<pre><code>## Warning in fitCopula.ml(copula, u = data, method = method, start = start, : possible convergence problem: optim() gave code=52</code></pre>
<pre><code>## ===============================================</code></pre>
<pre><code>## Warning in fitCopula.ml(copula, u = data, method = method, start = start, : possible convergence problem: optim() gave code=52</code></pre>
<pre><code>## =======================================================================================</code></pre>
<div class="sourceCode" id="cb9963"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9963-1"><a href="copulas.html#cb9963-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For the t copula, we cannot use this feature yet in multivariate settings. As such, we need to calculate the Goodness of Fit test through a visual setting. </span></span>
<span id="cb9963-2"><a href="copulas.html#cb9963-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9963-3"><a href="copulas.html#cb9963-3" aria-hidden="true" tabindex="-1"></a>U.Rsnbl <span class="ot">&lt;-</span> <span class="fu">cCopula</span>(U_hat, <span class="at">copula =</span> fit.tC)</span>
<span id="cb9963-4"><a href="copulas.html#cb9963-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs2</span>(U.Rsnbl, <span class="at">cex =</span> <span class="fl">0.4</span>, <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">&quot;black&quot;</span>, <span class="at">alpha.f =</span> <span class="fl">0.5</span>)) <span class="co"># looks ok</span></span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-305-1.png" width="672" /></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="fixed-income-securities.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/NikolasAnic/Quantitative-Finance-in-R/edit/master/06_copulas.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/NikolasAnic/Quantitative-Finance-in-R/blob/master/06_copulas.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
