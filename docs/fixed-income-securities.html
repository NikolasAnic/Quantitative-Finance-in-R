<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Fixed Income Securities | Quantitative Finance in R</title>
  <meta name="description" content="Chapter 5 Fixed Income Securities | Quantitative Finance in R" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Fixed Income Securities | Quantitative Finance in R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Fixed Income Securities | Quantitative Finance in R" />
  
  
  

<meta name="author" content="Nikolas Anic" />


<meta name="date" content="2022-02-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="inductive-statistics-and-regression-analysis-fundamentals.html"/>
<link rel="next" href="copulas.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<script src="libs/bootbox-4.4.0/bootbox.min.js"></script>
<script src="libs/idb-keyvalue-3.2.0/idb-keyval-iife-compat.min.js"></script>
<link href="libs/tutorial-0.10.1/tutorial.css" rel="stylesheet" />
<script src="libs/tutorial-0.10.1/tutorial.js"></script>
<script src="libs/tutorial-autocompletion-0.10.1/tutorial-autocompletion.js"></script>
<script src="libs/tutorial-diagnostics-0.10.1/tutorial-diagnostics.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">quant_finance_r</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#general-structure"><i class="fa fa-check"></i><b>1.1</b> General structure</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#notation"><i class="fa fa-check"></i><b>1.2</b> Notation</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="statistical-properties.html"><a href="statistical-properties.html"><i class="fa fa-check"></i><b>2</b> Statistical Properties</a>
<ul>
<li class="chapter" data-level="2.1" data-path="statistical-properties.html"><a href="statistical-properties.html#introduction-to-probability"><i class="fa fa-check"></i><b>2.1</b> Introduction to Probability</a></li>
<li class="chapter" data-level="2.2" data-path="statistical-properties.html"><a href="statistical-properties.html#the-concept-of-probability-important-notions-and-definitions"><i class="fa fa-check"></i><b>2.2</b> The concept of Probability: Important Notions and Definitions</a></li>
<li class="chapter" data-level="2.3" data-path="statistical-properties.html"><a href="statistical-properties.html#random-variables"><i class="fa fa-check"></i><b>2.3</b> Random Variables</a></li>
<li class="chapter" data-level="2.4" data-path="statistical-properties.html"><a href="statistical-properties.html#univariate-probability-distributions"><i class="fa fa-check"></i><b>2.4</b> Univariate Probability Distributions</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="statistical-properties.html"><a href="statistical-properties.html#discrete-random-variables-and-distributions"><i class="fa fa-check"></i><b>2.4.1</b> Discrete Random Variables and Distributions</a></li>
<li class="chapter" data-level="2.4.2" data-path="statistical-properties.html"><a href="statistical-properties.html#continuous-random-variables-and-distributions"><i class="fa fa-check"></i><b>2.4.2</b> Continuous Random Variables and Distributions</a></li>
<li class="chapter" data-level="2.4.3" data-path="statistical-properties.html"><a href="statistical-properties.html#moments-of-probability-distributions-location-scale-and-shape"><i class="fa fa-check"></i><b>2.4.3</b> Moments of Probability Distributions: Location, Scale and Shape</a></li>
<li class="chapter" data-level="2.4.4" data-path="statistical-properties.html"><a href="statistical-properties.html#quantile-based-location-scale-and-shape-parameters"><i class="fa fa-check"></i><b>2.4.4</b> Quantile-Based Location, Scale, and Shape Parameters</a></li>
<li class="chapter" data-level="2.4.5" data-path="statistical-properties.html"><a href="statistical-properties.html#the-cumulative-distribution"><i class="fa fa-check"></i><b>2.4.5</b> The cumulative Distribution</a></li>
<li class="chapter" data-level="2.4.6" data-path="statistical-properties.html"><a href="statistical-properties.html#continuous-distributions-with-appealing-properties"><i class="fa fa-check"></i><b>2.4.6</b> Continuous Distributions with Appealing Properties</a></li>
<li class="chapter" data-level="2.4.7" data-path="statistical-properties.html"><a href="statistical-properties.html#generalized-error-distribution"><i class="fa fa-check"></i><b>2.4.7</b> Generalized Error Distribution</a></li>
<li class="chapter" data-level="2.4.8" data-path="statistical-properties.html"><a href="statistical-properties.html#creating-skewed-distributions-based-on-symmetric-distributions"><i class="fa fa-check"></i><b>2.4.8</b> Creating Skewed Distributions based on Symmetric Distributions</a></li>
<li class="chapter" data-level="2.4.9" data-path="statistical-properties.html"><a href="statistical-properties.html#kernel-density-estimation"><i class="fa fa-check"></i><b>2.4.9</b> Kernel Density Estimation</a></li>
<li class="chapter" data-level="2.4.10" data-path="statistical-properties.html"><a href="statistical-properties.html#heavy-tail-distributions"><i class="fa fa-check"></i><b>2.4.10</b> Heavy Tail Distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="statistical-properties.html"><a href="statistical-properties.html#bivariate-distributions"><i class="fa fa-check"></i><b>2.5</b> Bivariate distributions</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="statistical-properties.html"><a href="statistical-properties.html#bivariate-distributions-for-continuous-random-variables"><i class="fa fa-check"></i><b>2.5.1</b> Bivariate Distributions for continuous random variables</a></li>
<li class="chapter" data-level="2.5.2" data-path="statistical-properties.html"><a href="statistical-properties.html#standard-bivariate-normal-distribution"><i class="fa fa-check"></i><b>2.5.2</b> Standard bivariate normal distribution</a></li>
<li class="chapter" data-level="2.5.3" data-path="statistical-properties.html"><a href="statistical-properties.html#marginal-distributions"><i class="fa fa-check"></i><b>2.5.3</b> Marginal Distributions</a></li>
<li class="chapter" data-level="2.5.4" data-path="statistical-properties.html"><a href="statistical-properties.html#conditional-distributions"><i class="fa fa-check"></i><b>2.5.4</b> Conditional Distributions</a></li>
<li class="chapter" data-level="2.5.5" data-path="statistical-properties.html"><a href="statistical-properties.html#independence"><i class="fa fa-check"></i><b>2.5.5</b> Independence</a></li>
<li class="chapter" data-level="2.5.6" data-path="statistical-properties.html"><a href="statistical-properties.html#correlation-and-covariance"><i class="fa fa-check"></i><b>2.5.6</b> Correlation and Covariance</a></li>
<li class="chapter" data-level="2.5.7" data-path="statistical-properties.html"><a href="statistical-properties.html#expectation-and-variance-of-the-sum-of-two-random-variables"><i class="fa fa-check"></i><b>2.5.7</b> Expectation and variance of the sum of two random variables</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="statistical-properties.html"><a href="statistical-properties.html#multivariate-probability-distributions"><i class="fa fa-check"></i><b>2.6</b> Multivariate Probability Distributions</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="statistical-properties.html"><a href="statistical-properties.html#covariance-and-correlation-matrices"><i class="fa fa-check"></i><b>2.6.1</b> Covariance and Correlation Matrices</a></li>
<li class="chapter" data-level="2.6.2" data-path="statistical-properties.html"><a href="statistical-properties.html#linear-functions-of-random-variables"><i class="fa fa-check"></i><b>2.6.2</b> Linear Functions of random variables</a></li>
<li class="chapter" data-level="2.6.3" data-path="statistical-properties.html"><a href="statistical-properties.html#central-properties-of-multivariate-distributions"><i class="fa fa-check"></i><b>2.6.3</b> Central properties of multivariate distributions</a></li>
<li class="chapter" data-level="2.6.4" data-path="statistical-properties.html"><a href="statistical-properties.html#the-scatterplot-matrix"><i class="fa fa-check"></i><b>2.6.4</b> The Scatterplot Matrix</a></li>
<li class="chapter" data-level="2.6.5" data-path="statistical-properties.html"><a href="statistical-properties.html#multivariate-normal-distribution"><i class="fa fa-check"></i><b>2.6.5</b> Multivariate Normal Distribution</a></li>
<li class="chapter" data-level="2.6.6" data-path="statistical-properties.html"><a href="statistical-properties.html#normal-mixture-models"><i class="fa fa-check"></i><b>2.6.6</b> Normal Mixture Models</a></li>
<li class="chapter" data-level="2.6.7" data-path="statistical-properties.html"><a href="statistical-properties.html#the-fisher-information-matrix"><i class="fa fa-check"></i><b>2.6.7</b> The Fisher Information Matrix</a></li>
<li class="chapter" data-level="2.6.8" data-path="statistical-properties.html"><a href="statistical-properties.html#dimensionality-reduction-techniques-principal-component-analysis-pca"><i class="fa fa-check"></i><b>2.6.8</b> Dimensionality Reduction Techniques: Principal Component Analysis (PCA)</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="statistical-properties.html"><a href="statistical-properties.html#matrix-algebra-introduction"><i class="fa fa-check"></i><b>2.7</b> Matrix Algebra: Introduction</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="statistical-properties.html"><a href="statistical-properties.html#matrices-and-vectors"><i class="fa fa-check"></i><b>2.7.1</b> Matrices and Vectors</a></li>
<li class="chapter" data-level="2.7.2" data-path="statistical-properties.html"><a href="statistical-properties.html#basic-matrix-operations"><i class="fa fa-check"></i><b>2.7.2</b> Basic Matrix Operations</a></li>
<li class="chapter" data-level="2.7.3" data-path="statistical-properties.html"><a href="statistical-properties.html#summation-notation-in-matrix-form"><i class="fa fa-check"></i><b>2.7.3</b> Summation Notation in Matrix Form</a></li>
<li class="chapter" data-level="2.7.4" data-path="statistical-properties.html"><a href="statistical-properties.html#systems-of-linear-equations"><i class="fa fa-check"></i><b>2.7.4</b> Systems of Linear Equations</a></li>
<li class="chapter" data-level="2.7.5" data-path="statistical-properties.html"><a href="statistical-properties.html#positive-definite-pd-matrix"><i class="fa fa-check"></i><b>2.7.5</b> Positive Definite (PD) Matrix</a></li>
<li class="chapter" data-level="2.7.6" data-path="statistical-properties.html"><a href="statistical-properties.html#portfolio-construction-and-mathematical-properties-using-matrix-algebra"><i class="fa fa-check"></i><b>2.7.6</b> Portfolio Construction and Mathematical Properties using Matrix Algebra</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="resampling-distributions.html"><a href="resampling-distributions.html"><i class="fa fa-check"></i><b>3</b> Resampling Distributions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="resampling-distributions.html"><a href="resampling-distributions.html#estimating-the-moments-with-bootstraping"><i class="fa fa-check"></i><b>3.1</b> Estimating the Moments with Bootstraping</a></li>
<li class="chapter" data-level="3.2" data-path="resampling-distributions.html"><a href="resampling-distributions.html#bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>3.2</b> Bootstrap Confidence Intervals</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="resampling-distributions.html"><a href="resampling-distributions.html#bootstrap-of-normal-ci"><i class="fa fa-check"></i><b>3.2.1</b> Bootstrap of Normal CI</a></li>
<li class="chapter" data-level="3.2.2" data-path="resampling-distributions.html"><a href="resampling-distributions.html#bootstrap-of-t-ci"><i class="fa fa-check"></i><b>3.2.2</b> Bootstrap of t-CI</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="resampling-distributions.html"><a href="resampling-distributions.html#summary-on-data"><i class="fa fa-check"></i><b>3.3</b> Summary on Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html"><i class="fa fa-check"></i><b>4</b> Inductive Statistics and Regression Analysis Fundamentals</a>
<ul>
<li class="chapter" data-level="4.1" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#inductive-statistics"><i class="fa fa-check"></i><b>4.1</b> Inductive Statistics</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#point-estimators"><i class="fa fa-check"></i><b>4.1.1</b> Point Estimators</a></li>
<li class="chapter" data-level="4.1.2" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#confidence-intervals"><i class="fa fa-check"></i><b>4.1.2</b> Confidence Intervals</a></li>
<li class="chapter" data-level="4.1.3" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#hypothesis-testing"><i class="fa fa-check"></i><b>4.1.3</b> Hypothesis Testing</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#introduction-to-regression-analysis"><i class="fa fa-check"></i><b>4.2</b> Introduction to Regression Analysis</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#the-role-of-correlation"><i class="fa fa-check"></i><b>4.2.1</b> The role of correlation</a></li>
<li class="chapter" data-level="4.2.2" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#the-simple-univariate-regression-model"><i class="fa fa-check"></i><b>4.2.2</b> The simple / univariate regression model</a></li>
<li class="chapter" data-level="4.2.3" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#the-multivariate-regression-model"><i class="fa fa-check"></i><b>4.2.3</b> The multivariate regression model</a></li>
<li class="chapter" data-level="4.2.4" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#goodness-of-fit"><i class="fa fa-check"></i><b>4.2.4</b> Goodness of Fit</a></li>
<li class="chapter" data-level="4.2.5" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#assumption-and-diagnostic-tests-of-ols"><i class="fa fa-check"></i><b>4.2.5</b> Assumption and diagnostic tests of OLS</a></li>
<li class="chapter" data-level="4.2.6" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#properties-of-the-ols-estimator"><i class="fa fa-check"></i><b>4.2.6</b> Properties of the OLS Estimator</a></li>
<li class="chapter" data-level="4.2.7" data-path="inductive-statistics-and-regression-analysis-fundamentals.html"><a href="inductive-statistics-and-regression-analysis-fundamentals.html#expected-value-and-variance-of-the-multivarite-ols-estimator-if-the-assumptions-hold"><i class="fa fa-check"></i><b>4.2.7</b> Expected Value and Variance of the multivarite OLS estimator if the assumptions hold:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html"><i class="fa fa-check"></i><b>5</b> Fixed Income Securities</a>
<ul>
<li class="chapter" data-level="5.1" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#economic-analysis"><i class="fa fa-check"></i><b>5.1</b> Economic Analysis</a></li>
<li class="chapter" data-level="5.2" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#swiss-fixed-income-securities"><i class="fa fa-check"></i><b>5.2</b> Swiss Fixed Income Securities</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#shape-of-the-swiss-yield-curve"><i class="fa fa-check"></i><b>5.2.1</b> Shape of the Swiss Yield curve</a></li>
<li class="chapter" data-level="5.2.2" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#the-case-for-mean-reversion"><i class="fa fa-check"></i><b>5.2.2</b> The case for mean reversion</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#principal-component-analysis"><i class="fa fa-check"></i><b>5.3</b> Principal Component Analysis</a></li>
<li class="chapter" data-level="5.4" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#bond-valuation-strategies"><i class="fa fa-check"></i><b>5.4</b> Bond Valuation Strategies</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#the-most-common-bonds"><i class="fa fa-check"></i><b>5.4.1</b> The most common bonds</a></li>
<li class="chapter" data-level="5.4.2" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#yield-to-maturity-ytm"><i class="fa fa-check"></i><b>5.4.2</b> Yield-to-Maturity (YTM)</a></li>
<li class="chapter" data-level="5.4.3" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#term-structure"><i class="fa fa-check"></i><b>5.4.3</b> Term Structure</a></li>
<li class="chapter" data-level="5.4.4" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#estimating-the-term-structure---parametric-and-non-parametric-models"><i class="fa fa-check"></i><b>5.4.4</b> Estimating the Term Structure - Parametric and Non-Parametric Models</a></li>
<li class="chapter" data-level="5.4.5" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#sensitivity-of-the-price-to-yield-duration-and-convexity"><i class="fa fa-check"></i><b>5.4.5</b> Sensitivity of the Price to Yield: Duration and Convexity</a></li>
<li class="chapter" data-level="5.4.6" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#price-and-yield-full-valuation-and-approximations"><i class="fa fa-check"></i><b>5.4.6</b> Price and Yield: Full Valuation and Approximations</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#interest-rate-derivative-models"><i class="fa fa-check"></i><b>5.5</b> Interest Rate Derivative Models</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#black-model"><i class="fa fa-check"></i><b>5.5.1</b> Black Model</a></li>
<li class="chapter" data-level="5.5.2" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#pricing-interest-rate-caps-with-black"><i class="fa fa-check"></i><b>5.5.2</b> Pricing Interest Rate Caps with Black</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#short-rate-models"><i class="fa fa-check"></i><b>5.6</b> Short Rate Models</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#vasicek"><i class="fa fa-check"></i><b>5.6.1</b> Vasicek</a></li>
<li class="chapter" data-level="5.6.2" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#cox-ingersoll-and-ross---cir-model"><i class="fa fa-check"></i><b>5.6.2</b> Cox, Ingersoll, and Ross - CIR Model</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#convertible-bonds"><i class="fa fa-check"></i><b>5.7</b> Convertible Bonds</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#main-idea-of-cbs"><i class="fa fa-check"></i><b>5.7.1</b> Main Idea of CBs</a></li>
<li class="chapter" data-level="5.7.2" data-path="fixed-income-securities.html"><a href="fixed-income-securities.html#individual-constituents-of-cbs"><i class="fa fa-check"></i><b>5.7.2</b> Individual constituents of CBs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="copulas.html"><a href="copulas.html"><i class="fa fa-check"></i><b>6</b> Copulas</a>
<ul>
<li class="chapter" data-level="6.1" data-path="copulas.html"><a href="copulas.html#what-on-earth-are-copulas"><i class="fa fa-check"></i><b>6.1</b> What on earth are Copulas?</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="copulas.html"><a href="copulas.html#copula-properties"><i class="fa fa-check"></i><b>6.1.1</b> Copula Properties</a></li>
<li class="chapter" data-level="6.1.2" data-path="copulas.html"><a href="copulas.html#motivation-for-copulas"><i class="fa fa-check"></i><b>6.1.2</b> Motivation for Copulas</a></li>
<li class="chapter" data-level="6.1.3" data-path="copulas.html"><a href="copulas.html#copula-examples"><i class="fa fa-check"></i><b>6.1.3</b> Copula Examples</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="copulas.html"><a href="copulas.html#dependence-concepts-and-measures"><i class="fa fa-check"></i><b>6.2</b> Dependence Concepts and Measures</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="copulas.html"><a href="copulas.html#perfect-dependence"><i class="fa fa-check"></i><b>6.2.1</b> Perfect Dependence</a></li>
<li class="chapter" data-level="6.2.2" data-path="copulas.html"><a href="copulas.html#dependence-measures"><i class="fa fa-check"></i><b>6.2.2</b> Dependence Measures</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="copulas.html"><a href="copulas.html#normal-mixture-copulas"><i class="fa fa-check"></i><b>6.3</b> Normal Mixture Copulas</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="copulas.html"><a href="copulas.html#tail-dependence-1"><i class="fa fa-check"></i><b>6.3.1</b> Tail Dependence</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="copulas.html"><a href="copulas.html#archimedean-copulas"><i class="fa fa-check"></i><b>6.4</b> Archimedean Copulas</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="copulas.html"><a href="copulas.html#frank-copula-and-general-clayton-copula"><i class="fa fa-check"></i><b>6.4.1</b> Frank Copula and General Clayton Copula</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="copulas.html"><a href="copulas.html#applying-copulas-with-actual-data"><i class="fa fa-check"></i><b>6.5</b> Applying Copulas with actual data</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="copulas.html"><a href="copulas.html#estimating-copulas-method-of-moments-using-rank-correlations"><i class="fa fa-check"></i><b>6.5.1</b> Estimating Copulas: Method-of-Moments using Rank Correlations</a></li>
<li class="chapter" data-level="6.5.2" data-path="copulas.html"><a href="copulas.html#estimating-copulas-maximum-likelihood-estimation-mle"><i class="fa fa-check"></i><b>6.5.2</b> Estimating Copulas: Maximum Likelihood Estimation (MLE)</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative Finance in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fixed-income-securities" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Fixed Income Securities</h1>
<p>In the third chapter, we will cover fixed income securities, the next major part of an average investment portfolio. Therein, we will deal with a multitude of considerations in the fixed income markets. First, we will analyse major macroeconomic variables in order to assess to what extent they are related to interest rates and bond yields. Based on this, we then demonstrate how to analyse Swiss treasury yields. Since some fixed income instruments rely on a premium over the rates of Treasury securities, being able to analyze the Treasury yield curve is essential to making sound fixed income investment decisions. Based on this, we also show how to look at the real yield of Treasury securities. Building up, we use a form of Principal Component Analysis (PCA) to induce that indeed most of the remaining variation of bond prices can be explained by interest rates. Then, we analyze the time series of spreads between corporates of different investment grade ratings. We show how such an analysis can reveal the widening or tightening of credit spreads. This can be viewed as a measure of investor’s appetite for credit risk. Lastly, we show how to implement bond valuation using discounted cash flow analysis in. We show how plain vanilla bonds are valued as well as how to find the yield of a bond if its price and cash flows are known. Further, we demonstrate how to calculate duration and convexity of bonds, which are tools used to manage interest rate risk and show when these techniques can provide reasonable estimates of the change in the bond’s price. This method is helpful when managing a portfolio of bonds, as we do not need to perform a full valuation of each bond in the portfolio. We end this chapter with a discussion of short rate models. In particular, we look at the models by Vasicek and Cox et al.</p>
<div id="economic-analysis" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Economic Analysis</h2>
<p>Before we start to actually explore the treasury yields, we first should have a look at certain macroeoconomic indicators. For that, we took data from the Worldbank on Switzerland which will serve as the macroeconomic dataset therein.</p>
<div class="sourceCode" id="cb9715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9715-1"><a href="fixed-income-securities.html#cb9715-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s load the dataset</span></span>
<span id="cb9715-2"><a href="fixed-income-securities.html#cb9715-2" aria-hidden="true" tabindex="-1"></a>macro_vars <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;~/Desktop/Master UZH/Data/CH_Data_Macroeconomic.csv&quot;</span>, <span class="at">header =</span> T)</span>
<span id="cb9715-3"><a href="fixed-income-securities.html#cb9715-3" aria-hidden="true" tabindex="-1"></a>macro_vars <span class="ot">&lt;-</span> macro_vars <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Year =</span> Indicator.Name, </span>
<span id="cb9715-4"><a href="fixed-income-securities.html#cb9715-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Indicator.Name =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p>This dataset contains 254 macroeconomic variables that could potentially all affect interest rate yields. Although these could potentially all be valid indicators, we do believe that the three most influential indicators will be:</p>
<ul>
<li>Real GDP</li>
<li>Unemployment Rate</li>
<li>Inflation Rate</li>
</ul>
<div class="sourceCode" id="cb9716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9716-1"><a href="fixed-income-securities.html#cb9716-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create only the three most common factors</span></span>
<span id="cb9716-2"><a href="fixed-income-securities.html#cb9716-2" aria-hidden="true" tabindex="-1"></a>macro_ind <span class="ot">&lt;-</span> macro_vars <span class="sc">%&gt;%</span> <span class="fu">select</span>(Unemployment..total....of.total.labor.force...national.estimate.,</span>
<span id="cb9716-3"><a href="fixed-income-securities.html#cb9716-3" aria-hidden="true" tabindex="-1"></a>                      GDP.per.capita.growth..annual..., </span>
<span id="cb9716-4"><a href="fixed-income-securities.html#cb9716-4" aria-hidden="true" tabindex="-1"></a>                      Inflation..consumer.prices..annual..., </span>
<span id="cb9716-5"><a href="fixed-income-securities.html#cb9716-5" aria-hidden="true" tabindex="-1"></a>                      Year)</span>
<span id="cb9716-6"><a href="fixed-income-securities.html#cb9716-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9716-7"><a href="fixed-income-securities.html#cb9716-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(macro_ind) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Unemployment_Rate&quot;</span>, <span class="st">&quot;GDP_Capita&quot;</span>, <span class="st">&quot;Inflation_Rate&quot;</span>, <span class="st">&quot;Year&quot;</span>)</span>
<span id="cb9716-8"><a href="fixed-income-securities.html#cb9716-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9716-9"><a href="fixed-income-securities.html#cb9716-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results in an xts format</span></span>
<span id="cb9716-10"><a href="fixed-income-securities.html#cb9716-10" aria-hidden="true" tabindex="-1"></a>macro_ind_ts <span class="ot">&lt;-</span> <span class="fu">xts</span>(macro_ind[,<span class="sc">-</span><span class="dv">4</span>], <span class="at">order.by =</span> <span class="fu">as.yearmon</span>(macro_ind[,<span class="dv">4</span>]))</span></code></pre></div>
<p>We first discuss real gross domestic product (GDP), which is an indicator of the strength of the economy. Most securities tend to move with the overall economy. When the economy does well, prices of securities tend to increase as well. Conversely, when the economy does poorly, prices of securities tend to decrease too. Hence, it may be helpful to know how well or poorly the economy is doing to determine the best investments that fit our strategy.</p>
<div class="sourceCode" id="cb9717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9717-1"><a href="fixed-income-securities.html#cb9717-1" aria-hidden="true" tabindex="-1"></a>macro_ind <span class="sc">%&gt;%</span> <span class="fu">select</span>(Year, GDP_Capita) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(Year, GDP_Capita)) <span class="sc">+</span> </span>
<span id="cb9717-2"><a href="fixed-income-securities.html#cb9717-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">color =</span> <span class="st">&quot;goldenrod&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9717-3"><a href="fixed-income-securities.html#cb9717-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;GDP Per Capita Growth Switzerland&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9717-4"><a href="fixed-income-securities.html#cb9717-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Growth (in %)&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Time&quot;</span>) <span class="sc">+</span></span>
<span id="cb9717-5"><a href="fixed-income-securities.html#cb9717-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;tomato3&quot;</span>, <span class="st">&quot;khaki3&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9717-6"><a href="fixed-income-securities.html#cb9717-6" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9717-7"><a href="fixed-income-securities.html#cb9717-7" aria-hidden="true" tabindex="-1"></a><span class="at">hjust=</span><span class="fl">0.5</span>,</span>
<span id="cb9717-8"><a href="fixed-income-securities.html#cb9717-8" aria-hidden="true" tabindex="-1"></a><span class="at">lineheight=</span><span class="fl">1.2</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9717-9"><a href="fixed-income-securities.html#cb9717-9" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9717-10"><a href="fixed-income-securities.html#cb9717-10" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9717-11"><a href="fixed-income-securities.html#cb9717-11" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9717-12"><a href="fixed-income-securities.html#cb9717-12" aria-hidden="true" tabindex="-1"></a><span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9717-13"><a href="fixed-income-securities.html#cb9717-13" aria-hidden="true" tabindex="-1"></a><span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9717-14"><a href="fixed-income-securities.html#cb9717-14" aria-hidden="true" tabindex="-1"></a><span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (position_stack).</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-213-1.png" width="672" /></p>
<p>As we can see, there was a largely positive growth in Switzerland of Real GDP Per Capita for the period under consideration, with a mean growth of 0.91%. Importantly, we can observe that there are only very negative periods in three distinct economic events: The banking crisis of the 90s, the financial crisis as well as the COVID pandemic.</p>
<p>Another example of key economic data available is the <strong>US Consumer Price Index (CPI)</strong> data, which is commonly used to calculate the inflation rate. The inflation rate is one of the most important factors investors consider in determining their expected rates of return. A higher inflation rate would lead to a higher required expected rate of return, as a CHF tomorrow is worth less than a CHF is worth today. The Bureau of Labor Statistics of the US Department of Labor reports the CPI data every month, we have it each year. The year-over-year changes in the CPI are typically used as a common measure of the inflation rate. The year-over-year change means that the inflation rate for a particular month is equal to the percentage change in the CPI for that same month last year.</p>
<div class="sourceCode" id="cb9719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9719-1"><a href="fixed-income-securities.html#cb9719-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb9719-2"><a href="fixed-income-securities.html#cb9719-2" aria-hidden="true" tabindex="-1"></a>macro_ind <span class="sc">%&gt;%</span> <span class="fu">select</span>(Year, Inflation_Rate) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(Year, Inflation_Rate)) <span class="sc">+</span> </span>
<span id="cb9719-3"><a href="fixed-income-securities.html#cb9719-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">color =</span> <span class="st">&quot;darkgreen&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9719-4"><a href="fixed-income-securities.html#cb9719-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Inflation Rate Switzerland&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9719-5"><a href="fixed-income-securities.html#cb9719-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Rate in %&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Time&quot;</span>) <span class="sc">+</span></span>
<span id="cb9719-6"><a href="fixed-income-securities.html#cb9719-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;tomato3&quot;</span>, <span class="st">&quot;khaki3&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9719-7"><a href="fixed-income-securities.html#cb9719-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(macro_ind<span class="sc">$</span>Inflation_Rate), <span class="at">color =</span> <span class="st">&quot;goldenrod&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9719-8"><a href="fixed-income-securities.html#cb9719-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">1981</span>, <span class="at">xmax =</span> <span class="dv">1983</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">ymax =</span> <span class="fl">6.5</span>,</span>
<span id="cb9719-9"><a href="fixed-income-securities.html#cb9719-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;violetred&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9719-10"><a href="fixed-income-securities.html#cb9719-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">1991</span>, <span class="at">xmax =</span> <span class="dv">1994</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">ymax =</span> <span class="fl">6.5</span>,</span>
<span id="cb9719-11"><a href="fixed-income-securities.html#cb9719-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;violetred&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9719-12"><a href="fixed-income-securities.html#cb9719-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">2007</span>, <span class="at">xmax =</span> <span class="dv">2009</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">ymax =</span> <span class="fl">6.5</span>,</span>
<span id="cb9719-13"><a href="fixed-income-securities.html#cb9719-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;violetred&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9719-14"><a href="fixed-income-securities.html#cb9719-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">2019</span>, <span class="at">xmax =</span> <span class="dv">2020</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">ymax =</span> <span class="fl">6.5</span>,</span>
<span id="cb9719-15"><a href="fixed-income-securities.html#cb9719-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> .<span class="dv">1</span>,<span class="at">fill =</span> <span class="st">&quot;violetred&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9719-16"><a href="fixed-income-securities.html#cb9719-16" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9719-17"><a href="fixed-income-securities.html#cb9719-17" aria-hidden="true" tabindex="-1"></a><span class="at">hjust=</span><span class="fl">0.5</span>,</span>
<span id="cb9719-18"><a href="fixed-income-securities.html#cb9719-18" aria-hidden="true" tabindex="-1"></a><span class="at">lineheight=</span><span class="fl">1.2</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9719-19"><a href="fixed-income-securities.html#cb9719-19" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9719-20"><a href="fixed-income-securities.html#cb9719-20" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9719-21"><a href="fixed-income-securities.html#cb9719-21" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9719-22"><a href="fixed-income-securities.html#cb9719-22" aria-hidden="true" tabindex="-1"></a><span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9719-23"><a href="fixed-income-securities.html#cb9719-23" aria-hidden="true" tabindex="-1"></a><span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9719-24"><a href="fixed-income-securities.html#cb9719-24" aria-hidden="true" tabindex="-1"></a><span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-214-1.png" width="672" /></p>
<p>As we can see, there appears a continous downward trend of the inflation rate with three major implications, that all appear to be part of the recession periods in the global economy, which is highlighted in violetred.</p>
<p>Lastly, we can look at the unemployment rate. If unemployment increases, consumer spending usually declines.</p>
<div class="sourceCode" id="cb9720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9720-1"><a href="fixed-income-securities.html#cb9720-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb9720-2"><a href="fixed-income-securities.html#cb9720-2" aria-hidden="true" tabindex="-1"></a>macro_ind <span class="sc">%&gt;%</span> <span class="fu">select</span>(Year, Unemployment_Rate) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(Year, Unemployment_Rate)) <span class="sc">+</span> </span>
<span id="cb9720-3"><a href="fixed-income-securities.html#cb9720-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">color =</span> <span class="st">&quot;khaki4&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9720-4"><a href="fixed-income-securities.html#cb9720-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Unemployment Rate Switzerland&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9720-5"><a href="fixed-income-securities.html#cb9720-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Rate in %&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Time&quot;</span>) <span class="sc">+</span></span>
<span id="cb9720-6"><a href="fixed-income-securities.html#cb9720-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;tomato3&quot;</span>, <span class="st">&quot;khaki3&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9720-7"><a href="fixed-income-securities.html#cb9720-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(macro_ind<span class="sc">$</span>Unemployment_Rate), <span class="at">color =</span> <span class="st">&quot;lightsteelblue&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9720-8"><a href="fixed-income-securities.html#cb9720-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9720-9"><a href="fixed-income-securities.html#cb9720-9" aria-hidden="true" tabindex="-1"></a><span class="at">hjust=</span><span class="fl">0.5</span>,</span>
<span id="cb9720-10"><a href="fixed-income-securities.html#cb9720-10" aria-hidden="true" tabindex="-1"></a><span class="at">lineheight=</span><span class="fl">1.2</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9720-11"><a href="fixed-income-securities.html#cb9720-11" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9720-12"><a href="fixed-income-securities.html#cb9720-12" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9720-13"><a href="fixed-income-securities.html#cb9720-13" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9720-14"><a href="fixed-income-securities.html#cb9720-14" aria-hidden="true" tabindex="-1"></a><span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9720-15"><a href="fixed-income-securities.html#cb9720-15" aria-hidden="true" tabindex="-1"></a><span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9720-16"><a href="fixed-income-securities.html#cb9720-16" aria-hidden="true" tabindex="-1"></a><span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-215-1.png" width="672" /></p>
<p>As we can see, also unemployment rates appear to follow a structure based on macroeconomic crises.</p>
<p>As we may understand, unemployment has been on the rise in Switzerland, which is mainly due to the different formulations and adjustments of unemployment beneficiaries during the 90s. Afterwards, we analyse an increasing, but rather weak, growth in unemployment rates. Furthermore, we understand that the spikes in the inflation rate are mainly mirroring the recession-based macroeconomic constitution of Switzerland. Lastly, we can observe that GDP growth per capita has been constantly positive, except for recession-related developments.</p>
</div>
<div id="swiss-fixed-income-securities" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Swiss Fixed Income Securities</h2>
<p>The Swiss Government Bond yields are the benchmark for the rates of other Swiss fixed income instruments. They also do depend, to some degree, on the US Treasury Yields, due to the interconnectedness of both macro-oriented economies. As such, knowledge of Government Yields is required to determine whether the yields of other fixed income securities are large enough for the incremental risk we are taking on. In addition, trading strategies can be constructed around the differential between short rates and long-term rates. If Short-Term Rates for 3-months substantially lower than 6-month rates, an investor who expects to hold a Short-Term bond for 3 months may instead purchase a 6-month bond and sell it in 3 months to take advantage of the higher yields on the longer dated instrument. This strategy is known as riding the yield curve.</p>
<div id="shape-of-the-swiss-yield-curve" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Shape of the Swiss Yield curve</h3>
<p>The Treasury yield curve is a curve comprised of rates on key maturities of Swiss Treasury securities. The yield curve can take on many shapes. It can be:</p>
<ul>
<li><strong>upward sloping</strong>, which means that <strong>short-term rates are lower than long-term rates</strong>.</li>
</ul>
<p>An upward sloping yield curve is also called normal, which implies this is the most typical shape of the yield curve we observe.</p>
<p>The yield curve can be:</p>
<ul>
<li><strong>inverted</strong>, which means that the short-term rates are <strong>higher</strong> than long-term rates.</li>
</ul>
<p>The yield curve can also be:</p>
<ul>
<li><strong>flat</strong>, which means that the short-term rates are <strong>almost the same</strong> as the long- term rates.</li>
</ul>
<p>We can now find dates on which the yield curves showed each of the particular smiles (or structures).</p>
<p>To do so, we will take the largest and smallest as well as minimal absolute value of the difference between a 1-Year and a 30-Year Treasury bond, since these should indicate the behaviour of the yield curve quite precisely.</p>
<p>The slope of the Swiss yield curve has been known as an indicator of future economic activity and rising inflation expectations. The slope is calculated as the difference between the yields of long-term and short-term Treasury securities. In prior recessions, short-term interest rates rose above long-term rates, which is the opposite of the more conventional pattern of long-term interest rates being higher than short-term interest rates.</p>
<div class="sourceCode" id="cb9721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9721-1"><a href="fixed-income-securities.html#cb9721-1" aria-hidden="true" tabindex="-1"></a>Swiss_Bonds <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;~/Desktop/Master UZH/Data/A2_dataset_02.txt&quot;</span>, <span class="at">header =</span> T, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb9721-2"><a href="fixed-income-securities.html#cb9721-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Swiss_Bonds) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Date&quot;</span>, <span class="st">&quot;Year_10&quot;</span>, <span class="st">&quot;Year_1&quot;</span>, <span class="st">&quot;Year_15&quot;</span>, <span class="st">&quot;Year_2&quot;</span>, <span class="st">&quot;Year_20&quot;</span>, </span>
<span id="cb9721-3"><a href="fixed-income-securities.html#cb9721-3" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;Year_3&quot;</span>, <span class="st">&quot;Year_30&quot;</span>, <span class="st">&quot;Year_4&quot;</span>, <span class="st">&quot;Year_5&quot;</span>, <span class="st">&quot;Year_6&quot;</span>, <span class="st">&quot;Year_7&quot;</span>, <span class="st">&quot;Year_8&quot;</span>, <span class="st">&quot;Year_9&quot;</span>)</span>
<span id="cb9721-4"><a href="fixed-income-securities.html#cb9721-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9721-5"><a href="fixed-income-securities.html#cb9721-5" aria-hidden="true" tabindex="-1"></a>Swiss_Bonds_ts <span class="ot">&lt;-</span> <span class="fu">xts</span>(Swiss_Bonds[,<span class="fu">c</span>(<span class="st">&quot;Year_1&quot;</span>, <span class="st">&quot;Year_10&quot;</span>)], <span class="at">order.by =</span> <span class="fu">as.Date</span>(Swiss_Bonds<span class="sc">$</span>Date))</span>
<span id="cb9721-6"><a href="fixed-income-securities.html#cb9721-6" aria-hidden="true" tabindex="-1"></a>Swiss_Bonds_ts<span class="sc">$</span>Diff <span class="ot">=</span> Swiss_Bonds_ts<span class="sc">$</span>Year_10 <span class="sc">-</span> Swiss_Bonds_ts<span class="sc">$</span>Year_1</span></code></pre></div>
<div class="sourceCode" id="cb9722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9722-1"><a href="fixed-income-securities.html#cb9722-1" aria-hidden="true" tabindex="-1"></a>Swiss_Bonds <span class="sc">%&gt;%</span> </span>
<span id="cb9722-2"><a href="fixed-income-securities.html#cb9722-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, Year_10, Year_1) <span class="sc">%&gt;%</span> </span>
<span id="cb9722-3"><a href="fixed-income-securities.html#cb9722-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Diff =</span> Year_10 <span class="sc">-</span> Year_1) <span class="sc">%&gt;%</span> </span>
<span id="cb9722-4"><a href="fixed-income-securities.html#cb9722-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(Treasury, Yield, Year_10<span class="sc">:</span>Year_1) <span class="sc">%&gt;%</span> </span>
<span id="cb9722-5"><a href="fixed-income-securities.html#cb9722-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(Date), <span class="at">y =</span> Yield, <span class="at">fill =</span> Treasury), ) <span class="sc">+</span> </span>
<span id="cb9722-6"><a href="fixed-income-securities.html#cb9722-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9722-7"><a href="fixed-income-securities.html#cb9722-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Diff, <span class="at">x =</span> <span class="fu">as.Date</span>(Date), <span class="at">color =</span> <span class="st">&quot;Year 10 - Year 1&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9722-8"><a href="fixed-income-securities.html#cb9722-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Swiss Government Bond Yield - absolute returns and differences&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9722-9"><a href="fixed-income-securities.html#cb9722-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Spread in BPS&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Time&quot;</span>) <span class="sc">+</span></span>
<span id="cb9722-10"><a href="fixed-income-securities.html#cb9722-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;goldenrod&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9722-11"><a href="fixed-income-securities.html#cb9722-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;violetred4&quot;</span>, <span class="st">&quot;khaki3&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9722-12"><a href="fixed-income-securities.html#cb9722-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb9722-13"><a href="fixed-income-securities.html#cb9722-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Features of the first axis</span></span>
<span id="cb9722-14"><a href="fixed-income-securities.html#cb9722-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Yield&quot;</span>,</span>
<span id="cb9722-15"><a href="fixed-income-securities.html#cb9722-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add a second axis and specify its features</span></span>
<span id="cb9722-16"><a href="fixed-income-securities.html#cb9722-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span><span class="dv">100</span>, <span class="at">name=</span><span class="st">&quot;Spread in BPS&quot;</span>)</span>
<span id="cb9722-17"><a href="fixed-income-securities.html#cb9722-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9722-18"><a href="fixed-income-securities.html#cb9722-18" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9722-19"><a href="fixed-income-securities.html#cb9722-19" aria-hidden="true" tabindex="-1"></a><span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.3</span>,</span>
<span id="cb9722-20"><a href="fixed-income-securities.html#cb9722-20" aria-hidden="true" tabindex="-1"></a><span class="at">lineheight=</span><span class="fl">1.2</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9722-21"><a href="fixed-income-securities.html#cb9722-21" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9722-22"><a href="fixed-income-securities.html#cb9722-22" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9722-23"><a href="fixed-income-securities.html#cb9722-23" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9722-24"><a href="fixed-income-securities.html#cb9722-24" aria-hidden="true" tabindex="-1"></a><span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9722-25"><a href="fixed-income-securities.html#cb9722-25" aria-hidden="true" tabindex="-1"></a><span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9722-26"><a href="fixed-income-securities.html#cb9722-26" aria-hidden="true" tabindex="-1"></a><span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span>  <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">&#39;Swiss Government Bonds&#39;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">color=</span><span class="st">&#39;Difference in Yield&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-217-1.png" width="672" /></p>
<p>The violet line indicates the difference in yield whereas the stacked bar chart indicates the total return of the government bonds in percent whereas the right y axis indicates the spread of the Yield curve in BPS. As we can observe, the Swiss market has been less severely hit by the financial crisis as other, more exposed, markets. This is resembled in the Yield curve. Although we can observe a certain negative direction, yields of longer-termed treasuries always exceed the ones of shorter termed. However, since 2010 we observe a continuously declining Spread, which results in a difference of practically zero for the last five years of the observational horizon.</p>
</div>
<div id="the-case-for-mean-reversion" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> The case for mean reversion</h3>
<p>When yields are predictable, there is opportunity for investors to make money. One indicator of return predictability is when yields are mean reverting. This means that if yields today are higher than some historical average, yields would have a tendency to decline towards the mean in the future. Conversely, if yields today are lower than some historical average, yields would have a tendency to rise towards the mean in the future. We implement an analysis to determine whether yields for the 10-Year Constant Maturity Treasury exhibit mean reversion. In this analysis, we will use a 20-day moving average of yields.</p>
<div class="sourceCode" id="cb9723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9723-1"><a href="fixed-income-securities.html#cb9723-1" aria-hidden="true" tabindex="-1"></a>Swiss_Bonds_ma <span class="ot">&lt;-</span> Swiss_Bonds <span class="sc">%&gt;%</span> </span>
<span id="cb9723-2"><a href="fixed-income-securities.html#cb9723-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, Year_10) <span class="sc">%&gt;%</span> </span>
<span id="cb9723-3"><a href="fixed-income-securities.html#cb9723-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rolling_mean_50_d =</span> <span class="fu">rollmean</span>(Year_10, <span class="at">k =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="cn">NA</span>), </span>
<span id="cb9723-4"><a href="fixed-income-securities.html#cb9723-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">rolling_mean_100_d =</span> <span class="fu">rollmean</span>(Year_10, <span class="at">k =</span> <span class="dv">100</span>, <span class="at">fill =</span> <span class="cn">NA</span>))</span>
<span id="cb9723-5"><a href="fixed-income-securities.html#cb9723-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9723-6"><a href="fixed-income-securities.html#cb9723-6" aria-hidden="true" tabindex="-1"></a>Swiss_Bonds_ma_ts <span class="ot">&lt;-</span> <span class="fu">xts</span>(Swiss_Bonds_ma[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">order.by =</span> <span class="fu">as.Date</span>(Swiss_Bonds_ma[,<span class="dv">1</span>]))</span>
<span id="cb9723-7"><a href="fixed-income-securities.html#cb9723-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9723-8"><a href="fixed-income-securities.html#cb9723-8" aria-hidden="true" tabindex="-1"></a>Swiss_Bonds_ma_ts <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9723-9"><a href="fixed-income-securities.html#cb9723-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> index, <span class="at">y =</span> value, <span class="at">color =</span> series)) <span class="sc">+</span> </span>
<span id="cb9723-10"><a href="fixed-income-securities.html#cb9723-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb9723-11"><a href="fixed-income-securities.html#cb9723-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Swiss Government Bond Yield 10 Year - Actual and Moving Average&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9723-12"><a href="fixed-income-securities.html#cb9723-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Value in %&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Time&quot;</span>) <span class="sc">+</span></span>
<span id="cb9723-13"><a href="fixed-income-securities.html#cb9723-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;goldenrod&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9723-14"><a href="fixed-income-securities.html#cb9723-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;violetred4&quot;</span>, <span class="st">&quot;khaki3&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9723-15"><a href="fixed-income-securities.html#cb9723-15" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9723-16"><a href="fixed-income-securities.html#cb9723-16" aria-hidden="true" tabindex="-1"></a><span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.3</span>,</span>
<span id="cb9723-17"><a href="fixed-income-securities.html#cb9723-17" aria-hidden="true" tabindex="-1"></a><span class="at">lineheight=</span><span class="fl">1.2</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9723-18"><a href="fixed-income-securities.html#cb9723-18" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9723-19"><a href="fixed-income-securities.html#cb9723-19" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9723-20"><a href="fixed-income-securities.html#cb9723-20" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9723-21"><a href="fixed-income-securities.html#cb9723-21" aria-hidden="true" tabindex="-1"></a><span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9723-22"><a href="fixed-income-securities.html#cb9723-22" aria-hidden="true" tabindex="-1"></a><span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9723-23"><a href="fixed-income-securities.html#cb9723-23" aria-hidden="true" tabindex="-1"></a><span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span>  <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">&#39;Swiss Government Bonds&#39;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">color=</span><span class="st">&#39;Difference in Yield&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 148 row(s) containing missing values (geom_path).</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-218-1.png" width="672" /></p>
<p>As we can see, the treasury yield exhibits mean reversion. We can see this because it follows up and down its moving average. Consequently, a trading strategy could be to go short in the Treasury if the 100 days MA is below its 50 day MA and buy otherwise. This is because we expect mean-reversion. As such, if the shorter period returns exceed the longer period returns, we expect them to move into the other direction.</p>
</div>
</div>
<div id="principal-component-analysis" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Principal Component Analysis</h2>
<p>One of the most fundamental results in fixed income analysis is that virtually all of the variation in interest rates is a result of the level of interest rates. The slope of the term structure and curvature of the yield curve explain the remaining variation. This result can be verified through the use of principal components analysis (PCA).</p>
<div class="sourceCode" id="cb9725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9725-1"><a href="fixed-income-securities.html#cb9725-1" aria-hidden="true" tabindex="-1"></a>Swiss_Bonds_full <span class="ot">&lt;-</span> Swiss_Bonds <span class="sc">%&gt;%</span> <span class="fu">subset</span>(Date <span class="sc">&gt;=</span> <span class="st">&quot;1997-12-31&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Date)</span>
<span id="cb9725-2"><a href="fixed-income-securities.html#cb9725-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb9725-3"><a href="fixed-income-securities.html#cb9725-3" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(Swiss_Bonds_full, <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9725-4"><a href="fixed-income-securities.html#cb9725-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca)</span></code></pre></div>
<pre><code>## Importance of components:
##                           PC1     PC2     PC3    PC4     PC5     PC6      PC7      PC8      PC9      PC10      PC11      PC12      PC13
## Standard deviation     3.5491 0.58540 0.21082 0.1195 0.04141 0.02224 0.007382 0.002334 0.000495 0.0001955 0.0001872 0.0001831 0.0001585
## Proportion of Variance 0.9689 0.02636 0.00342 0.0011 0.00013 0.00004 0.000000 0.000000 0.000000 0.0000000 0.0000000 0.0000000 0.0000000
## Cumulative Proportion  0.9689 0.99531 0.99873 0.9998 0.99996 1.00000 1.000000 1.000000 1.000000 1.0000000 1.0000000 1.0000000 1.0000000</code></pre>
<p>We output the eigenvectors as well. We interpret the signs as the opposite from what is reported in the output (i.e., negatives are positives and positives are negatives). Thus, we add a negative sign to the beginning of the code to make interpretation more consistent with the output.</p>
<div class="sourceCode" id="cb9727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9727-1"><a href="fixed-income-securities.html#cb9727-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span>pca<span class="sc">$</span>rotation</span></code></pre></div>
<pre><code>##               PC1         PC2         PC3          PC4         PC5         PC6         PC7         PC8          PC9          PC10         PC11
## Year_10 0.2801127 -0.16770071  0.15533180 -0.245480481 -0.16238677 -0.26565957  0.23822063 -0.20476159 -0.465397753 -4.462272e-01 -0.169525384
## Year_1  0.2637452  0.56664753 -0.44786724 -0.577264729  0.17744136  0.18121052  0.09169529 -0.04929359  0.018247856 -4.449694e-03 -0.002379213
## Year_15 0.2776030 -0.28728959 -0.08812388 -0.149245908 -0.43115745  0.10666933  0.47098967  0.54392512  0.291127513  9.306038e-02  0.016161827
## Year_2  0.2735860  0.39662099 -0.18987621  0.296856154 -0.40707805 -0.47942260 -0.37338081  0.28566636 -0.151563075  4.720455e-02  0.025633498
## Year_20 0.2752764 -0.34757347 -0.28966100  0.013543670 -0.34472500  0.53299822 -0.48397231 -0.26658342 -0.102697083 -2.174120e-02 -0.002940692
## Year_3  0.2779637  0.26378555  0.02494850  0.445715083 -0.15496516  0.05537054  0.32046445 -0.48285557  0.451186125 -2.102009e-01 -0.129473235
## Year_30 0.2715658 -0.39968519 -0.57741296  0.261729793  0.52008234 -0.29171184  0.09367674  0.01501176  0.003606059 -4.110169e-05 -0.000575919
## Year_4  0.2800823  0.16324589  0.16150069  0.324055786  0.12202157  0.30839719  0.27662290 -0.01688738 -0.396351670  4.086547e-01  0.352005187
## Year_5  0.2810174  0.08267378  0.23498345  0.149842141  0.24980298  0.26623607 -0.03379939  0.32532988 -0.260866606 -2.368637e-01 -0.505301740
## Year_6  0.2812977  0.01570441  0.26297847 -0.002614109  0.25038529  0.10189098 -0.24006845  0.26158691  0.176535890 -9.839002e-02  0.270196617
## Year_7  0.2812197 -0.04110021  0.25983735 -0.115088992  0.17412626 -0.06759702 -0.26361127  0.02446518  0.390598645 -2.980410e-01  0.233448216
## Year_8  0.2809450 -0.08977136  0.23611284 -0.188318362  0.06330848 -0.19096497 -0.14429452 -0.17628863  0.182997208  6.380130e-01 -0.514274936
## Year_9  0.2805599 -0.13162910  0.19953555 -0.229299069 -0.05375073 -0.25633053  0.04784467 -0.25983225 -0.137297149  1.290083e-01  0.427018047
##                  PC12          PC13
## Year_10  1.432545e-01  0.3852653180
## Year_1   3.121831e-03 -0.0008220080
## Year_15 -3.833379e-02 -0.0159392542
## Year_2  -3.188274e-02  0.0146856001
## Year_20  9.072181e-03 -0.0001289195
## Year_3   1.291737e-01 -0.0986884996
## Year_30 -5.477292e-05  0.0003382548
## Year_4  -1.816899e-01  0.3098295486
## Year_5  -1.640831e-01 -0.4357182294
## Year_6   7.260988e-01  0.1060855489
## Year_7  -6.090525e-01  0.2581623167
## Year_8   3.890995e-02  0.1512694167
## Year_9  -2.452299e-02 -0.6743378937</code></pre>
<p>Further, we get the dimensioanal scores of the products, which tell us the contribution of each dimension to the PCs</p>
<div class="sourceCode" id="cb9729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9729-1"><a href="fixed-income-securities.html#cb9729-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb9729-2"><a href="fixed-income-securities.html#cb9729-2" aria-hidden="true" tabindex="-1"></a>res.var <span class="ot">&lt;-</span> <span class="fu">get_pca_var</span>(pca)</span>
<span id="cb9729-3"><a href="fixed-income-securities.html#cb9729-3" aria-hidden="true" tabindex="-1"></a>res.var<span class="sc">$</span>coord          <span class="co"># Coordinates</span></span></code></pre></div>
<pre><code>##              Dim.1        Dim.2        Dim.3        Dim.4        Dim.5        Dim.6         Dim.7         Dim.8         Dim.9        Dim.10
## Year_10 -0.9941556  0.098171827 -0.032747612  0.029343081  0.006723830  0.005909039 -0.0017584722  4.780131e-04  2.303503e-04  8.723149e-05
## Year_1  -0.9360651 -0.331714890  0.094420990  0.069002333 -0.007347184 -0.004030647 -0.0006768667  1.150752e-04 -9.031844e-06  8.698561e-07
## Year_15 -0.9852484  0.168179035  0.018578595  0.017839849  0.017852619 -0.002372635 -0.0034767023 -1.269786e-03 -1.440946e-04 -1.819207e-05
## Year_2  -0.9709914 -0.232181526  0.040030389 -0.035484183  0.016855581  0.010663748  0.0027561835 -6.668841e-04  7.501670e-05 -9.227863e-06
## Year_20 -0.9769908  0.203469157  0.061067380 -0.001618919  0.014273774 -0.011855425  0.0035725362  6.223353e-04  5.083030e-05  4.250117e-06
## Year_3  -0.9865286 -0.154419796 -0.005259733 -0.053277775  0.006416528 -0.001231601 -0.0023655710  1.127220e-03 -2.233162e-04  4.109149e-05
## Year_30 -0.9638214  0.233975307  0.121732288 -0.031285415 -0.021534666  0.006488517 -0.0006914932 -3.504475e-05 -1.784832e-06  8.034835e-09
## Year_4  -0.9940478 -0.095563980 -0.034048160 -0.038735444 -0.005052457 -0.006859647 -0.0020419460  3.942335e-05  1.961757e-04 -7.988657e-05
## Year_5  -0.9973665 -0.048397146 -0.049540060 -0.017911119 -0.010343408 -0.005921862  0.0002494968 -7.594781e-04  1.291169e-04  4.630371e-05
## Year_6  -0.9983614 -0.009193348 -0.055442071  0.000312473 -0.010367519 -0.002266351  0.0017721122 -6.106710e-04 -8.737709e-05  1.923394e-05
## Year_7  -0.9980846  0.024060020 -0.054779850  0.013756962 -0.007209918  0.001503554  0.0019458982 -5.711362e-05 -1.933282e-04  5.826305e-05
## Year_8  -0.9971095  0.052552063 -0.049778162  0.022510307 -0.002621367  0.004247615  0.0010651382  4.115434e-04 -9.057514e-05 -1.247231e-04
## Year_9  -0.9957427  0.077055543 -0.042066807  0.027408864  0.002225617  0.005701534 -0.0003531748  6.065748e-04  6.795573e-05 -2.521941e-05
##                Dim.11        Dim.12        Dim.13
## Year_10  3.173069e-05 -2.623009e-05 -6.108368e-05
## Year_1   4.453260e-07 -5.716113e-07  1.303291e-07
## Year_15 -3.025069e-06  7.018966e-06  2.527163e-06
## Year_2  -4.797916e-06  5.837770e-06 -2.328397e-06
## Year_20  5.504203e-07 -1.661128e-06  2.044015e-08
## Year_3   2.423398e-05 -2.365187e-05  1.564703e-05
## Year_30  1.077969e-07  1.002899e-08 -5.363018e-08
## Year_4  -6.588611e-05  3.326766e-05 -4.912337e-05
## Year_5   9.457919e-05  3.004382e-05  6.908297e-05
## Year_6  -5.057370e-05 -1.329496e-04 -1.681983e-05
## Year_7  -4.369536e-05  1.115183e-04 -4.093154e-05
## Year_8   9.625874e-05 -7.124461e-06 -2.398371e-05
## Year_9  -7.992654e-05  4.490192e-06  1.069160e-04</code></pre>
<div class="sourceCode" id="cb9731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9731-1"><a href="fixed-income-securities.html#cb9731-1" aria-hidden="true" tabindex="-1"></a>res.var<span class="sc">$</span>contrib        <span class="co"># Contributions to the PCs</span></span></code></pre></div>
<pre><code>##            Dim.1       Dim.2       Dim.3        Dim.4      Dim.5      Dim.6      Dim.7       Dim.8        Dim.9       Dim.10       Dim.11
## Year_10 7.846313  2.81235286  2.41279690 6.026067e+00  2.6369464  7.0575009  5.6749069  4.19273084 21.659506807 1.991187e+01 2.873886e+00
## Year_1  6.956151 32.10894205 20.05850617 3.332346e+01  3.1485438  3.2837254  0.8408026  0.24298578  0.033298425 1.979977e-03 5.660653e-04
## Year_15 7.706343  8.25353083  0.77658179 2.227434e+00 18.5896747  1.1378346 22.1831267 29.58545393  8.475522855 8.660235e-01 2.612047e-02
## Year_2  7.484928 15.73082093  3.60529753 8.812358e+00 16.5712535 22.9846032 13.9413232  8.16052684  2.297136578 2.228270e-01 6.570762e-02
## Year_20 7.577707 12.08073154  8.39034965 1.834310e-02 11.8835328 28.4087102 23.4229195  7.10667206  1.054669094 4.726799e-02 8.647672e-04
## Year_3  7.726384  6.95828176  0.06224277 1.986619e+01  2.4014200  0.3065897 10.2697464 23.31495011 20.356891910 4.418443e+00 1.676332e+00
## Year_30 7.374796 15.97482524 33.34057247 6.850248e+00 27.0485641  8.5095798  0.8775332  0.02253530  0.001300366 1.689349e-07 3.316827e-05
## Year_4  7.844611  2.66492212  2.60824737 1.050122e+01  1.4889263  9.5108826  7.6520231  0.02851836 15.709464658 1.669987e+01 1.239077e+01
## Year_5  7.897078  0.68349537  5.52172205 2.245267e+00  6.2401530  7.0881646  0.1142399 10.58395333  6.805138616 5.610441e+00 2.553298e+01
## Year_6  7.912840  0.02466286  6.91576738 6.833566e-04  6.2692794  1.0381771  5.7632860  6.84277132  3.116492030 9.680596e-01 7.300621e+00
## Year_7  7.908454  0.16892271  6.75154501 1.324548e+00  3.0319955  0.4569358  6.9490904  0.05985450 15.256730142 8.882842e+00 5.449807e+00
## Year_8  7.893010  0.80588970  5.57492723 3.546381e+00  0.4007963  3.6467621  2.0820909  3.10776801  3.348797813 4.070606e+01 2.644787e+01
## Year_9  7.871385  1.73262202  3.98144368 5.257806e+00  0.2889141  6.5705340  0.2289112  6.75127962  1.885050705 1.664314e+00 1.823444e+01
##               Dim.12       Dim.13
## Year_10 2.052186e+00 1.484294e+01
## Year_1  9.745829e-04 6.756972e-05
## Year_15 1.469480e-01 2.540598e-02
## Year_2  1.016509e-01 2.156669e-02
## Year_20 8.230447e-03 1.662024e-06
## Year_3  1.668584e+00 9.739420e-01
## Year_30 3.000072e-07 1.144163e-05
## Year_4  3.301123e+00 9.599435e+00
## Year_5  2.692325e+00 1.898504e+01
## Year_6  5.272195e+01 1.125414e+00
## Year_7  3.709450e+01 6.664778e+00
## Year_8  1.513984e-01 2.288244e+00
## Year_9  6.013772e-02 4.547316e+01</code></pre>
<div class="sourceCode" id="cb9733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9733-1"><a href="fixed-income-securities.html#cb9733-1" aria-hidden="true" tabindex="-1"></a>res.var<span class="sc">$</span>cos2  </span></code></pre></div>
<pre><code>##             Dim.1        Dim.2        Dim.3        Dim.4        Dim.5        Dim.6        Dim.7        Dim.8        Dim.9       Dim.10
## Year_10 0.9883454 9.637708e-03 1.072406e-03 8.610164e-04 4.520988e-05 3.491674e-05 3.092224e-06 2.284965e-07 5.306127e-08 7.609333e-09
## Year_1  0.8762179 1.100348e-01 8.915323e-03 4.761322e-03 5.398111e-05 1.624612e-05 4.581485e-07 1.324230e-08 8.157420e-11 7.566496e-13
## Year_15 0.9707143 2.828419e-02 3.451642e-04 3.182602e-04 3.187160e-04 5.629397e-06 1.208746e-05 1.612356e-06 2.076326e-08 3.309514e-10
## Year_2  0.9428243 5.390826e-02 1.602432e-03 1.259127e-03 2.841106e-04 1.137155e-04 7.596547e-06 4.447345e-07 5.627506e-09 8.515345e-11
## Year_20 0.9545110 4.139970e-02 3.729225e-03 2.620899e-06 2.037406e-04 1.405511e-04 1.276301e-05 3.873012e-07 2.583719e-09 1.806349e-11
## Year_3  0.9732387 2.384547e-02 2.766479e-05 2.838521e-03 4.117183e-05 1.516842e-06 5.595926e-06 1.270624e-06 4.987014e-08 1.688510e-09
## Year_30 0.9289517 5.474444e-02 1.481875e-02 9.787772e-04 4.637419e-04 4.210085e-05 4.781628e-07 1.228135e-09 3.185625e-12 6.455857e-17
## Year_4  0.9881310 9.132474e-03 1.159277e-03 1.500435e-03 2.552732e-05 4.705476e-05 4.169544e-06 1.554201e-09 3.848491e-08 6.381864e-09
## Year_5  0.9947400 2.342284e-03 2.454218e-03 3.208082e-04 1.069861e-04 3.506845e-05 6.224865e-08 5.768070e-07 1.667117e-08 2.144033e-09
## Year_6  0.9967254 8.451766e-05 3.073823e-03 9.763936e-08 1.074855e-04 5.136345e-06 3.140382e-06 3.729191e-07 7.634756e-09 3.699445e-10
## Year_7  0.9961729 5.788846e-04 3.000832e-03 1.892540e-04 5.198292e-05 2.260674e-06 3.786520e-06 3.261966e-09 3.737581e-08 3.394583e-09
## Year_8  0.9942274 2.761719e-03 2.477865e-03 5.067139e-04 6.871567e-06 1.804223e-05 1.134519e-06 1.693679e-07 8.203856e-09 1.555585e-08
## Year_9  0.9915036 5.937557e-03 1.769616e-03 7.512459e-04 4.953371e-06 3.250749e-05 1.247324e-07 3.679330e-07 4.617981e-09 6.360187e-10
##               Dim.11       Dim.12       Dim.13
## Year_10 1.006837e-09 6.880175e-10 3.731216e-09
## Year_1  1.983153e-13 3.267394e-13 1.698567e-14
## Year_15 9.151041e-12 4.926589e-11 6.386554e-12
## Year_2  2.302000e-11 3.407956e-11 5.421431e-12
## Year_20 3.029625e-13 2.759346e-12 4.177996e-16
## Year_3  5.872859e-10 5.594107e-10 2.448294e-10
## Year_30 1.162017e-14 1.005807e-16 2.876196e-15
## Year_4  4.340979e-09 1.106737e-09 2.413105e-09
## Year_5  8.945223e-09 9.026310e-10 4.772457e-09
## Year_6  2.557699e-09 1.767560e-08 2.829066e-10
## Year_7  1.909285e-09 1.243633e-08 1.675391e-09
## Year_8  9.265745e-09 5.075795e-11 5.752185e-10
## Year_9  6.388252e-09 2.016182e-11 1.143104e-08</code></pre>
<ul>
<li>The first principal component has approximately equal weights at all maturities. Thus, it is often thought to capture the <strong>level of interest rates</strong>.</li>
<li>The second principal component has negative factors in the short maturities, becomes more neutral (i.e., closer to zero) for the intermediate maturities, and becomes positive for the long maturities. Thus, it is believed the second component captures the <strong>slope of the term structure</strong>.</li>
<li>Finally, the third principal component has positive weights in the short and long end of maturities but has negative weights in the intermediate maturity. Thus, the third component is said to capture the <strong>curvature of the yield curve</strong>.</li>
</ul>
</div>
<div id="bond-valuation-strategies" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Bond Valuation Strategies</h2>
<p>The objective of fixed income security management is to find securities which adhere to a given risk and return structure. Consequently, portfolio bond management works with the same principles as the security portfolio management we have seen in the previous chapter. Consequently, you allocate funds into different FI securities such that the expected return of the portfolio can be maximised for a given level of risk, or vice versa.</p>
<p>In order to assess the risk of bonds, we first need to derive common bond structures as well as their parameters. Then, we can derive a connection between the individual parameters and understand how rates, yields and prices of bonds are related. Understanding this relationship, we can then create certain risks each bond is underlying to. The risks include <strong>credit risk, liquidity risk, and market risk</strong> among others. The first two can be handled by selecting only securities with predetermined default risk, for example, with a minimum credit rating and with proper liquidity characteristics. The <strong>market risk</strong> of a fixed income security is captured by <strong>duration, modified duration, keynote duration, or factor duration</strong>.</p>
<p>Having understood how the risks can be minimised, we can then proceed to model term rate structures and define functions which capture the relative risk approppriately. We show how to compute prices of bonds based on YTM, spot rates and forward rates. Ultimately, we dig into FI derivatives, which are products whose value structure primarily depends on an underlying interest rate.</p>
<div id="the-most-common-bonds" class="section level3" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> The most common bonds</h3>
<p>When you buy a bond you are loaning a tradeable security in form of money to the corporation of interest. The corporation is obligated to pay back the principal and to pay interest as stipulated by the bond. The bond owner receives a fixed stream of income, unless the corporation defaults on the bond. For this reason, bonds are called “fixed income” securities.</p>
<p>Importantly, bond prices move in <strong>opposite direction to interest rates</strong>, so a decrease in interest rates will cause a bond “rally,” where bond prices increase. <strong>Long-term</strong> bonds are <strong>more sensitive to interest-rate changes</strong> than short-term bonds. The interest rate on your bond is fixed, but in the market interest rates fluctuate. Therefore, the market value of your bond fluctuates too.</p>
<p>Let’s first introduce the two basic forms of bonds, Zero-Coupon and Coupon Bonds.</p>
<div id="zero-coupon-bonds" class="section level4" number="5.4.1.1">
<h4><span class="header-section-number">5.4.1.1</span> Zero-Coupon Bonds</h4>
<p>Zero-Coupon Bonds (ZCB) are called as such because they <strong>do not pay any interest or principal until maturity</strong>. It has a par value or face value, which is the payment made to the bondholder at maturity. The bond sells for less than the par value, which is the reason it is a discount bond.</p>
<p>Since the ZCB does not pay any interest, the general formula is:</p>
<p><span class="math display">\[
P = \frac{N}{(1+y)^T}
\]</span></p>
<p>whereas V is the Present Value of the bond, (1+y) the interest rate (= yield) and T is the time to maturity. The yield to maturity of a <strong>zero-coupon bond of maturity years</strong> is called the <strong>spot rate</strong>. If you compound it more than once per year, the formula switches to:</p>
<p><span class="math display">\[
P = \frac{V}{(1+y/k)^{kT}}
\]</span></p>
<p>whereas k is the frequency of compounding, in annual terms. For instance, if you compound quarterly, then k = 4.</p>
<p>If we assume <strong>continuous compounding</strong>, then we obtain the following:</p>
<p><span class="math display">\[
P = Ve^{-y_TT}
\]</span></p>
</div>
<div id="coupon-bonds" class="section level4" number="5.4.1.2">
<h4><span class="header-section-number">5.4.1.2</span> Coupon Bonds</h4>
<p>Coupon bonds make regular interest payments. Coupon bonds generally sell at or near the par value when issued. At maturity, one receives a principal payment equal to the par value of the bond and the final interest payment.</p>
<p>The general formula for a coupon bond is:</p>
<p><span class="math display">\[
P = \sum_{t=0}^{kT} \frac{cN}{(1+y/k)^t} + \frac{N}{(1+y/k)^{kT}}
\]</span></p>
<p>whereas c is the coupon rate.</p>
<p>As we likely know, we can transform this formula based on the condition of finite geometric series. Therein, we understand that each coupon payment can be transposed to an annuity payment which pays <span class="math inline">\((c/k)P\)</span> for <span class="math inline">\(kT\)</span> periods, we can re-write the above expression to:</p>
<p><span class="math display">\[
P = (c/k) N \left( \frac{1}{y/k} - \frac{1}{(y/k)(1+y/k)^{kT}} \right) + \frac{N}{(1+y/k)^{lT}}
\]</span></p>
<p>A coupon bond is a <strong>bundle of zero-coupon bonds</strong>, one for each coupon payment and a final one for the principal payment. The components have <strong>different maturity dates</strong> and therefore <strong>different spot rates</strong>.</p>
</div>
</div>
<div id="yield-to-maturity-ytm" class="section level3" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Yield-to-Maturity (YTM)</h3>
<p>The yield to maturity, often shortened to simply yield, is the <strong>average rate of return, including the loss (or gain) of capital</strong> because the bond was <strong>purchased above (or below) par</strong>. This occurs because the actual yield trades always at market value and not at par value. Further, at maturity you only receive the par value and not the actual market value of the bond.</p>
<p>As such, we can use the same formula as above, but instead of the price, we now need to source for the r which holds the equality condition of the function above. If we do not trade at par, then the YTM will inevitably be different from both the current yield (which is the coupon / traded value) as well as the coupon rate (coupon / par value).</p>
<p>In order to conceptualise this, let’s consider an example:</p>
<ul>
<li>T = 10</li>
<li>C = 50</li>
<li>P = 1500</li>
<li>N = 1000</li>
<li>k = 4 (quarterly compounded)</li>
</ul>
<div class="sourceCode" id="cb9735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9735-1"><a href="fixed-income-securities.html#cb9735-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the input parameters</span></span>
<span id="cb9735-2"><a href="fixed-income-securities.html#cb9735-2" aria-hidden="true" tabindex="-1"></a>Ti <span class="ot">=</span> <span class="dv">11</span></span>
<span id="cb9735-3"><a href="fixed-income-securities.html#cb9735-3" aria-hidden="true" tabindex="-1"></a>C <span class="ot">=</span> <span class="fl">0.0575</span></span>
<span id="cb9735-4"><a href="fixed-income-securities.html#cb9735-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fl">0.01391</span></span>
<span id="cb9735-5"><a href="fixed-income-securities.html#cb9735-5" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">1000</span>  </span>
<span id="cb9735-6"><a href="fixed-income-securities.html#cb9735-6" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb9735-7"><a href="fixed-income-securities.html#cb9735-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9735-8"><a href="fixed-income-securities.html#cb9735-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the function</span></span>
<span id="cb9735-9"><a href="fixed-income-securities.html#cb9735-9" aria-hidden="true" tabindex="-1"></a>market_value <span class="ot">=</span> <span class="cf">function</span>(Ti, C, y, N, k){</span>
<span id="cb9735-10"><a href="fixed-income-securities.html#cb9735-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Computes Bond Value corresponding to the input parameters</span></span>
<span id="cb9735-11"><a href="fixed-income-securities.html#cb9735-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># INPUT:</span></span>
<span id="cb9735-12"><a href="fixed-income-securities.html#cb9735-12" aria-hidden="true" tabindex="-1"></a>    <span class="do">## C = Coupon payment</span></span>
<span id="cb9735-13"><a href="fixed-income-securities.html#cb9735-13" aria-hidden="true" tabindex="-1"></a>    <span class="do">## T = Time to Maturity (in years)</span></span>
<span id="cb9735-14"><a href="fixed-income-securities.html#cb9735-14" aria-hidden="true" tabindex="-1"></a>    <span class="do">## r = Vector of yields to maturity</span></span>
<span id="cb9735-15"><a href="fixed-income-securities.html#cb9735-15" aria-hidden="true" tabindex="-1"></a>    <span class="do">## N = Par Value</span></span>
<span id="cb9735-16"><a href="fixed-income-securities.html#cb9735-16" aria-hidden="true" tabindex="-1"></a>    <span class="do">## k = Compounding Frequency (in times per year)</span></span>
<span id="cb9735-17"><a href="fixed-income-securities.html#cb9735-17" aria-hidden="true" tabindex="-1"></a>  coupon_freq <span class="ot">=</span> C<span class="sc">/</span>k</span>
<span id="cb9735-18"><a href="fixed-income-securities.html#cb9735-18" aria-hidden="true" tabindex="-1"></a>  yield_freq <span class="ot">=</span> y<span class="sc">/</span>k</span>
<span id="cb9735-19"><a href="fixed-income-securities.html#cb9735-19" aria-hidden="true" tabindex="-1"></a>  periods <span class="ot">=</span> Ti<span class="sc">*</span>k</span>
<span id="cb9735-20"><a href="fixed-income-securities.html#cb9735-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9735-21"><a href="fixed-income-securities.html#cb9735-21" aria-hidden="true" tabindex="-1"></a>  bond_coupon <span class="ot">=</span> <span class="fu">rep</span>(coupon_freq, periods)</span>
<span id="cb9735-22"><a href="fixed-income-securities.html#cb9735-22" aria-hidden="true" tabindex="-1"></a>  bond_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(bond_coupon)</span>
<span id="cb9735-23"><a href="fixed-income-securities.html#cb9735-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9735-24"><a href="fixed-income-securities.html#cb9735-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>periods){</span>
<span id="cb9735-25"><a href="fixed-income-securities.html#cb9735-25" aria-hidden="true" tabindex="-1"></a>    bond_df<span class="sc">$</span>cf[i] <span class="ot">=</span> N <span class="sc">*</span> coupon_freq</span>
<span id="cb9735-26"><a href="fixed-income-securities.html#cb9735-26" aria-hidden="true" tabindex="-1"></a>    bond_df<span class="sc">$</span>ytm[i] <span class="ot">&lt;-</span> yield_freq</span>
<span id="cb9735-27"><a href="fixed-income-securities.html#cb9735-27" aria-hidden="true" tabindex="-1"></a>    bond_df<span class="sc">$</span>period[i] <span class="ot">&lt;-</span> i</span>
<span id="cb9735-28"><a href="fixed-income-securities.html#cb9735-28" aria-hidden="true" tabindex="-1"></a>    bond_df<span class="sc">$</span>FV[i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(bond_df<span class="sc">$</span>period[i] <span class="sc">==</span> k<span class="sc">*</span>Ti, N, <span class="dv">0</span>)</span>
<span id="cb9735-29"><a href="fixed-income-securities.html#cb9735-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9735-30"><a href="fixed-income-securities.html#cb9735-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9735-31"><a href="fixed-income-securities.html#cb9735-31" aria-hidden="true" tabindex="-1"></a>  bond_df<span class="sc">$</span>cf_pv <span class="ot">&lt;-</span> (bond_df<span class="sc">$</span>cf <span class="sc">+</span> bond_df<span class="sc">$</span>FV)<span class="sc">/</span>((<span class="dv">1</span><span class="sc">+</span>bond_df<span class="sc">$</span>ytm)<span class="sc">^</span>bond_df<span class="sc">$</span>period)</span>
<span id="cb9735-32"><a href="fixed-income-securities.html#cb9735-32" aria-hidden="true" tabindex="-1"></a>  sum_v <span class="ot">&lt;-</span>  <span class="fu">sum</span>(bond_df<span class="sc">$</span>cf_pv)</span>
<span id="cb9735-33"><a href="fixed-income-securities.html#cb9735-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sum_v)</span>
<span id="cb9735-34"><a href="fixed-income-securities.html#cb9735-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9735-35"><a href="fixed-income-securities.html#cb9735-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9735-36"><a href="fixed-income-securities.html#cb9735-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame</span></span>
<span id="cb9735-37"><a href="fixed-income-securities.html#cb9735-37" aria-hidden="true" tabindex="-1"></a>mv <span class="ot">=</span> <span class="fu">market_value</span>(Ti, C, r, N, k)</span>
<span id="cb9735-38"><a href="fixed-income-securities.html#cb9735-38" aria-hidden="true" tabindex="-1"></a>mv</span></code></pre></div>
<pre><code>## [1] 905.2055</code></pre>
<p>This function provides us with a value for the Price fo the Bond of 1443.184.-</p>
<p>In essence, we can state the following relationship:</p>
<p><span class="math display">\[
price &gt; par \rightarrow Coupon Rate &gt; Current Yield &gt; YTM
\]</span></p>
<p>whereas the opposite holds, as well. This is because if the price is higher than the par, then the buyers pay up a higher rent to make up for the difference.</p>
<p>As we stated, a coupon bond is a <strong>bundle of zero-coupon bonds</strong>, one for each coupon payment and a final one for the principal payment. The component zeros have different maturity dates and therefore different spot rates. However, since depicting the individual, time appropriate spot rates is difficult, we simplify the model by defining that the yield we use is simply an <strong>average of forward rates to price future, time-discrete cash flows during discrete future time periods</strong>.</p>
<p>Consequently, we can either take one big average (the yield) and discount each future cash flow by this average, or we take the individual forward rates, specific to each future cash flow, and discount the cash flows by this specific, or distinct, rate. This concept provides an introduction to the interconnections between yields, forward rates and discount factors. In essence, we will show that we include time-discrete forward rates into a model of bond prices by combining each time-discrete rate at each distinct maturity. Based on this, we can then construct a piece-wise rate model which calculates the forward rate for each discrete time to maturity. Then, we can combine these building blocks to create one continuous yield curve.</p>
<p>In order to do so, we will focus explicitly on the <em>term structure</em> of the interest rates.</p>
</div>
<div id="term-structure" class="section level3" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Term Structure</h3>
<p>In FI securities, the notion <strong>term</strong> defines the <strong>maturity of the debt</strong>, which is the date on which the principal amount of a debt instrument becomes due. Based on this, the notion <strong>term structure</strong> is the schedule of interest rates defined and posted at each maturity date. A term structure can be described by <strong>breaking down the time interval between the present time and the maturity time of a bond into short time segments</strong> with a <strong>constant interest rate within each segment</strong>, but with <strong>interest rates varying between segments</strong>. Thus, the <strong>term structure of interest rates is a description of how, at a given time, the yield depends on the maturity</strong>. Consequently, it is also referred to as <strong>yield curve</strong>. The yield curve is evidently dependent on the maturity of the bond. If the maturity increases, higher yields can convince lenders to wait longer for the return of the principal. On the other hand, longer maturity bonds are inherently more risky than shorter maturity securities. Thus, they require higher yields to compensate for the respective risk.</p>
<p>When considering term structures, our objective is to create a model of bond prices that reflects the baseline dynamic of the interest rate term structure. In order to do so, we need to catch up on the connection between yields and forward rates again and define forward rates of bond returns at various maturities. When averaging these rates across time, we can define a yield calculation (and thus obtain the yield we use normally in the formulas above). We then need to find a way to interpolate rates across maturities. To do so, we employ “regression splines” to interpolate and extrapolate values of forward rates from the term structure. Based on these “polations” we then are able to price bonds, collaterals as well as build discount rates to evaluate expected cash flows.</p>
<div id="the-interconnection-of-yields-prices-and-forward-rates" class="section level4" number="5.4.3.1">
<h4><span class="header-section-number">5.4.3.1</span> The interconnection of Yields, Prices and Forward Rates</h4>
<p>Remember that the <strong>price of the bond</strong> depends on the <strong>yield</strong>, which is given as a <strong>function of time to maturity</strong>:</p>
<div id="prices-and-yields" class="section level5" number="5.4.3.1.1">
<h5><span class="header-section-number">5.4.3.1.1</span> Prices and Yields</h5>
<p><span class="math display">\[
P_T = \frac{N_T}{(1+y^d(T))^{T}}
\]</span></p>
<p>We have seen that increasing the maturity or frequency of the bond (and payments) influences the yield if we assume that the price of the bond remains constant. Also, we understand that certain events between two maturities can alter the yield or other variables of the model. Thus, at each time period, we obtain a different discount rate, based on the actual time to maturity (remember we only take the average then of all these payments). Based on these piece-wise functions, we can then obtain the yield curve which quantifies the yield on each maturity.</p>
<p>The expression above translates to smaller piece-wise functions once we increase the frequency of payments, up to the extreme of obtaining <em>continuously compounded returns</em> defined as:</p>
<p><span class="math display">\[
P_T(\theta) = N_T e^{-y_T T}
\]</span></p>
<p>This expression is identical to the present value of receiving the entire cash flow of the face value at maturity. Consequently, this can also be considered a form of <strong>Zero-Coupon Bond</strong>. If the bond has coupons, we can consider each of the coupon payments as a <strong>mini-zero bond</strong>. Taking the <strong>sum of the present value</strong> of each of the mini ZCB gives us the value of the bond, now quantified as a portfolio of mini-zeros. We deliberately switched to the idea of ZCB as parts of continuously compounded yields to obtain maturity-based piece-wise forward rates due to the definition of the respective yields, as we can see below.<br />
The yield <span class="math inline">\((y_T)\)</span> is the rate from date 0 to date T, or the maturity. As we defined, it quantifies the stream of rates based on each time-discrete, intermediate maturity from 0 to T. Now, suppose we define forward rates as <span class="math inline">\(r(t, \theta)\)</span>, whereas each t is one of the time-discrete, intermediate maturity dates between time 0 and the ultimate maturity T. The forward rate is thus the <strong>interest contracted now to be paid for a future investment between the time s and t</strong>. Further, <span class="math inline">\(\theta\)</span> contains the entire set of the information we require about the shape of r across all sub-maturities. In this case, we can estimate the forward curve from bond prices <span class="math inline">\(P(t)\)</span> based on the T’th maturity with:</p>
<p><span class="math display">\[
r(t, \theta) = - \frac{\Delta log(P(T_{i}))}{\Delta T_{i}} = - \frac{log(P(T_{i})) - log(P(T_{i-1}))}{T_i - T_{i-1}}
\]</span></p>
<p>whereas the <span class="math inline">\(\Delta\)</span> equals the <strong>difference in one maturity-based price vs. the previous maturity-based price</strong> (i - (i-1)). Also, P is considered as price <em>relative to its par value</em>. Therein, the difference of the previous and this price can take any functional form (in the simplest case, this would just be a linear model (e.g. 0.01 + 0.5t). In this case, the difference between maturity 1 and 2 would be (0.01+0.5*2) - (0.01 + 0.5) = <span class="math inline">\(\delta f/\delta t\)</span> = 0.5.</p>
</div>
<div id="yields-and-forward-rates" class="section level5" number="5.4.3.1.2">
<h5><span class="header-section-number">5.4.3.1.2</span> Yields and Forward Rates</h5>
<p>Based on this, the <strong>yield</strong> is the <strong>time average</strong> of each sub-maturity forward rate from 0 to T of a <strong>zero bond</strong>, since we defined a continuously compounding yield as a piece-wise combination of mini ZCB. To account for the continuity, we use an integral (defined as cumulative sum) to compute the average:</p>
<p><span class="math display">\[
y_T(\theta) = \frac{1}{T} \int_0^T r(t, \theta) dt
\]</span></p>
<p>therein, the numerator is the cumulative sum of the forward rates at each sub-maturity (whereas rdt is a fractionally small change in maturity), and the denominator is the number of maturity years.</p>
</div>
<div id="prices-and-forward-rates" class="section level5" number="5.4.3.1.3">
<h5><span class="header-section-number">5.4.3.1.3</span> Prices and Forward Rates</h5>
<p>Based on this, let’s define again the price of a ZCB. When using continuous compounding we get that it is:</p>
<p><span class="math display">\[
P_T(\theta) = N_T e^{-y_T T} = N_T e^{\int_0^T r(t, \theta) dt}
\]</span></p>
<p>note that we simply replaced the <span class="math inline">\(y_T\)</span> part.</p>
</div>
<div id="redefining-the-price-and-yield-condition-of-a-zcb" class="section level5" number="5.4.3.1.4">
<h5><span class="header-section-number">5.4.3.1.4</span> Redefining the Price and Yield condition of a ZCB</h5>
<p>If we now consider both the discrete and continuous compounding of ZCB, we can set them equal and obtain the relation between the discrete and continuous yield.</p>
<p><span class="math display">\[
\begin{align}
\frac{N_T}{(1+y^d(T))^{T}} &amp;= N_T e^{-y_T T} \\
e^{y_T T} &amp;= (1+y^d(T))^{T} \\
y_T &amp;= \log(1+y^d(T))
\end{align}
\]</span></p>
<p>Let’s quickly consider a concrete example to facilitate the theory discussed.</p>
<div class="sourceCode" id="cb9737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9737-1"><a href="fixed-income-securities.html#cb9737-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define both maturities and prices of the bonds</span></span>
<span id="cb9737-2"><a href="fixed-income-securities.html#cb9737-2" aria-hidden="true" tabindex="-1"></a>maturity <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>)  <span class="co"># in years</span></span>
<span id="cb9737-3"><a href="fixed-income-securities.html#cb9737-3" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">101</span>, <span class="dv">97</span>, <span class="dv">95</span>, <span class="dv">91</span>, <span class="dv">92</span>, <span class="dv">93</span>, <span class="dv">99</span>)  <span class="co"># in percentage of face value</span></span>
<span id="cb9737-4"><a href="fixed-income-securities.html#cb9737-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9737-5"><a href="fixed-income-securities.html#cb9737-5" aria-hidden="true" tabindex="-1"></a>maturity <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>)  <span class="co"># in years</span></span>
<span id="cb9737-6"><a href="fixed-income-securities.html#cb9737-6" aria-hidden="true" tabindex="-1"></a>price <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">99</span>, <span class="dv">98</span>, <span class="dv">96</span>, <span class="dv">93</span>, <span class="dv">89</span>)</span>
<span id="cb9737-7"><a href="fixed-income-securities.html#cb9737-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9737-8"><a href="fixed-income-securities.html#cb9737-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the fwd rates </span></span>
<span id="cb9737-9"><a href="fixed-income-securities.html#cb9737-9" aria-hidden="true" tabindex="-1"></a>fwd_init<span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(price[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">100</span>)</span>
<span id="cb9737-10"><a href="fixed-income-securities.html#cb9737-10" aria-hidden="true" tabindex="-1"></a>fwd <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">diff</span>(<span class="fu">log</span>(price<span class="sc">/</span><span class="dv">100</span>))<span class="sc">/</span><span class="fu">diff</span>(maturity)</span>
<span id="cb9737-11"><a href="fixed-income-securities.html#cb9737-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9737-12"><a href="fixed-income-securities.html#cb9737-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the yield</span></span>
<span id="cb9737-13"><a href="fixed-income-securities.html#cb9737-13" aria-hidden="true" tabindex="-1"></a>yield <span class="ot">&lt;-</span> <span class="fu">c</span>(fwd_init, fwd_init <span class="sc">+</span> <span class="fu">cumsum</span>(fwd<span class="sc">*</span><span class="fu">diff</span>(maturity)))</span>
<span id="cb9737-14"><a href="fixed-income-securities.html#cb9737-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9737-15"><a href="fixed-income-securities.html#cb9737-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, we create the prices by: </span></span>
<span id="cb9737-16"><a href="fixed-income-securities.html#cb9737-16" aria-hidden="true" tabindex="-1"></a>prices <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>yield)</span>
<span id="cb9737-17"><a href="fixed-income-securities.html#cb9737-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9737-18"><a href="fixed-income-securities.html#cb9737-18" aria-hidden="true" tabindex="-1"></a>prices</span></code></pre></div>
<pre><code>## [1] 99 98 96 93 89</code></pre>
<p>As we can see, the calculations all add up to obtain the exact same prices again. Especially, we figured that</p>
<ul>
<li>the yields are solely the accumulation of forward rates based on each additional sub-maturity.</li>
<li>the initial forward rate is simply the par weighted logarithm of the first period.</li>
<li>we then calculate the yields as cumulative sums by multiplying each forward rate with the maturity interval.</li>
<li>Finally, we recover each bond price by inverting the process of creating forwards from prices.</li>
</ul>
<p>As such, we were able to show how Yields, Prices and Forward Rates are interlinked with each other.</p>
</div>
</div>
<div id="structure-of-the-forward-rate" class="section level4" number="5.4.3.2">
<h4><span class="header-section-number">5.4.3.2</span> Structure of the forward rate</h4>
<p>We now considered how the forward rate depends both on the yield as well as the prices. However, when considering the forward rate, we implicitly assumed a parametric structure by observing both the prices and the maturities of the bond. Based on this, we were able to depict a parametric model which was then defined as differenced logarithmic term, without needing to write a function which generalizes the structural parameters well. However, in reality, we usually need to estimate the forward rate curve. This is where the parameter <span class="math inline">\(\theta\)</span> comes into play.</p>
<p>In essence, the forward rate is composed of a polynomial term model which identifies long-term trends and short-term volatility structures. As such, we assume the following form:</p>
<p><span class="math display">\[
r(t, \theta) = \theta_0 + \theta_1 t + \theta_2 t^2 + ... + \theta_p t^p
\]</span></p>
<p>whereas t is the maturity (or sub-maturity).</p>
<p>We use calculus to integrate this formula to obtain the yields. This is a simple arithmetic operation yielding:</p>
<p><span class="math display">\[
\int_0^T r(t, \theta) dt = \theta_0 T + \theta_1 \frac{T^2}{2} + \theta_2 \frac{T^3}{3} + ... + \theta_p \frac{T^{p+1}}{p+1}
\]</span></p>
<p>We then can estimate the yield curve (and then the zero-coupon bond price) using the <strong>integrated forward rates divided by the maturity T</strong> to get the yield as:</p>
<p><span class="math display">\[
y_T(\theta) = \theta_0 + \theta_1 \frac{T}{2} + \theta_2 \frac{T^2}{3} + ... + \theta_p \frac{T^{p}}{p+1}
\]</span></p>
</div>
</div>
<div id="estimating-the-term-structure---parametric-and-non-parametric-models" class="section level3" number="5.4.4">
<h3><span class="header-section-number">5.4.4</span> Estimating the Term Structure - Parametric and Non-Parametric Models</h3>
<p>As we have now seen, the primary target of term structure estimation approaches is to quantify the spot rate (yield curve), forward rate or discount curve from a set of coupon bonds with different maturities. As direct methods to do so, such as bootstrapping, would severely overfit the given data, leading to imprecise generalisations and unsmooth curves. Consequently, indirect functions have been proposed, in both parametric as well as non-parametric form. These are usually used to estimate the curves of interest. To do so, we define bond prices as idiosyncratic error and structural terms:</p>
<p><span class="math display">\[
\hat{p} = \iota^T(C\cdot D)
\]</span></p>
<p>Which is the matrix consisting of appropriately discounted cash flows stemming from coupon and prinicpal payments. Thus, the market prices of set of coupon bonds p can be expressed as the sum of the theoretical bond prices <span class="math inline">\(\hat{p}\)</span> plus an idiosyncratic error vector:</p>
<p><span class="math display">\[
p = \hat{p} + \epsilon
\]</span></p>
<p>whereas this is a non-linear, non-convex function. The estimated parameter vector <span class="math inline">\(\hat{\beta}\)</span> is then obtained by a possible weighted nonconvex optimization procedure. We will now introduce different parametric and non-parametric options to estimate the term structure of interest rates.</p>
<div id="parametric-approach-nelsonsiegel-and-svensson-methods" class="section level4" number="5.4.4.1">
<h4><span class="header-section-number">5.4.4.1</span> Parametric approach: Nelson/Siegel and Svensson Methods</h4>
<p>Nelson and Siegel (1987) propose a parsimonious function for modelling the forward rate as a solution to a second-order differential equation for the case of equal roots:</p>
<p><span class="math display">\[
r(t, \theta) = \theta_0 + \theta_1 \exp(-\frac{t}{\tau_1}) + \theta_2\left[\frac{t}{\tau_1}\exp(-\frac{t}{\tau_1})\right]
\]</span></p>
<p>Based on this, we obtain the yield curve again as the average of the forward rates:</p>
<p><span class="math display">\[
y_T(\theta) = \frac{1}{T}\int_0^Tr(t, \theta)dt = \theta_0 + \theta_1 \frac{1-\exp(-\frac{t}{\tau_1})}{\frac{t}{\tau_1}} + \theta_2\left[\frac{1-\exp(-\frac{t}{\tau_1})}{\frac{t}{\tau_1}}-\exp(-\frac{t}{\tau_1})\right]
\]</span></p>
<p>As such, we define a parametric form for both the forward rates as well as the relation to the yield curves.</p>
<p>Based on this, we can theoretically create many possible shapes, including monotonic, humped, U-shapes or S-shapes. Consequently, Svensson (1994) adds the term:</p>
<p><span class="math display">\[
\beta_3\left[\frac{1-\exp(-\frac{t}{\tau_2})}{\frac{t}{\tau_2}}-\exp(-\frac{t}{\tau_2})\right]
\]</span></p>
<p>to increase the flexibility.</p>
<p>Lastly, in order to account for potential multicollinearity issues once we introduce both <span class="math inline">\(\tau_1\)</span> and <span class="math inline">\(\tau_2\)</span>, de Pooter (2007) proposes to adjust the last term in the second order equation by doubling the numerator. This is also known as <strong>Adjusted Svenson</strong> approach.</p>
</div>
<div id="non-parametric-approach-piecewise-regression-settings-and-splines" class="section level4" number="5.4.4.2">
<h4><span class="header-section-number">5.4.4.2</span> Non-Parametric approach: Piecewise Regression Settings and Splines</h4>
<p>We now have encountered that the form of the forward rates and the consecutive yield curve is usually not pre-determinated. As such, we need to estimate the forward rate curve. However, given the <span class="math inline">\(\theta\)</span> of our model, we may not directly understand which form the function will have. This is where non-parametric modeling comes into play. Remember, the common models consisting of the predictor variables discussed are useful if we have a <strong>parametric form</strong>. However, once we encounter a relationship whose underlying functional form cannot be pre-determined, we encounter a model which is given as:</p>
<p><span class="math display">\[
m_t + s_t = f(x) + \epsilon_t
\]</span></p>
<p>whereas f(x) is unknown in advance and cannot explicitly be deduced by primary data analysis. Regression settings which adhere to such forms are called specifications of non-linear regressions. There are generally two ways to circumvent this issue.</p>
<div id="piecewise-regressions" class="section level5" number="5.4.4.2.1">
<h5><span class="header-section-number">5.4.4.2.1</span> Piecewise Regressions</h5>
<p>Secondly, we can split up the time-series into pieces which follow a parametric form. In essence, we introduce cut-off points in which the slope of f can change. Doing so, we transform a non-linear model into multiple linear sub-models. In the case of one cut-off point, we define models in which we state that <span class="math inline">\(x_{1,t} = x\)</span> and</p>
<p><span class="math display">\[
x_{2,t} = (x-c)_+ =
\begin{cases}
0 &amp;&amp; \text{if } x &lt; c \\
x-c &amp;&amp; \text{if } x \geq c
\end{cases}
\]</span></p>
<p>This forces the slope to bend at point C. We can certainly also expand this to include multiple cut-off points in the data.</p>
</div>
<div id="splines" class="section level5" number="5.4.4.2.2">
<h5><span class="header-section-number">5.4.4.2.2</span> Splines</h5>
<p>One way to circumvent this issue is by using <strong>Splines</strong>. They are handy for using flexible shaped relationships in the data. The main argument in favour of splines is that they can <strong>estimate any smooth non-linear shaped relationship without previously specifying the shape of the model in advance</strong>. The shape of the trend is estimated automatically from the data.</p>
<p>In essence, splines are <strong>piece-wise polynomial functions</strong>, since the spline form combines different polynomials at different intervals. Splines provide a way to smoothly interpolate between fixed points, called knots. Polynomial regression is computed between knots. In other words, splines are series of polynomial segments strung together, joining at knots. Now, remember that we defined the forward rates as combination of piece-wise functions based on their sub-maturities. In that case, we can presume that the polynomials are <strong>pieces of the term structure of interest rates</strong>, whereas each discrete sub-part depends on both the maturity and its price (as we have seen in the previous example). Whole sections can be marked off by a knot (q) at a location in the term structure paired data. A <strong>distinct polynomial function is estimated for each range</strong> and domain of data between each knot. This is considered as the <strong>spline</strong>, because it adds polynomials at each piece of the function distinctively.</p>
<p>The model specification of any spline is:</p>
<p><span class="math display">\[
f(x) = \beta_0 + \sum_{i=1}^q \beta_iB_i(t)
\]</span></p>
<p>Here, the <span class="math inline">\(B_i(t)\)</span> are called <em>B-spline basis functions</em>, which, in general, are linear combinations of a specific known variable of the model. In the case of trend or seasonality modeling (or, in general, time-series modelling), they are naturally <strong>functions of time</strong>. In order to use B-Splines, you need only to define the number <strong>q</strong>, which is the number of basis functions to use w.r.t. the known variable of interest (or, equivalently, the number of knots, or discrete sections, of the curve). <strong>The higher q, the more flexible, or less smooth</strong>, the trend becomes.</p>
<p>You can easily see that a spline can be extended to potentially limitless polynomial degrees. However, usually, people use the third order polynomial to draw splines (= cubic forms). This is also known as <strong>Natural Cubic Splines</strong>.</p>
<p>Using splines bears two important considerations. The first is related to the <strong>number and locations of the knots</strong>. In general, there are two approaches. First, since the regression spline has the most variation at intervals that contain a substantial amount of knots, an idea is to:</p>
<ul>
<li>place many knots at intervals we deem as variable, and fewer at intervals which we deem stable</li>
</ul>
<p>The most common way, however, is to <strong>specify the desired degrees of freedom</strong>, and then have the <strong>software automatically place the corresponding number of knots at uniform</strong> quantiles of the data.</p>
<p>Secondly, we should ask how many <strong>degrees of freedom</strong> we should choose. This is mostly done through <strong>cross-validation</strong> in which we obtain different distributions of a test and training dataset and compute overall error scores for different model configurations (e.g. different DOF). Based on the comparison, we then choose the model configuration with the lowest error.</p>
</div>
</div>
<div id="applying-the-term-structure-estimation-in-r-the-termstrc-package" class="section level4" number="5.4.4.3">
<h4><span class="header-section-number">5.4.4.3</span> Applying the term structure estimation in R: The Termstrc package</h4>
<p>In order to show you how one could approach a term structure valuation approach, we will follow the method used by Hayden and Ferstl (2007) who provide a handy package called <code>termstrc</code> which is accessible with the code below. In essence, this package includes the most common term structure estimation strategies, such as the parametric Nelson and Siegel approach and the Svensson approach, as well as the non-parametric design approach, where individually estimated zero-coupon yield curves are substracted from a risk-free reference curve.</p>
<p>First, install the package using the following commands below:</p>
<div class="sourceCode" id="cb9739"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9739-1"><a href="fixed-income-securities.html#cb9739-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For mac users (at least I don&#39;t know if Windows users experience the same pain), there is an important workaround for installing the package. CRAN removed it so you need to install it remotely from an URL source. However, doing so requires you to also use the rgl package, which is not working if OpenGL is depreciated (which it certainly is for any MacBook purchased / with updated software after 2019). So, in order to find a non-depreciated form of OpenGL, you:</span></span>
<span id="cb9739-2"><a href="fixed-income-securities.html#cb9739-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9739-3"><a href="fixed-income-securities.html#cb9739-3" aria-hidden="true" tabindex="-1"></a><span class="co"># first download the XQuartz application online (https://www.xquartz.org/). It will automatically re-start your computer, so don&#39;t worry about this. </span></span>
<span id="cb9739-4"><a href="fixed-income-securities.html#cb9739-4" aria-hidden="true" tabindex="-1"></a><span class="co"># then create a new R session.</span></span>
<span id="cb9739-5"><a href="fixed-income-securities.html#cb9739-5" aria-hidden="true" tabindex="-1"></a><span class="co"># then fully re-install all your packages (which we did above by changing the second command in the apply function from &quot;require&quot; to &quot;install packages&quot;)</span></span>
<span id="cb9739-6"><a href="fixed-income-securities.html#cb9739-6" aria-hidden="true" tabindex="-1"></a><span class="co"># then use the require command again to set the library status for all the packages</span></span>
<span id="cb9739-7"><a href="fixed-income-securities.html#cb9739-7" aria-hidden="true" tabindex="-1"></a><span class="co"># then run the commands below:</span></span>
<span id="cb9739-8"><a href="fixed-income-securities.html#cb9739-8" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;rgl&quot;</span>)</span></code></pre></div>
<pre><code>## Error in install.packages : Updating loaded packages</code></pre>
<div class="sourceCode" id="cb9741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9741-1"><a href="fixed-income-securities.html#cb9741-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgl)</span>
<span id="cb9741-2"><a href="fixed-income-securities.html#cb9741-2" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_url</span>(<span class="st">&quot;https://cran.rstudio.com/src/contrib/Archive/termstrc/termstrc_1.3.7.tar.gz&quot;</span>)</span></code></pre></div>
<pre><code>## Downloading package from url: https://cran.rstudio.com/src/contrib/Archive/termstrc/termstrc_1.3.7.tar.gz</code></pre>
<pre><code>## These packages have more recent versions available.
## It is recommended to update all of them.
## Which would you like to update?
## 
## 1: All                             
## 2: CRAN packages only              
## 3: None                            
## 4: glue     (1.6.1 -&gt; 1.6.2) [CRAN]
## 5: yaml     (2.2.2 -&gt; 2.3.5) [CRAN]
## 6: evaluate (0.14  -&gt; 0.15 ) [CRAN]
## 7: rlang    (1.0.0 -&gt; 1.0.1) [CRAN]
## 8: jsonlite (1.7.3 -&gt; 1.8.0) [CRAN]
## 
##   
   checking for file ‘/private/var/folders/97/v7mhh7_10r54n7qdx4ykd6wc0000gn/T/RtmpSFmz9w/remotes590a1e7639a2/termstrc/DESCRIPTION’ ...
  
✓  checking for file ‘/private/var/folders/97/v7mhh7_10r54n7qdx4ykd6wc0000gn/T/RtmpSFmz9w/remotes590a1e7639a2/termstrc/DESCRIPTION’ (350ms)
## 
  
─  preparing ‘termstrc’:
## 
  
   checking DESCRIPTION meta-information ...
  
✓  checking DESCRIPTION meta-information
## 
  
─  cleaning src
## 
  
─  checking for LF line-endings in source and make files and shell scripts
## 
  
─  checking for empty or unneeded directories
## 
  
─  looking to see if a ‘data/datalist’ file should be added
## 
  
─  building ‘termstrc_1.3.7.tar.gz’
## 
  
   
## </code></pre>
<div class="sourceCode" id="cb9744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9744-1"><a href="fixed-income-securities.html#cb9744-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(termstrc)</span>
<span id="cb9744-2"><a href="fixed-income-securities.html#cb9744-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9744-3"><a href="fixed-income-securities.html#cb9744-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Based on this, you should be able to download the termstrc package </span></span></code></pre></div>
<p>The authors work with three distinct datasets on bond returns to evaluate their functions. In order to use the package, you need to set up an identical structure to the datasets provided. The authors therein offer a code snippet to show you how to manipulate your data such that you retain the identical structure. This is done here. We will show you how to create the datasets (we will use the datasets here that the authors provide) by taking each step.</p>
<div class="sourceCode" id="cb9745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9745-1"><a href="fixed-income-securities.html#cb9745-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is the data the authors provide</span></span>
<span id="cb9745-2"><a href="fixed-income-securities.html#cb9745-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(govbonds)</span>
<span id="cb9745-3"><a href="fixed-income-securities.html#cb9745-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9745-4"><a href="fixed-income-securities.html#cb9745-4" aria-hidden="true" tabindex="-1"></a><span class="co"># In this dataset, we have information on threee countries (D,A,F) and their respective government bonds. Especially, we have data on: </span></span>
<span id="cb9745-5"><a href="fixed-income-securities.html#cb9745-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9745-6"><a href="fixed-income-securities.html#cb9745-6" aria-hidden="true" tabindex="-1"></a><span class="do">## ISIN</span></span>
<span id="cb9745-7"><a href="fixed-income-securities.html#cb9745-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Maturity Date</span></span>
<span id="cb9745-8"><a href="fixed-income-securities.html#cb9745-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Issue Date</span></span>
<span id="cb9745-9"><a href="fixed-income-securities.html#cb9745-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Coupon Rate </span></span>
<span id="cb9745-10"><a href="fixed-income-securities.html#cb9745-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Price </span></span>
<span id="cb9745-11"><a href="fixed-income-securities.html#cb9745-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Accrued Price</span></span>
<span id="cb9745-12"><a href="fixed-income-securities.html#cb9745-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9745-13"><a href="fixed-income-securities.html#cb9745-13" aria-hidden="true" tabindex="-1"></a><span class="do">## CF ISIN</span></span>
<span id="cb9745-14"><a href="fixed-income-securities.html#cb9745-14" aria-hidden="true" tabindex="-1"></a><span class="do">## CF value</span></span>
<span id="cb9745-15"><a href="fixed-income-securities.html#cb9745-15" aria-hidden="true" tabindex="-1"></a><span class="do">## CF Date </span></span>
<span id="cb9745-16"><a href="fixed-income-securities.html#cb9745-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9745-17"><a href="fixed-income-securities.html#cb9745-17" aria-hidden="true" tabindex="-1"></a><span class="co"># In order to create the correct dataframe, thus, we need these 9 variables. Once we have them, we can create vectors accordingly: </span></span>
<span id="cb9745-18"><a href="fixed-income-securities.html#cb9745-18" aria-hidden="true" tabindex="-1"></a><span class="do">## First, we need to create usual vectors which combine the data for the respective variable</span></span>
<span id="cb9745-19"><a href="fixed-income-securities.html#cb9745-19" aria-hidden="true" tabindex="-1"></a>ISIN_countries <span class="ot">&lt;-</span> <span class="fu">c</span>(govbonds[[<span class="st">&quot;GERMANY&quot;</span>]]<span class="sc">$</span>ISIN[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;GERMANY&quot;</span>]]<span class="sc">$</span>ISIN)], govbonds[[<span class="st">&quot;AUSTRIA&quot;</span>]]<span class="sc">$</span>ISIN[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;AUSTRIA&quot;</span>]]<span class="sc">$</span>ISIN)], govbonds[[<span class="st">&quot;FRANCE&quot;</span>]]<span class="sc">$</span>ISIN[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;FRANCE&quot;</span>]]<span class="sc">$</span>ISIN)])</span>
<span id="cb9745-20"><a href="fixed-income-securities.html#cb9745-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9745-21"><a href="fixed-income-securities.html#cb9745-21" aria-hidden="true" tabindex="-1"></a>MATURITYDATE_countries <span class="ot">&lt;-</span> <span class="fu">c</span>(govbonds[[<span class="st">&quot;GERMANY&quot;</span>]]<span class="sc">$</span>MATURITYDATE[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;GERMANY&quot;</span>]]<span class="sc">$</span>MATURITYDATE)], govbonds[[<span class="st">&quot;AUSTRIA&quot;</span>]]<span class="sc">$</span>MATURITYDATE[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;AUSTRIA&quot;</span>]]<span class="sc">$</span>MATURITYDATE)], govbonds[[<span class="st">&quot;FRANCE&quot;</span>]]<span class="sc">$</span>MATURITYDATE[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;FRANCE&quot;</span>]]<span class="sc">$</span>MATURITYDATE)])</span>
<span id="cb9745-22"><a href="fixed-income-securities.html#cb9745-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9745-23"><a href="fixed-income-securities.html#cb9745-23" aria-hidden="true" tabindex="-1"></a>ISSUEDATE_countries <span class="ot">&lt;-</span> <span class="fu">c</span>(govbonds[[<span class="st">&quot;GERMANY&quot;</span>]]<span class="sc">$</span>ISSUEDATE[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;GERMANY&quot;</span>]]<span class="sc">$</span>ISSUEDATE)], govbonds[[<span class="st">&quot;AUSTRIA&quot;</span>]]<span class="sc">$</span>ISSUEDATE[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;AUSTRIA&quot;</span>]]<span class="sc">$</span>ISSUEDATE)], govbonds[[<span class="st">&quot;FRANCE&quot;</span>]]<span class="sc">$</span>ISSUEDATE[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;FRANCE&quot;</span>]]<span class="sc">$</span>ISSUEDATE)])</span>
<span id="cb9745-24"><a href="fixed-income-securities.html#cb9745-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9745-25"><a href="fixed-income-securities.html#cb9745-25" aria-hidden="true" tabindex="-1"></a>COUPONRATE_countries <span class="ot">&lt;-</span> <span class="fu">c</span>(govbonds[[<span class="st">&quot;GERMANY&quot;</span>]]<span class="sc">$</span>COUPONRATE[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;GERMANY&quot;</span>]]<span class="sc">$</span>COUPONRATE)], govbonds[[<span class="st">&quot;AUSTRIA&quot;</span>]]<span class="sc">$</span>COUPONRATE[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;AUSTRIA&quot;</span>]]<span class="sc">$</span>COUPONRATE)], govbonds[[<span class="st">&quot;FRANCE&quot;</span>]]<span class="sc">$</span>COUPONRATE[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;FRANCE&quot;</span>]]<span class="sc">$</span>COUPONRATE)])</span>
<span id="cb9745-26"><a href="fixed-income-securities.html#cb9745-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9745-27"><a href="fixed-income-securities.html#cb9745-27" aria-hidden="true" tabindex="-1"></a>PRICE_countries <span class="ot">&lt;-</span> <span class="fu">c</span>(govbonds[[<span class="st">&quot;GERMANY&quot;</span>]]<span class="sc">$</span>PRICE[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;GERMANY&quot;</span>]]<span class="sc">$</span>PRICE)], govbonds[[<span class="st">&quot;AUSTRIA&quot;</span>]]<span class="sc">$</span>PRICE[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;AUSTRIA&quot;</span>]]<span class="sc">$</span>PRICE)], govbonds[[<span class="st">&quot;FRANCE&quot;</span>]]<span class="sc">$</span>PRICE[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;FRANCE&quot;</span>]]<span class="sc">$</span>PRICE)])</span>
<span id="cb9745-28"><a href="fixed-income-securities.html#cb9745-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9745-29"><a href="fixed-income-securities.html#cb9745-29" aria-hidden="true" tabindex="-1"></a>ACCRUED_countries <span class="ot">&lt;-</span> <span class="fu">c</span>(govbonds[[<span class="st">&quot;GERMANY&quot;</span>]]<span class="sc">$</span>ACCRUED[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;GERMANY&quot;</span>]]<span class="sc">$</span>ACCRUED)], govbonds[[<span class="st">&quot;AUSTRIA&quot;</span>]]<span class="sc">$</span>ACCRUED[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;AUSTRIA&quot;</span>]]<span class="sc">$</span>ACCRUED)], govbonds[[<span class="st">&quot;FRANCE&quot;</span>]]<span class="sc">$</span>ACCRUED[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;FRANCE&quot;</span>]]<span class="sc">$</span>ACCRUED)])</span>
<span id="cb9745-30"><a href="fixed-income-securities.html#cb9745-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9745-31"><a href="fixed-income-securities.html#cb9745-31" aria-hidden="true" tabindex="-1"></a>CFISIN_countries <span class="ot">&lt;-</span> <span class="fu">c</span>(govbonds[[<span class="st">&quot;GERMANY&quot;</span>]]<span class="sc">$</span>CASHFLOWS<span class="sc">$</span>ISIN[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;GERMANY&quot;</span>]]<span class="sc">$</span>CASHFLOWS<span class="sc">$</span>ISIN)], govbonds[[<span class="st">&quot;AUSTRIA&quot;</span>]]<span class="sc">$</span>CASHFLOWS<span class="sc">$</span>ISIN[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;AUSTRIA&quot;</span>]]<span class="sc">$</span>CASHFLOWS<span class="sc">$</span>ISIN)], govbonds[[<span class="st">&quot;FRANCE&quot;</span>]]<span class="sc">$</span>CASHFLOWS<span class="sc">$</span>ISIN[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;FRANCE&quot;</span>]]<span class="sc">$</span>CASHFLOWS<span class="sc">$</span>ISIN)])</span>
<span id="cb9745-32"><a href="fixed-income-securities.html#cb9745-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9745-33"><a href="fixed-income-securities.html#cb9745-33" aria-hidden="true" tabindex="-1"></a>CF_countries <span class="ot">&lt;-</span> <span class="fu">c</span>(govbonds[[<span class="st">&quot;GERMANY&quot;</span>]]<span class="sc">$</span>CASHFLOWS<span class="sc">$</span>CF[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;GERMANY&quot;</span>]]<span class="sc">$</span>CASHFLOWS<span class="sc">$</span>CF)], govbonds[[<span class="st">&quot;AUSTRIA&quot;</span>]]<span class="sc">$</span>CASHFLOWS<span class="sc">$</span>CF[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;AUSTRIA&quot;</span>]]<span class="sc">$</span>CASHFLOWS<span class="sc">$</span>CF)], govbonds[[<span class="st">&quot;FRANCE&quot;</span>]]<span class="sc">$</span>CASHFLOWS<span class="sc">$</span>CF[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;FRANCE&quot;</span>]]<span class="sc">$</span>CASHFLOWS<span class="sc">$</span>CF)])</span>
<span id="cb9745-34"><a href="fixed-income-securities.html#cb9745-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9745-35"><a href="fixed-income-securities.html#cb9745-35" aria-hidden="true" tabindex="-1"></a>DATE_countries <span class="ot">&lt;-</span> <span class="fu">c</span>(govbonds[[<span class="st">&quot;GERMANY&quot;</span>]]<span class="sc">$</span>CASHFLOWS<span class="sc">$</span>DATE[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;GERMANY&quot;</span>]]<span class="sc">$</span>CASHFLOWS<span class="sc">$</span>DATE)], govbonds[[<span class="st">&quot;AUSTRIA&quot;</span>]]<span class="sc">$</span>CASHFLOWS<span class="sc">$</span>DATE[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;AUSTRIA&quot;</span>]]<span class="sc">$</span>CASHFLOWS<span class="sc">$</span>DATE)], govbonds[[<span class="st">&quot;FRANCE&quot;</span>]]<span class="sc">$</span>CASHFLOWS<span class="sc">$</span>DATE[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(govbonds[[<span class="st">&quot;FRANCE&quot;</span>]]<span class="sc">$</span>CASHFLOWS<span class="sc">$</span>DATE)])</span>
<span id="cb9745-36"><a href="fixed-income-securities.html#cb9745-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9745-37"><a href="fixed-income-securities.html#cb9745-37" aria-hidden="true" tabindex="-1"></a><span class="do">## Based on this, we can now create the entire structural dataset</span></span>
<span id="cb9745-38"><a href="fixed-income-securities.html#cb9745-38" aria-hidden="true" tabindex="-1"></a>ISIN <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(ISIN_countries, <span class="at">mode =</span> <span class="st">&quot;character&quot;</span>)</span>
<span id="cb9745-39"><a href="fixed-income-securities.html#cb9745-39" aria-hidden="true" tabindex="-1"></a>MATURITYDATE <span class="ot">&lt;-</span> <span class="fu">structure</span>(<span class="fu">as.vector</span>(MATURITYDATE_countries, <span class="at">mode =</span> <span class="st">&quot;any&quot;</span>), <span class="at">class=</span><span class="st">&quot;Date&quot;</span>)</span>
<span id="cb9745-40"><a href="fixed-income-securities.html#cb9745-40" aria-hidden="true" tabindex="-1"></a>ISSUEDATE <span class="ot">&lt;-</span> <span class="fu">structure</span>(<span class="fu">as.vector</span>(ISSUEDATE_countries, <span class="at">mode =</span> <span class="st">&quot;any&quot;</span>), <span class="at">class=</span><span class="st">&quot;Date&quot;</span>)</span>
<span id="cb9745-41"><a href="fixed-income-securities.html#cb9745-41" aria-hidden="true" tabindex="-1"></a>COUPONRATE <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(COUPONRATE_countries, <span class="at">mode =</span> <span class="st">&quot;numeric&quot;</span>)</span>
<span id="cb9745-42"><a href="fixed-income-securities.html#cb9745-42" aria-hidden="true" tabindex="-1"></a>PRICE <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(PRICE_countries, <span class="at">mode =</span> <span class="st">&quot;numeric&quot;</span>)</span>
<span id="cb9745-43"><a href="fixed-income-securities.html#cb9745-43" aria-hidden="true" tabindex="-1"></a>ACCRUED <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(ACCRUED_countries, <span class="at">mode =</span> <span class="st">&quot;numeric&quot;</span>)</span>
<span id="cb9745-44"><a href="fixed-income-securities.html#cb9745-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9745-45"><a href="fixed-income-securities.html#cb9745-45" aria-hidden="true" tabindex="-1"></a>CFISIN <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(CFISIN_countries, <span class="at">mode =</span> <span class="st">&quot;character&quot;</span>)</span>
<span id="cb9745-46"><a href="fixed-income-securities.html#cb9745-46" aria-hidden="true" tabindex="-1"></a>CF <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(CF_countries, <span class="at">mode =</span> <span class="st">&quot;numeric&quot;</span>)</span>
<span id="cb9745-47"><a href="fixed-income-securities.html#cb9745-47" aria-hidden="true" tabindex="-1"></a>DATE <span class="ot">&lt;-</span> <span class="fu">structure</span>(<span class="fu">as.vector</span>(DATE_countries, <span class="at">mode =</span> <span class="st">&quot;any&quot;</span>), <span class="at">class=</span><span class="st">&quot;Date&quot;</span>)</span>
<span id="cb9745-48"><a href="fixed-income-securities.html#cb9745-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9745-49"><a href="fixed-income-securities.html#cb9745-49" aria-hidden="true" tabindex="-1"></a><span class="do">## Here, the numbers are just the observations per country</span></span>
<span id="cb9745-50"><a href="fixed-income-securities.html#cb9745-50" aria-hidden="true" tabindex="-1"></a>CASHFLOWS_D <span class="ot">&lt;-</span> <span class="fu">list</span>(CFISIN[<span class="dv">1</span><span class="sc">:</span><span class="dv">384</span>],CF[<span class="dv">1</span><span class="sc">:</span><span class="dv">384</span>],DATE[<span class="dv">1</span><span class="sc">:</span><span class="dv">384</span>])</span>
<span id="cb9745-51"><a href="fixed-income-securities.html#cb9745-51" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(CASHFLOWS_D) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ISIN&quot;</span>,<span class="st">&quot;CF&quot;</span>,<span class="st">&quot;DATE&quot;</span>)</span>
<span id="cb9745-52"><a href="fixed-income-securities.html#cb9745-52" aria-hidden="true" tabindex="-1"></a>CASHFLOWS_A <span class="ot">&lt;-</span> <span class="fu">list</span>(CFISIN[<span class="dv">385</span><span class="sc">:</span><span class="dv">541</span>],CF[<span class="dv">385</span><span class="sc">:</span><span class="dv">541</span>],DATE[<span class="dv">385</span><span class="sc">:</span><span class="dv">541</span>])</span>
<span id="cb9745-53"><a href="fixed-income-securities.html#cb9745-53" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(CASHFLOWS_A) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ISIN&quot;</span>,<span class="st">&quot;CF&quot;</span>,<span class="st">&quot;DATE&quot;</span>)</span>
<span id="cb9745-54"><a href="fixed-income-securities.html#cb9745-54" aria-hidden="true" tabindex="-1"></a>CASHFLOWS_F <span class="ot">&lt;-</span> <span class="fu">list</span>(CFISIN[<span class="dv">542</span><span class="sc">:</span><span class="dv">942</span>],CF[<span class="dv">542</span><span class="sc">:</span><span class="dv">942</span>],DATE[<span class="dv">542</span><span class="sc">:</span><span class="dv">942</span>])</span>
<span id="cb9745-55"><a href="fixed-income-securities.html#cb9745-55" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(CASHFLOWS_F) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ISIN&quot;</span>,<span class="st">&quot;CF&quot;</span>,<span class="st">&quot;DATE&quot;</span>)</span>
<span id="cb9745-56"><a href="fixed-income-securities.html#cb9745-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9745-57"><a href="fixed-income-securities.html#cb9745-57" aria-hidden="true" tabindex="-1"></a><span class="do">## Lastly, define the actual date of your starting observations</span></span>
<span id="cb9745-58"><a href="fixed-income-securities.html#cb9745-58" aria-hidden="true" tabindex="-1"></a>TODAY <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">&quot;2008-01-30&quot;</span>))</span>
<span id="cb9745-59"><a href="fixed-income-securities.html#cb9745-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9745-60"><a href="fixed-income-securities.html#cb9745-60" aria-hidden="true" tabindex="-1"></a><span class="do">## Then, you can create a list with all the required data (also here look that the data is appropriately distributed)</span></span>
<span id="cb9745-61"><a href="fixed-income-securities.html#cb9745-61" aria-hidden="true" tabindex="-1"></a>GERMANY <span class="ot">&lt;-</span> <span class="fu">list</span>(ISIN[<span class="dv">1</span><span class="sc">:</span><span class="dv">52</span>],MATURITYDATE[<span class="dv">1</span><span class="sc">:</span><span class="dv">52</span>],ISSUEDATE[<span class="dv">1</span><span class="sc">:</span><span class="dv">52</span>],</span>
<span id="cb9745-62"><a href="fixed-income-securities.html#cb9745-62" aria-hidden="true" tabindex="-1"></a>                   COUPONRATE[<span class="dv">1</span><span class="sc">:</span><span class="dv">52</span>],PRICE[<span class="dv">1</span><span class="sc">:</span><span class="dv">52</span>],ACCRUED[<span class="dv">1</span><span class="sc">:</span><span class="dv">52</span>],CASHFLOWS_D,TODAY)</span>
<span id="cb9745-63"><a href="fixed-income-securities.html#cb9745-63" aria-hidden="true" tabindex="-1"></a>AUSTRIA <span class="ot">&lt;-</span> <span class="fu">list</span>(ISIN[<span class="dv">53</span><span class="sc">:</span><span class="dv">68</span>],MATURITYDATE[<span class="dv">53</span><span class="sc">:</span><span class="dv">68</span>],ISSUEDATE[<span class="dv">53</span><span class="sc">:</span><span class="dv">68</span>],</span>
<span id="cb9745-64"><a href="fixed-income-securities.html#cb9745-64" aria-hidden="true" tabindex="-1"></a>                   COUPONRATE[<span class="dv">53</span><span class="sc">:</span><span class="dv">68</span>],PRICE[<span class="dv">53</span><span class="sc">:</span><span class="dv">68</span>],ACCRUED[<span class="dv">53</span><span class="sc">:</span><span class="dv">68</span>],CASHFLOWS_A,TODAY)</span>
<span id="cb9745-65"><a href="fixed-income-securities.html#cb9745-65" aria-hidden="true" tabindex="-1"></a>FRANCE <span class="ot">&lt;-</span> <span class="fu">list</span>(ISIN[<span class="dv">69</span><span class="sc">:</span><span class="dv">114</span>],MATURITYDATE[<span class="dv">69</span><span class="sc">:</span><span class="dv">114</span>],ISSUEDATE[<span class="dv">69</span><span class="sc">:</span><span class="dv">114</span>],</span>
<span id="cb9745-66"><a href="fixed-income-securities.html#cb9745-66" aria-hidden="true" tabindex="-1"></a>                   COUPONRATE[<span class="dv">69</span><span class="sc">:</span><span class="dv">114</span>],PRICE[<span class="dv">69</span><span class="sc">:</span><span class="dv">114</span>],ACCRUED[<span class="dv">69</span><span class="sc">:</span><span class="dv">114</span>],CASHFLOWS_F,TODAY)</span>
<span id="cb9745-67"><a href="fixed-income-securities.html#cb9745-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9745-68"><a href="fixed-income-securities.html#cb9745-68" aria-hidden="true" tabindex="-1"></a><span class="do">## Tale the names</span></span>
<span id="cb9745-69"><a href="fixed-income-securities.html#cb9745-69" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(GERMANY) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ISIN&quot;</span>,<span class="st">&quot;MATURITYDATE&quot;</span>,<span class="st">&quot;ISSUEDATE&quot;</span>,<span class="st">&quot;COUPONRATE&quot;</span>,</span>
<span id="cb9745-70"><a href="fixed-income-securities.html#cb9745-70" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;PRICE&quot;</span>,<span class="st">&quot;ACCRUED&quot;</span>,<span class="st">&quot;CASHFLOWS&quot;</span>,<span class="st">&quot;TODAY&quot;</span>)</span>
<span id="cb9745-71"><a href="fixed-income-securities.html#cb9745-71" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(AUSTRIA) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ISIN&quot;</span>,<span class="st">&quot;MATURITYDATE&quot;</span>,<span class="st">&quot;ISSUEDATE&quot;</span>,<span class="st">&quot;COUPONRATE&quot;</span>,</span>
<span id="cb9745-72"><a href="fixed-income-securities.html#cb9745-72" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;PRICE&quot;</span>,<span class="st">&quot;ACCRUED&quot;</span>,<span class="st">&quot;CASHFLOWS&quot;</span>,<span class="st">&quot;TODAY&quot;</span>)</span>
<span id="cb9745-73"><a href="fixed-income-securities.html#cb9745-73" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(FRANCE) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ISIN&quot;</span>,<span class="st">&quot;MATURITYDATE&quot;</span>,<span class="st">&quot;ISSUEDATE&quot;</span>,<span class="st">&quot;COUPONRATE&quot;</span>,</span>
<span id="cb9745-74"><a href="fixed-income-securities.html#cb9745-74" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;PRICE&quot;</span>,<span class="st">&quot;ACCRUED&quot;</span>,<span class="st">&quot;CASHFLOWS&quot;</span>,<span class="st">&quot;TODAY&quot;</span>)</span>
<span id="cb9745-75"><a href="fixed-income-securities.html#cb9745-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9745-76"><a href="fixed-income-securities.html#cb9745-76" aria-hidden="true" tabindex="-1"></a><span class="do">## merge the lists and create names and classes</span></span>
<span id="cb9745-77"><a href="fixed-income-securities.html#cb9745-77" aria-hidden="true" tabindex="-1"></a>mybonds <span class="ot">&lt;-</span> <span class="fu">list</span>(GERMANY,AUSTRIA, FRANCE)</span>
<span id="cb9745-78"><a href="fixed-income-securities.html#cb9745-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9745-79"><a href="fixed-income-securities.html#cb9745-79" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mybonds) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;GERMANY&quot;</span>,<span class="st">&quot;AUSTRIA&quot;</span>, <span class="st">&quot;FRANCE&quot;</span>)</span>
<span id="cb9745-80"><a href="fixed-income-securities.html#cb9745-80" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mybonds) <span class="ot">&lt;-</span> <span class="st">&quot;couponbonds&quot;</span></span>
<span id="cb9745-81"><a href="fixed-income-securities.html#cb9745-81" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mybonds)</span></code></pre></div>
<pre><code>## List of 3
##  $ GERMANY:List of 8
##   ..$ ISIN        : chr [1:52] &quot;DE0001141414&quot; &quot;DE0001137131&quot; &quot;DE0001141422&quot; &quot;DE0001137149&quot; ...
##   ..$ MATURITYDATE: Date[1:52], format: &quot;2008-02-15&quot; &quot;2008-03-14&quot; &quot;2008-04-11&quot; &quot;2008-06-13&quot; ...
##   ..$ ISSUEDATE   : Date[1:52], format: &quot;2002-08-14&quot; &quot;2006-03-08&quot; &quot;2003-04-11&quot; &quot;2006-05-30&quot; ...
##   ..$ COUPONRATE  : num [1:52] 0.0425 0.03 0.03 0.0325 0.0413 ...
##   ..$ PRICE       : num [1:52] 100 99.9 99.8 99.8 100.1 ...
##   ..$ ACCRUED     : num [1:52] 4.09 2.66 2.43 2.07 2.39 ...
##   ..$ CASHFLOWS   :List of 3
##   .. ..$ ISIN: chr [1:384] &quot;DE0001141414&quot; &quot;DE0001137131&quot; &quot;DE0001141422&quot; &quot;DE0001137149&quot; ...
##   .. ..$ CF  : num [1:384] 104 103 103 103 104 ...
##   .. ..$ DATE: Date[1:384], format: &quot;2008-02-15&quot; &quot;2008-03-14&quot; &quot;2008-04-11&quot; &quot;2008-06-13&quot; ...
##   ..$ TODAY       : Date[1:1], format: &quot;2008-01-30&quot;
##  $ AUSTRIA:List of 8
##   ..$ ISIN        : chr [1:16] &quot;AT0000384821&quot; &quot;AT0000384938&quot; &quot;AT0000385067&quot; &quot;AT0000385356&quot; ...
##   ..$ MATURITYDATE: Date[1:16], format: &quot;2009-07-15&quot; &quot;2010-01-15&quot; &quot;2011-01-04&quot; &quot;2012-07-15&quot; ...
##   ..$ ISSUEDATE   : Date[1:16], format: &quot;1999-02-22&quot; &quot;1999-10-22&quot; &quot;2001-01-04&quot; &quot;2002-01-09&quot; ...
##   ..$ COUPONRATE  : num [1:16] 0.04 0.055 0.0525 0.05 0.038 ...
##   ..$ PRICE       : num [1:16] 100.5 103.6 104.4 105 99.8 ...
##   ..$ ACCRUED     : num [1:16] 2.229 0.3 0.445 2.787 1.111 ...
##   ..$ CASHFLOWS   :List of 3
##   .. ..$ ISIN: chr [1:157] &quot;AT0000384821&quot; &quot;AT0000384821&quot; &quot;AT0000384938&quot; &quot;AT0000384938&quot; ...
##   .. ..$ CF  : num [1:157] 4 104 5.5 105.5 5.25 ...
##   .. ..$ DATE: Date[1:157], format: &quot;2008-07-15&quot; &quot;2009-07-15&quot; &quot;2009-01-15&quot; &quot;2010-01-15&quot; ...
##   ..$ TODAY       : Date[1:1], format: &quot;2008-01-30&quot;
##  $ FRANCE :List of 8
##   ..$ ISIN        : chr [1:46] &quot;FR0108197569&quot; &quot;FR0000570632&quot; &quot;FR0105760112&quot; &quot;FR0109136137&quot; ...
##   ..$ MATURITYDATE: Date[1:46], format: &quot;2008-03-12&quot; &quot;2008-04-25&quot; &quot;2008-07-12&quot; &quot;2008-09-12&quot; ...
##   ..$ ISSUEDATE   : Date[1:46], format: &quot;2005-11-08&quot; &quot;1998-01-08&quot; &quot;2003-06-23&quot; &quot;2006-07-19&quot; ...
##   ..$ COUPONRATE  : num [1:46] 0.0275 0.0525 0.03 0.035 0.085 0.035 0.04 0.035 0.04 0.04 ...
##   ..$ PRICE       : num [1:46] 99.9 100.2 99.6 99.8 103.2 ...
##   ..$ ACCRUED     : num [1:46] 2.44 4.09 1.66 1.35 2.37 ...
##   ..$ CASHFLOWS   :List of 3
##   .. ..$ ISIN: chr [1:401] &quot;FR0108197569&quot; &quot;FR0000570632&quot; &quot;FR0105760112&quot; &quot;FR0109136137&quot; ...
##   .. ..$ CF  : num [1:401] 103 105 103 104 108 ...
##   .. ..$ DATE: Date[1:401], format: &quot;2008-03-12&quot; &quot;2008-04-25&quot; &quot;2008-07-12&quot; &quot;2008-09-12&quot; ...
##   ..$ TODAY       : Date[1:1], format: &quot;2008-01-30&quot;
##  - attr(*, &quot;class&quot;)= chr &quot;couponbonds&quot;</code></pre>
<p>Let’s compare this with the structure of the pre-defined dataset the authors provide. As we can see, these are identical. As such, we now know how to construct data sets such that we can use the functions of the package.</p>
<div class="sourceCode" id="cb9747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9747-1"><a href="fixed-income-securities.html#cb9747-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(govbonds)</span></code></pre></div>
<pre><code>## List of 3
##  $ GERMANY:List of 8
##   ..$ ISIN        : chr [1:52] &quot;DE0001141414&quot; &quot;DE0001137131&quot; &quot;DE0001141422&quot; &quot;DE0001137149&quot; ...
##   ..$ MATURITYDATE: Date[1:52], format: &quot;2008-02-15&quot; &quot;2008-03-14&quot; &quot;2008-04-11&quot; &quot;2008-06-13&quot; ...
##   ..$ ISSUEDATE   : Date[1:52], format: &quot;2002-08-14&quot; &quot;2006-03-08&quot; &quot;2003-04-11&quot; &quot;2006-05-30&quot; ...
##   ..$ COUPONRATE  : num [1:52] 0.0425 0.03 0.03 0.0325 0.0413 ...
##   ..$ PRICE       : num [1:52] 100 99.9 99.8 99.8 100.1 ...
##   ..$ ACCRUED     : num [1:52] 4.09 2.66 2.43 2.07 2.39 ...
##   ..$ CASHFLOWS   :List of 3
##   .. ..$ ISIN: chr [1:384] &quot;DE0001141414&quot; &quot;DE0001137131&quot; &quot;DE0001141422&quot; &quot;DE0001137149&quot; ...
##   .. ..$ CF  : num [1:384] 104 103 103 103 104 ...
##   .. ..$ DATE: Date[1:384], format: &quot;2008-02-15&quot; &quot;2008-03-14&quot; &quot;2008-04-11&quot; &quot;2008-06-13&quot; ...
##   ..$ TODAY       : Date[1:1], format: &quot;2008-01-30&quot;
##  $ AUSTRIA:List of 8
##   ..$ ISIN        : chr [1:16] &quot;AT0000384821&quot; &quot;AT0000384938&quot; &quot;AT0000385067&quot; &quot;AT0000385356&quot; ...
##   ..$ MATURITYDATE: Date[1:16], format: &quot;2009-07-15&quot; &quot;2010-01-15&quot; &quot;2011-01-04&quot; &quot;2012-07-15&quot; ...
##   ..$ ISSUEDATE   : Date[1:16], format: &quot;1999-02-22&quot; &quot;1999-10-22&quot; &quot;2001-01-04&quot; &quot;2002-01-09&quot; ...
##   ..$ COUPONRATE  : num [1:16] 0.04 0.055 0.0525 0.05 0.038 ...
##   ..$ PRICE       : num [1:16] 100.5 103.6 104.4 105 99.8 ...
##   ..$ ACCRUED     : num [1:16] 2.229 0.3 0.445 2.787 1.111 ...
##   ..$ CASHFLOWS   :List of 3
##   .. ..$ ISIN: chr [1:157] &quot;AT0000384821&quot; &quot;AT0000384821&quot; &quot;AT0000384938&quot; &quot;AT0000384938&quot; ...
##   .. ..$ CF  : num [1:157] 4 104 5.5 105.5 5.25 ...
##   .. ..$ DATE: Date[1:157], format: &quot;2008-07-15&quot; &quot;2009-07-15&quot; &quot;2009-01-15&quot; &quot;2010-01-15&quot; ...
##   ..$ TODAY       : Date[1:1], format: &quot;2008-01-30&quot;
##  $ FRANCE :List of 8
##   ..$ ISIN        : chr [1:45] &quot;FR0108197569&quot; &quot;FR0000570632&quot; &quot;FR0105760112&quot; &quot;FR0109136137&quot; ...
##   ..$ MATURITYDATE: Date[1:45], format: &quot;2008-03-12&quot; &quot;2008-04-25&quot; &quot;2008-07-12&quot; &quot;2008-09-12&quot; ...
##   ..$ ISSUEDATE   : Date[1:45], format: &quot;2005-11-08&quot; &quot;1998-01-08&quot; &quot;2003-06-23&quot; &quot;2006-07-19&quot; ...
##   ..$ COUPONRATE  : num [1:45] 0.0275 0.0525 0.03 0.035 0.085 0.035 0.04 0.035 0.04 0.04 ...
##   ..$ PRICE       : num [1:45] 99.9 100.2 99.6 99.8 103.2 ...
##   ..$ ACCRUED     : num [1:45] 2.44 4.09 1.66 1.35 2.37 ...
##   ..$ CASHFLOWS   :List of 3
##   .. ..$ ISIN: chr [1:401] &quot;FR0108197569&quot; &quot;FR0000570632&quot; &quot;FR0105760112&quot; &quot;FR0109136137&quot; ...
##   .. ..$ CF  : num [1:401] 103 105 103 104 108 ...
##   .. ..$ DATE: Date[1:401], format: &quot;2008-03-12&quot; &quot;2008-04-25&quot; &quot;2008-07-12&quot; &quot;2008-09-12&quot; ...
##   ..$ TODAY       : Date[1:1], format: &quot;2008-01-30&quot;
##  - attr(*, &quot;class&quot;)= chr &quot;couponbonds&quot;</code></pre>
<div id="parametric-approach" class="section level5" number="5.4.4.3.1">
<h5><span class="header-section-number">5.4.4.3.1</span> Parametric approach</h5>
<p>Lets suppose we want to estimate the zero-coupon yield curve for the three included countries with the Nelson and Siegel (1987) method minimizing the duration weighted pricing errors. The sample of bonds is restricted to a maximum maturity of 30 years (as the authors project). Consequently, we can run the following command:</p>
<div class="sourceCode" id="cb9749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9749-1"><a href="fixed-income-securities.html#cb9749-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the Svenson and Nielsen / Siegel approaches</span></span>
<span id="cb9749-2"><a href="fixed-income-securities.html#cb9749-2" aria-hidden="true" tabindex="-1"></a>x_sv <span class="ot">&lt;-</span> <span class="fu">estim_nss</span>(govbonds, <span class="st">&#39;GERMANY&#39;</span>, <span class="at">method =</span> <span class="st">&quot;sv&quot;</span>, <span class="at">matrange =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>))</span></code></pre></div>
<pre><code>## [1] &quot;The following constraints are used for the tau parameters:&quot;
## $GERMANY
##      tau_min      tau_max gridstepsize tau_distance 
##   0.04383562  28.95068493   0.20000000   0.50000000 
## 
## [1] &quot;Searching startparameters for  GERMANY&quot;
##         beta0         beta1         beta2          tau1         beta3          tau2 
##  0.0006482007  3.7569300955 -0.1380459067  2.8439356164 14.0891509207 15.2439356164</code></pre>
<div class="sourceCode" id="cb9751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9751-1"><a href="fixed-income-securities.html#cb9751-1" aria-hidden="true" tabindex="-1"></a>x_nss <span class="ot">&lt;-</span> <span class="fu">estim_nss</span>(govbonds, <span class="st">&#39;GERMANY&#39;</span>, <span class="at">method =</span> <span class="st">&quot;ns&quot;</span>, <span class="at">matrange =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>))</span></code></pre></div>
<pre><code>## [1] &quot;The following constraints are used for the tau parameters:&quot;
## $GERMANY
##      tau_min      tau_max gridstepsize 
##   0.04383562  28.95068493   0.20000000 
## 
## [1] &quot;Searching startparameters for  GERMANY&quot;
##     beta0     beta1     beta2      tau1 
##  5.120486 -1.245501 -3.243823  2.643936</code></pre>
<p>In order to do so, we need to define optimal starting parameters (so-called search parameters). These are automatically calculated by the function. They work by minimising a convex objective function.</p>
<p>Based on this approach, we can now plot the estimated yield curve for each approach:</p>
<div class="sourceCode" id="cb9753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9753-1"><a href="fixed-income-securities.html#cb9753-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">estim_cs</span>(govbonds, <span class="st">&#39;GERMANY&#39;</span>)</span>
<span id="cb9753-2"><a href="fixed-income-securities.html#cb9753-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, we can also plot the relationship</span></span>
<span id="cb9753-3"><a href="fixed-income-securities.html#cb9753-3" aria-hidden="true" tabindex="-1"></a><span class="do">## First, the actual observations</span></span>
<span id="cb9753-4"><a href="fixed-income-securities.html#cb9753-4" aria-hidden="true" tabindex="-1"></a>actual_FI <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(x_nss<span class="sc">$</span>y<span class="sc">$</span>GERMANY)</span>
<span id="cb9753-5"><a href="fixed-income-securities.html#cb9753-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(actual_FI) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Maturity&quot;</span>, <span class="st">&quot;Yield_Actual&quot;</span>)</span>
<span id="cb9753-6"><a href="fixed-income-securities.html#cb9753-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Now the estimated ones </span></span>
<span id="cb9753-7"><a href="fixed-income-securities.html#cb9753-7" aria-hidden="true" tabindex="-1"></a>est_FI <span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(x_nss<span class="sc">$</span>yhat<span class="sc">$</span>GERMANY)</span>
<span id="cb9753-8"><a href="fixed-income-securities.html#cb9753-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(est_FI) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Maturity&quot;</span>, <span class="st">&quot;Yield_Estimated&quot;</span>)</span>
<span id="cb9753-9"><a href="fixed-income-securities.html#cb9753-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Bind them together</span></span>
<span id="cb9753-10"><a href="fixed-income-securities.html#cb9753-10" aria-hidden="true" tabindex="-1"></a>est_act_FI <span class="ot">&lt;-</span> <span class="fu">left_join</span>(actual_FI, est_FI, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Maturity&quot;</span> <span class="ot">=</span> <span class="st">&quot;Maturity&quot;</span>))</span>
<span id="cb9753-11"><a href="fixed-income-securities.html#cb9753-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the confidence interval surrounding the estimated yields </span></span>
<span id="cb9753-12"><a href="fixed-income-securities.html#cb9753-12" aria-hidden="true" tabindex="-1"></a>est_act_FI_final <span class="ot">&lt;-</span> est_act_FI <span class="sc">%&gt;%</span> </span>
<span id="cb9753-13"><a href="fixed-income-securities.html#cb9753-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9753-14"><a href="fixed-income-securities.html#cb9753-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Yield_Estimated =</span> <span class="dv">100</span><span class="sc">*</span>Yield_Estimated,</span>
<span id="cb9753-15"><a href="fixed-income-securities.html#cb9753-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Yield_Actual =</span> <span class="dv">100</span><span class="sc">*</span>Yield_Actual,</span>
<span id="cb9753-16"><a href="fixed-income-securities.html#cb9753-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">std_yield =</span> <span class="fu">sd</span>(Yield_Estimated), </span>
<span id="cb9753-17"><a href="fixed-income-securities.html#cb9753-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_obs =</span> <span class="fu">length</span>(Yield_Estimated), </span>
<span id="cb9753-18"><a href="fixed-income-securities.html#cb9753-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">error =</span>  <span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span>std_yield<span class="sc">/</span><span class="fu">sqrt</span>(n_obs), </span>
<span id="cb9753-19"><a href="fixed-income-securities.html#cb9753-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_up =</span> Yield_Estimated <span class="sc">+</span> error,</span>
<span id="cb9753-20"><a href="fixed-income-securities.html#cb9753-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_down =</span> Yield_Estimated <span class="sc">-</span> error) <span class="sc">%&gt;%</span> </span>
<span id="cb9753-21"><a href="fixed-income-securities.html#cb9753-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Maturity, Yield_Estimated, Yield_Actual, CI_up, CI_down)</span>
<span id="cb9753-22"><a href="fixed-income-securities.html#cb9753-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9753-23"><a href="fixed-income-securities.html#cb9753-23" aria-hidden="true" tabindex="-1"></a>est_act_FI_final <span class="sc">%&gt;%</span> </span>
<span id="cb9753-24"><a href="fixed-income-securities.html#cb9753-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Maturity, <span class="at">y =</span> Yield_Actual)) <span class="sc">+</span> </span>
<span id="cb9753-25"><a href="fixed-income-securities.html#cb9753-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;goldenrod&quot;</span>, <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9753-26"><a href="fixed-income-securities.html#cb9753-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> est_act_FI_final<span class="sc">$</span>Maturity, <span class="at">y =</span> est_act_FI_final<span class="sc">$</span>Yield_Estimated)) <span class="sc">+</span> </span>
<span id="cb9753-27"><a href="fixed-income-securities.html#cb9753-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> est_act_FI_final<span class="sc">$</span>CI_up, <span class="at">ymin =</span> est_act_FI_final<span class="sc">$</span>CI_down), <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb9753-28"><a href="fixed-income-securities.html#cb9753-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> x<span class="sc">$</span>knotpoints[[<span class="dv">1</span>]], <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;lightgrey&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9753-29"><a href="fixed-income-securities.html#cb9753-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">2</span>, <span class="fl">5.5</span>) <span class="sc">+</span> </span>
<span id="cb9753-30"><a href="fixed-income-securities.html#cb9753-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Yield Curve Estimation w/ Nelson &amp; Siegel for German Government Bonds&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9753-31"><a href="fixed-income-securities.html#cb9753-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Zero-Coupon Yields in %&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Maturity in Years&quot;</span>) <span class="sc">+</span></span>
<span id="cb9753-32"><a href="fixed-income-securities.html#cb9753-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&quot;Est. Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9753-33"><a href="fixed-income-securities.html#cb9753-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Actual Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9753-34"><a href="fixed-income-securities.html#cb9753-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9753-35"><a href="fixed-income-securities.html#cb9753-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9753-36"><a href="fixed-income-securities.html#cb9753-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">lineheight=</span><span class="fl">1.2</span>, <span class="at">margin=</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">15</span>,<span class="dv">15</span>)), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9753-37"><a href="fixed-income-securities.html#cb9753-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9753-38"><a href="fixed-income-securities.html#cb9753-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9753-39"><a href="fixed-income-securities.html#cb9753-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9753-40"><a href="fixed-income-securities.html#cb9753-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9753-41"><a href="fixed-income-securities.html#cb9753-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9753-42"><a href="fixed-income-securities.html#cb9753-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9753-43"><a href="fixed-income-securities.html#cb9753-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>)) </span></code></pre></div>
<pre><code>## Warning: Use of `est_act_FI_final$Maturity` is discouraged. Use `Maturity` instead.</code></pre>
<pre><code>## Warning: Use of `est_act_FI_final$Yield_Estimated` is discouraged. Use `Yield_Estimated` instead.</code></pre>
<pre><code>## Warning: Use of `est_act_FI_final$CI_up` is discouraged. Use `CI_up` instead.</code></pre>
<pre><code>## Warning: Use of `est_act_FI_final$CI_down` is discouraged. Use `CI_down` instead.</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-228-1.png" width="672" /></p>
<div class="sourceCode" id="cb9758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9758-1"><a href="fixed-income-securities.html#cb9758-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, we can also plot the relationship</span></span>
<span id="cb9758-2"><a href="fixed-income-securities.html#cb9758-2" aria-hidden="true" tabindex="-1"></a><span class="do">## First, the actual observations</span></span>
<span id="cb9758-3"><a href="fixed-income-securities.html#cb9758-3" aria-hidden="true" tabindex="-1"></a>actual_FI <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(x_sv<span class="sc">$</span>y<span class="sc">$</span>GERMANY)</span>
<span id="cb9758-4"><a href="fixed-income-securities.html#cb9758-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(actual_FI) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Maturity&quot;</span>, <span class="st">&quot;Yield_Actual&quot;</span>)</span>
<span id="cb9758-5"><a href="fixed-income-securities.html#cb9758-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Now the estimated ones </span></span>
<span id="cb9758-6"><a href="fixed-income-securities.html#cb9758-6" aria-hidden="true" tabindex="-1"></a>est_FI <span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(x_sv<span class="sc">$</span>yhat<span class="sc">$</span>GERMANY)</span>
<span id="cb9758-7"><a href="fixed-income-securities.html#cb9758-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(est_FI) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Maturity&quot;</span>, <span class="st">&quot;Yield_Estimated&quot;</span>)</span>
<span id="cb9758-8"><a href="fixed-income-securities.html#cb9758-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Bind them together</span></span>
<span id="cb9758-9"><a href="fixed-income-securities.html#cb9758-9" aria-hidden="true" tabindex="-1"></a>est_act_FI <span class="ot">&lt;-</span> <span class="fu">left_join</span>(actual_FI, est_FI, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Maturity&quot;</span> <span class="ot">=</span> <span class="st">&quot;Maturity&quot;</span>))</span>
<span id="cb9758-10"><a href="fixed-income-securities.html#cb9758-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the confidence interval surrounding the estimated yields </span></span>
<span id="cb9758-11"><a href="fixed-income-securities.html#cb9758-11" aria-hidden="true" tabindex="-1"></a>est_act_FI_final <span class="ot">&lt;-</span> est_act_FI <span class="sc">%&gt;%</span> </span>
<span id="cb9758-12"><a href="fixed-income-securities.html#cb9758-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9758-13"><a href="fixed-income-securities.html#cb9758-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Yield_Estimated =</span> <span class="dv">100</span><span class="sc">*</span>Yield_Estimated,</span>
<span id="cb9758-14"><a href="fixed-income-securities.html#cb9758-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Yield_Actual =</span> <span class="dv">100</span><span class="sc">*</span>Yield_Actual,</span>
<span id="cb9758-15"><a href="fixed-income-securities.html#cb9758-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">std_yield =</span> <span class="fu">sd</span>(Yield_Estimated), </span>
<span id="cb9758-16"><a href="fixed-income-securities.html#cb9758-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_obs =</span> <span class="fu">length</span>(Yield_Estimated), </span>
<span id="cb9758-17"><a href="fixed-income-securities.html#cb9758-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">error =</span>  <span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span>std_yield<span class="sc">/</span><span class="fu">sqrt</span>(n_obs), </span>
<span id="cb9758-18"><a href="fixed-income-securities.html#cb9758-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_up =</span> Yield_Estimated <span class="sc">+</span> error,</span>
<span id="cb9758-19"><a href="fixed-income-securities.html#cb9758-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_down =</span> Yield_Estimated <span class="sc">-</span> error) <span class="sc">%&gt;%</span> </span>
<span id="cb9758-20"><a href="fixed-income-securities.html#cb9758-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Maturity, Yield_Estimated, Yield_Actual, CI_up, CI_down)</span>
<span id="cb9758-21"><a href="fixed-income-securities.html#cb9758-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9758-22"><a href="fixed-income-securities.html#cb9758-22" aria-hidden="true" tabindex="-1"></a>est_act_FI_final <span class="sc">%&gt;%</span> </span>
<span id="cb9758-23"><a href="fixed-income-securities.html#cb9758-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Maturity, <span class="at">y =</span> Yield_Actual)) <span class="sc">+</span> </span>
<span id="cb9758-24"><a href="fixed-income-securities.html#cb9758-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;goldenrod&quot;</span>, <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9758-25"><a href="fixed-income-securities.html#cb9758-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> est_act_FI_final<span class="sc">$</span>Maturity, <span class="at">y =</span> est_act_FI_final<span class="sc">$</span>Yield_Estimated)) <span class="sc">+</span> </span>
<span id="cb9758-26"><a href="fixed-income-securities.html#cb9758-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> est_act_FI_final<span class="sc">$</span>CI_up, <span class="at">ymin =</span> est_act_FI_final<span class="sc">$</span>CI_down), <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb9758-27"><a href="fixed-income-securities.html#cb9758-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> x<span class="sc">$</span>knotpoints[[<span class="dv">1</span>]], <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;lightgrey&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9758-28"><a href="fixed-income-securities.html#cb9758-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">2</span>, <span class="fl">5.5</span>) <span class="sc">+</span> </span>
<span id="cb9758-29"><a href="fixed-income-securities.html#cb9758-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Yield Curve Estimation w/ Svenson Family for German Government Bonds&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9758-30"><a href="fixed-income-securities.html#cb9758-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Zero-Coupon Yields in %&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Maturity in Years&quot;</span>) <span class="sc">+</span></span>
<span id="cb9758-31"><a href="fixed-income-securities.html#cb9758-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&quot;Est. Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9758-32"><a href="fixed-income-securities.html#cb9758-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Actual Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9758-33"><a href="fixed-income-securities.html#cb9758-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9758-34"><a href="fixed-income-securities.html#cb9758-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9758-35"><a href="fixed-income-securities.html#cb9758-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">lineheight=</span><span class="fl">1.2</span>, <span class="at">margin=</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">15</span>,<span class="dv">15</span>)), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9758-36"><a href="fixed-income-securities.html#cb9758-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9758-37"><a href="fixed-income-securities.html#cb9758-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9758-38"><a href="fixed-income-securities.html#cb9758-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9758-39"><a href="fixed-income-securities.html#cb9758-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9758-40"><a href="fixed-income-securities.html#cb9758-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9758-41"><a href="fixed-income-securities.html#cb9758-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9758-42"><a href="fixed-income-securities.html#cb9758-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>)) </span></code></pre></div>
<pre><code>## Warning: Use of `est_act_FI_final$Maturity` is discouraged. Use `Maturity` instead.</code></pre>
<pre><code>## Warning: Use of `est_act_FI_final$Yield_Estimated` is discouraged. Use `Yield_Estimated` instead.</code></pre>
<pre><code>## Warning: Use of `est_act_FI_final$CI_up` is discouraged. Use `CI_up` instead.</code></pre>
<pre><code>## Warning: Use of `est_act_FI_final$CI_down` is discouraged. Use `CI_down` instead.</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-229-1.png" width="672" /></p>
<p>It appears as if we were quite successful in estimating the yield curve with the approach proposed. Now, we may also want to have some summary statistics. The summary() method gives goodness of fit measures for the pricing and the yield errors, i.e., the root mean squared error (RMSE) and the average absolute error (AABSE).</p>
<p>For instance, for the nelson siegel:</p>
<div class="sourceCode" id="cb9763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9763-1"><a href="fixed-income-securities.html#cb9763-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimal parameters</span></span>
<span id="cb9763-2"><a href="fixed-income-securities.html#cb9763-2" aria-hidden="true" tabindex="-1"></a>x_nss<span class="sc">$</span>opt_result<span class="sc">$</span>GERMANY<span class="sc">$</span>par</span></code></pre></div>
<pre><code>##     beta0     beta1     beta2      tau1 
##  5.130481 -1.268739 -3.215557  2.689112</code></pre>
<div class="sourceCode" id="cb9765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9765-1"><a href="fixed-income-securities.html#cb9765-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the RMSE</span></span>
<span id="cb9765-2"><a href="fixed-income-securities.html#cb9765-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">sum</span>((x_nss<span class="sc">$</span>p<span class="sc">$</span>GERMANY <span class="sc">-</span> x_nss<span class="sc">$</span>phat<span class="sc">$</span>GERMANY)<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 2.557897</code></pre>
<p>and the svenson:</p>
<div class="sourceCode" id="cb9767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9767-1"><a href="fixed-income-securities.html#cb9767-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimal parameters</span></span>
<span id="cb9767-2"><a href="fixed-income-securities.html#cb9767-2" aria-hidden="true" tabindex="-1"></a>x_sv<span class="sc">$</span>opt_result<span class="sc">$</span>GERMANY<span class="sc">$</span>par</span></code></pre></div>
<pre><code>##         beta0         beta1         beta2          tau1         beta3          tau2 
##  0.0003164659  3.7590811501 -0.1316559404  2.8304424158 14.0896161653 15.2194654957</code></pre>
<div class="sourceCode" id="cb9769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9769-1"><a href="fixed-income-securities.html#cb9769-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the RMSE</span></span>
<span id="cb9769-2"><a href="fixed-income-securities.html#cb9769-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">sum</span>((x_sv<span class="sc">$</span>p<span class="sc">$</span>GERMANY <span class="sc">-</span> x_sv<span class="sc">$</span>phat<span class="sc">$</span>GERMANY)<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 1.534363</code></pre>
<p>As we can see, the Svenson approach is superior as it can account for more of the underlying variation and thus improve model performance.</p>
<p>Lastly, it may also be interesting to plot the pricing error <strong>per</strong> distinct bond:</p>
<div class="sourceCode" id="cb9771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9771-1"><a href="fixed-income-securities.html#cb9771-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Do this solely for the svenson</span></span>
<span id="cb9771-2"><a href="fixed-income-securities.html#cb9771-2" aria-hidden="true" tabindex="-1"></a>df_sven <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(x_sv<span class="sc">$</span>perrors<span class="sc">$</span>GERMANY[,<span class="dv">1</span>], x_sv<span class="sc">$</span>perrors<span class="sc">$</span>GERMANY[,<span class="dv">2</span>]))</span>
<span id="cb9771-3"><a href="fixed-income-securities.html#cb9771-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_sven) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Maturity&quot;</span>, <span class="st">&quot;Pricing Error&quot;</span>)</span>
<span id="cb9771-4"><a href="fixed-income-securities.html#cb9771-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9771-5"><a href="fixed-income-securities.html#cb9771-5" aria-hidden="true" tabindex="-1"></a>df_sven <span class="sc">%&gt;%</span> </span>
<span id="cb9771-6"><a href="fixed-income-securities.html#cb9771-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Maturity, <span class="at">y =</span> <span class="st">`</span><span class="at">Pricing Error</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb9771-7"><a href="fixed-income-securities.html#cb9771-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;goldenrod&quot;</span>, <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9771-8"><a href="fixed-income-securities.html#cb9771-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> df_sven<span class="sc">$</span>Maturity, <span class="at">y =</span> df_sven<span class="sc">$</span><span class="st">`</span><span class="at">Pricing Error</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&quot;lightsteelblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb9771-9"><a href="fixed-income-securities.html#cb9771-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;lightgrey&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9771-10"><a href="fixed-income-securities.html#cb9771-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Pricing Errors based on Maturity - Svenson Family&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9771-11"><a href="fixed-income-securities.html#cb9771-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Zero-Coupon Yields in %&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Maturity in Years&quot;</span>) <span class="sc">+</span></span>
<span id="cb9771-12"><a href="fixed-income-securities.html#cb9771-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9771-13"><a href="fixed-income-securities.html#cb9771-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&quot;Est. Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9771-14"><a href="fixed-income-securities.html#cb9771-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Actual Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9771-15"><a href="fixed-income-securities.html#cb9771-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9771-16"><a href="fixed-income-securities.html#cb9771-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9771-17"><a href="fixed-income-securities.html#cb9771-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">lineheight=</span><span class="fl">1.2</span>, <span class="at">margin=</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">15</span>,<span class="dv">15</span>)), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9771-18"><a href="fixed-income-securities.html#cb9771-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9771-19"><a href="fixed-income-securities.html#cb9771-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9771-20"><a href="fixed-income-securities.html#cb9771-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9771-21"><a href="fixed-income-securities.html#cb9771-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9771-22"><a href="fixed-income-securities.html#cb9771-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9771-23"><a href="fixed-income-securities.html#cb9771-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9771-24"><a href="fixed-income-securities.html#cb9771-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>)) </span></code></pre></div>
<pre><code>## Warning: Use of `df_sven$Maturity` is discouraged. Use `Maturity` instead.</code></pre>
<pre><code>## Warning: Use of `df_sven$`Pricing Error`` is discouraged. Use `Pricing Error` instead.</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-232-1.png" width="672" /></p>
<p>As we can see, the longer the maturity, the more precision is being lost with the approach. Perhaps this indicates that we should proceed to the nonparametric options.</p>
</div>
<div id="spline-based-approach" class="section level5" number="5.4.4.3.2">
<h5><span class="header-section-number">5.4.4.3.2</span> Spline-based approach</h5>
<p>We can also create a non-parametric approach in form of spline-based regressions to estimate the yield curve. Doing so, we follow one of either approaches:</p>
<p>First, the authors state that you need to preprocess the dataset in order to get the correct format</p>
<div class="sourceCode" id="cb9774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9774-1"><a href="fixed-income-securities.html#cb9774-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preprocess ot obtain long formats</span></span>
<span id="cb9774-2"><a href="fixed-income-securities.html#cb9774-2" aria-hidden="true" tabindex="-1"></a>prepro_D <span class="ot">&lt;-</span> <span class="fu">prepro_bond</span>(<span class="st">&#39;GERMANY&#39;</span>,mybonds)</span></code></pre></div>
<p>Based on this, we may now first define the number and optimal placement of knots. According to the authors, one approach is to use the rule of thumb of <span class="math inline">\(\sqrt{n}\)</span> knots. We can show you how to find the optimal amount of knots according to Darcozi et al (2015) through application of the decomposed from the prepro_D object.</p>
<p>Especially, we need to distinguish whether the square root is larger or smaller than 3.</p>
<p><strong>If &lt; 3</strong>:</p>
<ul>
<li>identify the smallest number in the first column and the largest number from the last (ncol) column from the maturity matrix rounded to the largest integer just below the results</li>
</ul>
<p><strong>If &gt; 3</strong>:</p>
<ul>
<li>the first and last knot points are defined as in previous case</li>
<li>the others between those points are computed with some helper vectors with the length of s-3</li>
</ul>
<div class="sourceCode" id="cb9775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9775-1"><a href="fixed-income-securities.html#cb9775-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In order to define the optimal knot points, we create a small function: </span></span>
<span id="cb9775-2"><a href="fixed-income-securities.html#cb9775-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9775-3"><a href="fixed-income-securities.html#cb9775-3" aria-hidden="true" tabindex="-1"></a>FI_q_spline <span class="ot">&lt;-</span> <span class="cf">function</span>(prepro_D){</span>
<span id="cb9775-4"><a href="fixed-income-securities.html#cb9775-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># First, we need to define the list with maturities matrices as well as the list with the yield-to-maturity matrices</span></span>
<span id="cb9775-5"><a href="fixed-income-securities.html#cb9775-5" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> prepro_D<span class="sc">$</span>m[[<span class="dv">1</span>]]</span>
<span id="cb9775-6"><a href="fixed-income-securities.html#cb9775-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> prepro_D<span class="sc">$</span>y[[<span class="dv">1</span>]]</span>
<span id="cb9775-7"><a href="fixed-income-securities.html#cb9775-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9775-8"><a href="fixed-income-securities.html#cb9775-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Based on that, we now need to distinguish whether the resulting square root is less or larger than three. Depending on this, we need to use different functions. </span></span>
<span id="cb9775-9"><a href="fixed-income-securities.html#cb9775-9" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(m)</span>
<span id="cb9775-10"><a href="fixed-income-securities.html#cb9775-10" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sqrt</span>(n))</span>
<span id="cb9775-11"><a href="fixed-income-securities.html#cb9775-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9775-12"><a href="fixed-income-securities.html#cb9775-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(s <span class="sc">&lt;</span> <span class="dv">3</span>){</span>
<span id="cb9775-13"><a href="fixed-income-securities.html#cb9775-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if s &lt; 3: Then, we just have the smallest first and largest last maturity which account for most of the variation</span></span>
<span id="cb9775-14"><a href="fixed-income-securities.html#cb9775-14" aria-hidden="true" tabindex="-1"></a>    q <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">floor</span>(<span class="fu">min</span>(y[, <span class="dv">1</span>])), <span class="fu">max</span>(m[, <span class="fu">ncol</span>(m)]))</span>
<span id="cb9775-15"><a href="fixed-income-securities.html#cb9775-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9775-16"><a href="fixed-income-securities.html#cb9775-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb9775-17"><a href="fixed-income-securities.html#cb9775-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if &gt; 3: Then, we define the first and last knot point identically </span></span>
<span id="cb9775-18"><a href="fixed-income-securities.html#cb9775-18" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span>(s<span class="dv">-2</span>) <span class="co"># sequence to define each knot point</span></span>
<span id="cb9775-19"><a href="fixed-income-securities.html#cb9775-19" aria-hidden="true" tabindex="-1"></a>    h <span class="ot">&lt;-</span> <span class="fu">trunc</span>(((i <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> n) <span class="sc">/</span> (s <span class="sc">-</span> <span class="dv">2</span>)) <span class="co"># indices of maturity matrix used to search other knot points</span></span>
<span id="cb9775-20"><a href="fixed-income-securities.html#cb9775-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Further, we define for the remaining knots a weighting function theta which is proportional to the difference in length between the first and last knot</span></span>
<span id="cb9775-21"><a href="fixed-income-securities.html#cb9775-21" aria-hidden="true" tabindex="-1"></a>    theta <span class="ot">&lt;-</span> ((i <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> n) <span class="sc">/</span> (s <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">-</span> h  <span class="co"># theta is used as a weight</span></span>
<span id="cb9775-22"><a href="fixed-income-securities.html#cb9775-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9775-23"><a href="fixed-income-securities.html#cb9775-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Now, we have the indices and weights (theta) of each sequecne. Based on this, we find the highest number in each h&#39;th column of the maturity matrix and </span></span>
<span id="cb9775-24"><a href="fixed-income-securities.html#cb9775-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add the theta-weighted difference of the h+1 and h columns&#39; maximum results. </span></span>
<span id="cb9775-25"><a href="fixed-income-securities.html#cb9775-25" aria-hidden="true" tabindex="-1"></a>    highest_vola_cluster <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">as.matrix</span>(m[, h]), <span class="dv">2</span>, max) <span class="sc">+</span> theta <span class="sc">*</span> (<span class="fu">apply</span>(<span class="fu">as.matrix</span>(m[, h <span class="sc">+</span> <span class="dv">1</span>]), <span class="dv">2</span>, max) <span class="sc">-</span> <span class="fu">apply</span>(<span class="fu">as.matrix</span>(m[, h]), <span class="dv">2</span>, max))</span>
<span id="cb9775-26"><a href="fixed-income-securities.html#cb9775-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9775-27"><a href="fixed-income-securities.html#cb9775-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Having identified the optimal knot points, we concatenate the values</span></span>
<span id="cb9775-28"><a href="fixed-income-securities.html#cb9775-28" aria-hidden="true" tabindex="-1"></a>    q <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">floor</span>(<span class="fu">min</span>(y[, <span class="dv">1</span>])), highest_vola_cluster, <span class="fu">max</span>(m[, <span class="fu">ncol</span>(m)]))</span>
<span id="cb9775-29"><a href="fixed-income-securities.html#cb9775-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9775-30"><a href="fixed-income-securities.html#cb9775-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(q)</span>
<span id="cb9775-31"><a href="fixed-income-securities.html#cb9775-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9775-32"><a href="fixed-income-securities.html#cb9775-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9775-33"><a href="fixed-income-securities.html#cb9775-33" aria-hidden="true" tabindex="-1"></a><span class="fu">FI_q_spline</span>(prepro_D)</span></code></pre></div>
<pre><code>##              DE0001135101 DE0001141463 DE0001135218 DE0001135317              
##     0.000000     1.006027     2.380274     5.033425     9.234521    31.446575</code></pre>
<p>Great, we were able to define the exact knots in the maturity. FYI, you can also do this with the following command:</p>
<div class="sourceCode" id="cb9777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9777-1"><a href="fixed-income-securities.html#cb9777-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">estim_cs</span>(govbonds, <span class="st">&#39;GERMANY&#39;</span>)</span>
<span id="cb9777-2"><a href="fixed-income-securities.html#cb9777-2" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>knotpoints[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>##              DE0001135101 DE0001141463 DE0001135218 DE0001135317              
##     0.000000     1.006027     2.380274     5.033425     9.234521    31.446575</code></pre>
<p>Based on this, we can now create the functional form of the spline. This is achieved using the following commands.</p>
<div class="sourceCode" id="cb9779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9779-1"><a href="fixed-income-securities.html#cb9779-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get Regression output</span></span>
<span id="cb9779-2"><a href="fixed-income-securities.html#cb9779-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(x<span class="sc">$</span>regout, <span class="at">type =</span> <span class="st">&quot;text&quot;</span>, <span class="at">digits =</span> <span class="dv">7</span>)</span></code></pre></div>
<pre><code>## 
## ===================================================
##                           Dependent variable:      
##                     -------------------------------
##                                 -Y[[k]]            
## ---------------------------------------------------
## X[[k]]1                        0.0193198           
##                               (0.0152297)          
##                                                    
## X[[k]]2                       -0.0000849           
##                               (0.0037926)          
##                                                    
## X[[k]]3                       -0.0003201           
##                               (0.0011359)          
##                                                    
## X[[k]]4                       -0.0003710           
##                               (0.0003907)          
##                                                    
## X[[k]]5                      0.0007292***          
##                               (0.0000996)          
##                                                    
## X[[k]]6                      0.0020159***          
##                               (0.0001302)          
##                                                    
## X[[k]]7                      -0.0416319***         
##                               (0.0045903)          
##                                                    
## ---------------------------------------------------
## Observations                      52               
## R2                             0.9999834           
## Adjusted R2                    0.9999808           
## Residual Std. Error       0.2134597 (df = 45)      
## F Statistic         386,765.0000000*** (df = 7; 45)
## ===================================================
## Note:                   *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
<div class="sourceCode" id="cb9781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9781-1"><a href="fixed-income-securities.html#cb9781-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get RMSE</span></span>
<span id="cb9781-2"><a href="fixed-income-securities.html#cb9781-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">sum</span>((x<span class="sc">$</span>p<span class="sc">$</span>GERMANY <span class="sc">-</span> x<span class="sc">$</span>phat<span class="sc">$</span>GERMANY)<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 1.431931</code></pre>
<p>As we can see, this is thus far the most precise function. Let’s plot it:</p>
<div class="sourceCode" id="cb9783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9783-1"><a href="fixed-income-securities.html#cb9783-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, we can also plot the relationship</span></span>
<span id="cb9783-2"><a href="fixed-income-securities.html#cb9783-2" aria-hidden="true" tabindex="-1"></a><span class="do">## First, the actual observations</span></span>
<span id="cb9783-3"><a href="fixed-income-securities.html#cb9783-3" aria-hidden="true" tabindex="-1"></a>actual_FI <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(x<span class="sc">$</span>y<span class="sc">$</span>GERMANY)</span>
<span id="cb9783-4"><a href="fixed-income-securities.html#cb9783-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(actual_FI) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Maturity&quot;</span>, <span class="st">&quot;Yield_Actual&quot;</span>)</span>
<span id="cb9783-5"><a href="fixed-income-securities.html#cb9783-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Now the estimated ones </span></span>
<span id="cb9783-6"><a href="fixed-income-securities.html#cb9783-6" aria-hidden="true" tabindex="-1"></a>est_FI <span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(x<span class="sc">$</span>yhat<span class="sc">$</span>GERMANY)</span>
<span id="cb9783-7"><a href="fixed-income-securities.html#cb9783-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(est_FI) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Maturity&quot;</span>, <span class="st">&quot;Yield_Estimated&quot;</span>)</span>
<span id="cb9783-8"><a href="fixed-income-securities.html#cb9783-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Bind them together</span></span>
<span id="cb9783-9"><a href="fixed-income-securities.html#cb9783-9" aria-hidden="true" tabindex="-1"></a>est_act_FI <span class="ot">&lt;-</span> <span class="fu">left_join</span>(actual_FI, est_FI, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Maturity&quot;</span> <span class="ot">=</span> <span class="st">&quot;Maturity&quot;</span>))</span>
<span id="cb9783-10"><a href="fixed-income-securities.html#cb9783-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the confidence interval surrounding the estimated yields </span></span>
<span id="cb9783-11"><a href="fixed-income-securities.html#cb9783-11" aria-hidden="true" tabindex="-1"></a>est_act_FI_final <span class="ot">&lt;-</span> est_act_FI <span class="sc">%&gt;%</span> </span>
<span id="cb9783-12"><a href="fixed-income-securities.html#cb9783-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9783-13"><a href="fixed-income-securities.html#cb9783-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Yield_Estimated =</span> <span class="dv">100</span><span class="sc">*</span>Yield_Estimated,</span>
<span id="cb9783-14"><a href="fixed-income-securities.html#cb9783-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Yield_Actual =</span> <span class="dv">100</span><span class="sc">*</span>Yield_Actual,</span>
<span id="cb9783-15"><a href="fixed-income-securities.html#cb9783-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">std_yield =</span> <span class="fu">sd</span>(Yield_Estimated), </span>
<span id="cb9783-16"><a href="fixed-income-securities.html#cb9783-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_obs =</span> <span class="fu">length</span>(Yield_Estimated), </span>
<span id="cb9783-17"><a href="fixed-income-securities.html#cb9783-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">error =</span>  <span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span>std_yield<span class="sc">/</span><span class="fu">sqrt</span>(n_obs), </span>
<span id="cb9783-18"><a href="fixed-income-securities.html#cb9783-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_up =</span> Yield_Estimated <span class="sc">+</span> error,</span>
<span id="cb9783-19"><a href="fixed-income-securities.html#cb9783-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_down =</span> Yield_Estimated <span class="sc">-</span> error) <span class="sc">%&gt;%</span> </span>
<span id="cb9783-20"><a href="fixed-income-securities.html#cb9783-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Maturity, Yield_Estimated, Yield_Actual, CI_up, CI_down)</span>
<span id="cb9783-21"><a href="fixed-income-securities.html#cb9783-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9783-22"><a href="fixed-income-securities.html#cb9783-22" aria-hidden="true" tabindex="-1"></a>est_act_FI_final <span class="sc">%&gt;%</span> </span>
<span id="cb9783-23"><a href="fixed-income-securities.html#cb9783-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Maturity, <span class="at">y =</span> Yield_Actual)) <span class="sc">+</span> </span>
<span id="cb9783-24"><a href="fixed-income-securities.html#cb9783-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;goldenrod&quot;</span>, <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9783-25"><a href="fixed-income-securities.html#cb9783-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> est_act_FI_final<span class="sc">$</span>Maturity, <span class="at">y =</span> est_act_FI_final<span class="sc">$</span>Yield_Estimated)) <span class="sc">+</span> </span>
<span id="cb9783-26"><a href="fixed-income-securities.html#cb9783-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> est_act_FI_final<span class="sc">$</span>CI_up, <span class="at">ymin =</span> est_act_FI_final<span class="sc">$</span>CI_down), <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb9783-27"><a href="fixed-income-securities.html#cb9783-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> x<span class="sc">$</span>knotpoints[[<span class="dv">1</span>]], <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;lightgrey&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9783-28"><a href="fixed-income-securities.html#cb9783-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">3</span>, <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb9783-29"><a href="fixed-income-securities.html#cb9783-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Yield Curve Estimation w/ Regression Splines for German Government Bonds&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9783-30"><a href="fixed-income-securities.html#cb9783-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Zero-Coupon Yields in %&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Maturity in Years&quot;</span>) <span class="sc">+</span></span>
<span id="cb9783-31"><a href="fixed-income-securities.html#cb9783-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&quot;Est. Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9783-32"><a href="fixed-income-securities.html#cb9783-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Actual Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9783-33"><a href="fixed-income-securities.html#cb9783-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9783-34"><a href="fixed-income-securities.html#cb9783-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9783-35"><a href="fixed-income-securities.html#cb9783-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">lineheight=</span><span class="fl">1.2</span>, <span class="at">margin=</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">15</span>,<span class="dv">15</span>)), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9783-36"><a href="fixed-income-securities.html#cb9783-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9783-37"><a href="fixed-income-securities.html#cb9783-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9783-38"><a href="fixed-income-securities.html#cb9783-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9783-39"><a href="fixed-income-securities.html#cb9783-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9783-40"><a href="fixed-income-securities.html#cb9783-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9783-41"><a href="fixed-income-securities.html#cb9783-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9783-42"><a href="fixed-income-securities.html#cb9783-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>)) </span></code></pre></div>
<pre><code>## Warning: Use of `est_act_FI_final$Maturity` is discouraged. Use `Maturity` instead.</code></pre>
<pre><code>## Warning: Use of `est_act_FI_final$Yield_Estimated` is discouraged. Use `Yield_Estimated` instead.</code></pre>
<pre><code>## Warning: Use of `est_act_FI_final$CI_up` is discouraged. Use `CI_up` instead.</code></pre>
<pre><code>## Warning: Use of `est_act_FI_final$CI_down` is discouraged. Use `CI_down` instead.</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-237-1.png" width="672" /></p>
<p>Great, we were able to depict the actual yield curve with the usual functional form of the cubic splines.</p>
<p>Let’s plot the error margins again:</p>
<div class="sourceCode" id="cb9788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9788-1"><a href="fixed-income-securities.html#cb9788-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Do this solely for the svenson</span></span>
<span id="cb9788-2"><a href="fixed-income-securities.html#cb9788-2" aria-hidden="true" tabindex="-1"></a>df_cs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(x<span class="sc">$</span>perrors<span class="sc">$</span>GERMANY[,<span class="dv">1</span>], x<span class="sc">$</span>perrors<span class="sc">$</span>GERMANY[,<span class="dv">2</span>]))</span>
<span id="cb9788-3"><a href="fixed-income-securities.html#cb9788-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_cs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Maturity&quot;</span>, <span class="st">&quot;Pricing Error&quot;</span>)</span>
<span id="cb9788-4"><a href="fixed-income-securities.html#cb9788-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9788-5"><a href="fixed-income-securities.html#cb9788-5" aria-hidden="true" tabindex="-1"></a>df_cs <span class="sc">%&gt;%</span> </span>
<span id="cb9788-6"><a href="fixed-income-securities.html#cb9788-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Maturity, <span class="at">y =</span> <span class="st">`</span><span class="at">Pricing Error</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb9788-7"><a href="fixed-income-securities.html#cb9788-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;goldenrod&quot;</span>, <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9788-8"><a href="fixed-income-securities.html#cb9788-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> df_cs<span class="sc">$</span>Maturity, <span class="at">y =</span> df_cs<span class="sc">$</span><span class="st">`</span><span class="at">Pricing Error</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&quot;lightsteelblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb9788-9"><a href="fixed-income-securities.html#cb9788-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;lightgrey&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9788-10"><a href="fixed-income-securities.html#cb9788-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Pricing Errors based on Maturity - Svenson Family&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9788-11"><a href="fixed-income-securities.html#cb9788-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Zero-Coupon Yields in %&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Maturity in Years&quot;</span>) <span class="sc">+</span></span>
<span id="cb9788-12"><a href="fixed-income-securities.html#cb9788-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9788-13"><a href="fixed-income-securities.html#cb9788-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&quot;Est. Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9788-14"><a href="fixed-income-securities.html#cb9788-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Actual Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9788-15"><a href="fixed-income-securities.html#cb9788-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9788-16"><a href="fixed-income-securities.html#cb9788-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9788-17"><a href="fixed-income-securities.html#cb9788-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">lineheight=</span><span class="fl">1.2</span>, <span class="at">margin=</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">15</span>,<span class="dv">15</span>)), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9788-18"><a href="fixed-income-securities.html#cb9788-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9788-19"><a href="fixed-income-securities.html#cb9788-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9788-20"><a href="fixed-income-securities.html#cb9788-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9788-21"><a href="fixed-income-securities.html#cb9788-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9788-22"><a href="fixed-income-securities.html#cb9788-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9788-23"><a href="fixed-income-securities.html#cb9788-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9788-24"><a href="fixed-income-securities.html#cb9788-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>)) </span></code></pre></div>
<pre><code>## Warning: Use of `df_cs$Maturity` is discouraged. Use `Maturity` instead.</code></pre>
<pre><code>## Warning: Use of `df_cs$`Pricing Error`` is discouraged. Use `Pricing Error` instead.</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-238-1.png" width="672" /></p>
<p>As we can see, the error margins have been reduced. This was to be expected, given the improved overall fit.</p>
<p>Lastly, we can also plot the actual regression output</p>
<div class="sourceCode" id="cb9791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9791-1"><a href="fixed-income-securities.html#cb9791-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get Regression output</span></span>
<span id="cb9791-2"><a href="fixed-income-securities.html#cb9791-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(x<span class="sc">$</span>regout, <span class="at">type =</span> <span class="st">&quot;text&quot;</span>, <span class="at">digits =</span> <span class="dv">7</span>)</span></code></pre></div>
<pre><code>## 
## ===================================================
##                           Dependent variable:      
##                     -------------------------------
##                                 -Y[[k]]            
## ---------------------------------------------------
## X[[k]]1                        0.0193198           
##                               (0.0152297)          
##                                                    
## X[[k]]2                       -0.0000849           
##                               (0.0037926)          
##                                                    
## X[[k]]3                       -0.0003201           
##                               (0.0011359)          
##                                                    
## X[[k]]4                       -0.0003710           
##                               (0.0003907)          
##                                                    
## X[[k]]5                      0.0007292***          
##                               (0.0000996)          
##                                                    
## X[[k]]6                      0.0020159***          
##                               (0.0001302)          
##                                                    
## X[[k]]7                      -0.0416319***         
##                               (0.0045903)          
##                                                    
## ---------------------------------------------------
## Observations                      52               
## R2                             0.9999834           
## Adjusted R2                    0.9999808           
## Residual Std. Error       0.2134597 (df = 45)      
## F Statistic         386,765.0000000*** (df = 7; 45)
## ===================================================
## Note:                   *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
<p>Further, we can plot the discount and forward curves from the x object using the following commands:</p>
<div class="sourceCode" id="cb9793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9793-1"><a href="fixed-income-securities.html#cb9793-1" aria-hidden="true" tabindex="-1"></a>discount_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(x<span class="sc">$</span>discount<span class="sc">$</span>GERMANY[,<span class="dv">1</span>], x<span class="sc">$</span>discount<span class="sc">$</span>GERMANY[,<span class="dv">2</span>]))</span>
<span id="cb9793-2"><a href="fixed-income-securities.html#cb9793-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(discount_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Maturity&quot;</span>, <span class="st">&quot;Discount_Factor&quot;</span>)</span>
<span id="cb9793-3"><a href="fixed-income-securities.html#cb9793-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9793-4"><a href="fixed-income-securities.html#cb9793-4" aria-hidden="true" tabindex="-1"></a>fwd_rate_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(x<span class="sc">$</span>forward<span class="sc">$</span>GERMANY[,<span class="dv">1</span>], x<span class="sc">$</span>forward<span class="sc">$</span>GERMANY[,<span class="dv">2</span>]))</span>
<span id="cb9793-5"><a href="fixed-income-securities.html#cb9793-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(fwd_rate_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Maturity&quot;</span>, <span class="st">&quot;Fwd_Rate&quot;</span>)</span>
<span id="cb9793-6"><a href="fixed-income-securities.html#cb9793-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9793-7"><a href="fixed-income-securities.html#cb9793-7" aria-hidden="true" tabindex="-1"></a>disc_gg <span class="ot">&lt;-</span> discount_df <span class="sc">%&gt;%</span> </span>
<span id="cb9793-8"><a href="fixed-income-securities.html#cb9793-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Discount_Factor =</span> <span class="dv">100</span><span class="sc">*</span>Discount_Factor) <span class="sc">%&gt;%</span> </span>
<span id="cb9793-9"><a href="fixed-income-securities.html#cb9793-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Maturity, <span class="at">y =</span> Discount_Factor)) <span class="sc">+</span> </span>
<span id="cb9793-10"><a href="fixed-income-securities.html#cb9793-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;lightsteelblue3&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9793-11"><a href="fixed-income-securities.html#cb9793-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Discount Factor based on Maturity for German Government Bond&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9793-12"><a href="fixed-income-securities.html#cb9793-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Discount Factor in %&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Maturity in Years&quot;</span>) <span class="sc">+</span></span>
<span id="cb9793-13"><a href="fixed-income-securities.html#cb9793-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&quot;Est. Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9793-14"><a href="fixed-income-securities.html#cb9793-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Actual Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9793-15"><a href="fixed-income-securities.html#cb9793-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9793-16"><a href="fixed-income-securities.html#cb9793-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9793-17"><a href="fixed-income-securities.html#cb9793-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">lineheight=</span><span class="fl">1.2</span>, <span class="at">margin=</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">15</span>,<span class="dv">15</span>)), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9793-18"><a href="fixed-income-securities.html#cb9793-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9793-19"><a href="fixed-income-securities.html#cb9793-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9793-20"><a href="fixed-income-securities.html#cb9793-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9793-21"><a href="fixed-income-securities.html#cb9793-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9793-22"><a href="fixed-income-securities.html#cb9793-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9793-23"><a href="fixed-income-securities.html#cb9793-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9793-24"><a href="fixed-income-securities.html#cb9793-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>)) </span>
<span id="cb9793-25"><a href="fixed-income-securities.html#cb9793-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9793-26"><a href="fixed-income-securities.html#cb9793-26" aria-hidden="true" tabindex="-1"></a>disc_gg</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-240-1.png" width="672" /></p>
<div class="sourceCode" id="cb9794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9794-1"><a href="fixed-income-securities.html#cb9794-1" aria-hidden="true" tabindex="-1"></a>fwd_gg <span class="ot">&lt;-</span> fwd_rate_df <span class="sc">%&gt;%</span> </span>
<span id="cb9794-2"><a href="fixed-income-securities.html#cb9794-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Discount_Factor =</span> <span class="dv">100</span><span class="sc">*</span>Fwd_Rate) <span class="sc">%&gt;%</span> </span>
<span id="cb9794-3"><a href="fixed-income-securities.html#cb9794-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Maturity, <span class="at">y =</span> Discount_Factor)) <span class="sc">+</span> </span>
<span id="cb9794-4"><a href="fixed-income-securities.html#cb9794-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;darkgreen&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9794-5"><a href="fixed-income-securities.html#cb9794-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Discount Factor based on Maturity for German Government Bond&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9794-6"><a href="fixed-income-securities.html#cb9794-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Forward Rate in %&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Maturity in Years&quot;</span>) <span class="sc">+</span></span>
<span id="cb9794-7"><a href="fixed-income-securities.html#cb9794-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&quot;Est. Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9794-8"><a href="fixed-income-securities.html#cb9794-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&quot;Actual Variables&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightgrey&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9794-9"><a href="fixed-income-securities.html#cb9794-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9794-10"><a href="fixed-income-securities.html#cb9794-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9794-11"><a href="fixed-income-securities.html#cb9794-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">lineheight=</span><span class="fl">1.2</span>, <span class="at">margin=</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">15</span>,<span class="dv">15</span>)), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9794-12"><a href="fixed-income-securities.html#cb9794-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9794-13"><a href="fixed-income-securities.html#cb9794-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9794-14"><a href="fixed-income-securities.html#cb9794-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9794-15"><a href="fixed-income-securities.html#cb9794-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9794-16"><a href="fixed-income-securities.html#cb9794-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9794-17"><a href="fixed-income-securities.html#cb9794-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9794-18"><a href="fixed-income-securities.html#cb9794-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="fl">0.3</span>,<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>)) </span>
<span id="cb9794-19"><a href="fixed-income-securities.html#cb9794-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9794-20"><a href="fixed-income-securities.html#cb9794-20" aria-hidden="true" tabindex="-1"></a>fwd_gg</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-241-1.png" width="672" /></p>
<p>Thus, we can conclude that the non-parametric approach delivers the best results and also provides logical forward as well as discount rates. Consequently, we can use this approach for the estimation of the term structure.</p>
<p>Great. We now have encountered the most wide-spread functions to estimate term structures. We showed how to create datasets that fit the functional model well, how to check for the error distribution, which variables to consider when choosing starting parameters and how to plot both the yield curve, spot rate and discount rate curve as well as how to measure the goodness of fit for yield curves.</p>
</div>
</div>
</div>
<div id="sensitivity-of-the-price-to-yield-duration-and-convexity" class="section level3" number="5.4.5">
<h3><span class="header-section-number">5.4.5</span> Sensitivity of the Price to Yield: Duration and Convexity</h3>
<p>As we mentioned, bond prices have roughly three underlying forms of risk. While the first two can be handled by bond selection itself (at least this is the assumption thus far), market risk is something that can be considered a calculatable risk as we can derive formulas which proxy said risk. In general, market risk arises from the <strong>changes in interest rates</strong> (= the yield (YTM)), which causes reinvestment risk and liquidation risk. The market price impact on a bond due to a change in interest rates is measured by examining the <strong>price of a bond as a function of its YTM</strong>. Fixed income instruments are sensitive to changes in interest rates. As such, managing interest rate risk is an important consideration when dealing with fixed income portfolios. <strong>Duration and convexity</strong> are two techniques that help investors immunize against small changes in interest rates. The idea behind <strong>duration</strong> is that it estimates the <strong>impact of small changes in interest rates</strong> on the value of the fixed income instrument, and the idea behind <strong>convexity</strong> is to enhance this estimate by also <strong>considering the impact of the rate of the change in interest rates.</strong></p>
<p>From basic calculus we understand outcome that the change of an underlying w.r.t. a given variable in a function can be obtained by taking the derivative of said function w.r.t. said variable. As such, if we do so, we obtain the <strong>percentage change of the bond price caused by a <span class="math inline">\(\triangle y\)</span> change in its yield</strong>. This is also known as <strong>Macaulay Duration</strong>. We derive the duration as first order approximation for small changes in the underlying characteristic.</p>
<p>The Macaulay duration can be interpreted as the <strong>weighted-average time to maturity of the bond</strong>. It is given as:</p>
<p><span class="math display">\[
MacD = \sum_{i=0}^Tt_t\frac{CF_t/(1+y)^i}{P}
\]</span></p>
<p>whereas <span class="math inline">\(t_t\)</span> is the Cash-Flow period, <span class="math inline">\(CF_t\)</span> is the present value of the period t cash flows, discounted to obtain the PV, and Price is the price of the bond and P is the market price of the bond.</p>
<p>Modified duration adjusts Macaulay duration by considering the <strong>yield of the bond</strong>. Note that the formula just gives the change in relation to the given yield change. As such, we just take the change of the bond price w.r.t. changes in yield <em>relative</em> to a one unit change in the yield. In essence, it gives the <strong>price sensitivity of the bond</strong> measured as the <strong>percentage change in price for a given change in the yield</strong>. It is calculated as:</p>
<p><span class="math display">\[
ModD = \frac{MacD}{1+y_T/k}
\]</span></p>
<p>Consequently, it provides the sensitivity relative to the change in yield. This pricing formula marks clearly the inverse relationship of price and yield. Since the duration relates the change in YTM to the associated change in its price (and thus serves as a proxy for price movements), it is a clear measure of the bond’s <strong>interest rate risk</strong>.</p>
<p>Building on this, the <strong>convexity</strong> is just the second order approximation of the relation of bond prices and its underlying yield. That is, it is the second derivative w.r.t. y or the quadratic approximation of the underlying function. Consequently, the function is given as:</p>
<p><span class="math display">\[
Convexity = \frac{1}{P}\frac{1}{(1+y)^2}\sum_{i=0}^T \frac{CF_t(t^2+t)}{(1+y)^i}
\]</span></p>
<p>Let’s now dig a little bit deeper and calculate both duration and convexity for a fictional example. Doing so, we will also calculate the value of the bond. We say that we have:</p>
<ul>
<li>C = 50.75</li>
<li>Ti = 10</li>
<li>r = 0.01391</li>
<li>N = 1000</li>
<li>k = 4</li>
</ul>
<div class="sourceCode" id="cb9795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9795-1"><a href="fixed-income-securities.html#cb9795-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame</span></span>
<span id="cb9795-2"><a href="fixed-income-securities.html#cb9795-2" aria-hidden="true" tabindex="-1"></a>mv <span class="ot">=</span> <span class="fu">market_value</span>(<span class="dv">11</span>, <span class="fl">0.0575</span>, <span class="fl">0.01391</span>, <span class="dv">1000</span>, <span class="dv">2</span>)</span>
<span id="cb9795-3"><a href="fixed-income-securities.html#cb9795-3" aria-hidden="true" tabindex="-1"></a>mv</span></code></pre></div>
<pre><code>## [1] 1443.184</code></pre>
<p>As such, we obtain a bond value of 1443.184. In order to now calculate both duration and convexity, we first create a manual approach:</p>
<div class="sourceCode" id="cb9797"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9797-1"><a href="fixed-income-securities.html#cb9797-1" aria-hidden="true" tabindex="-1"></a>Ti <span class="ot">=</span> <span class="dv">11</span></span>
<span id="cb9797-2"><a href="fixed-income-securities.html#cb9797-2" aria-hidden="true" tabindex="-1"></a>C <span class="ot">=</span> <span class="fl">0.0575</span></span>
<span id="cb9797-3"><a href="fixed-income-securities.html#cb9797-3" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="fl">0.01391</span></span>
<span id="cb9797-4"><a href="fixed-income-securities.html#cb9797-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb9797-5"><a href="fixed-income-securities.html#cb9797-5" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb9797-6"><a href="fixed-income-securities.html#cb9797-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9797-7"><a href="fixed-income-securities.html#cb9797-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the manual CFs</span></span>
<span id="cb9797-8"><a href="fixed-income-securities.html#cb9797-8" aria-hidden="true" tabindex="-1"></a>period <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, k<span class="sc">*</span>Ti, <span class="dv">1</span>)</span>
<span id="cb9797-9"><a href="fixed-income-securities.html#cb9797-9" aria-hidden="true" tabindex="-1"></a>cf <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(C<span class="sc">/</span>k, k<span class="sc">*</span>Ti<span class="dv">-1</span>), C<span class="sc">/</span>k<span class="sc">+</span>N)</span>
<span id="cb9797-10"><a href="fixed-income-securities.html#cb9797-10" aria-hidden="true" tabindex="-1"></a>cf_PV <span class="ot">&lt;-</span>  cf<span class="sc">/</span> ((<span class="dv">1</span> <span class="sc">+</span> r <span class="sc">/</span> k)<span class="sc">^</span>(<span class="sc">-</span>period))</span>
<span id="cb9797-11"><a href="fixed-income-securities.html#cb9797-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9797-12"><a href="fixed-income-securities.html#cb9797-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the duration</span></span>
<span id="cb9797-13"><a href="fixed-income-securities.html#cb9797-13" aria-hidden="true" tabindex="-1"></a>dur <span class="ot">&lt;-</span> period <span class="sc">*</span> cf_PV<span class="sc">/</span>mv</span>
<span id="cb9797-14"><a href="fixed-income-securities.html#cb9797-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9797-15"><a href="fixed-income-securities.html#cb9797-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate MacD:</span></span>
<span id="cb9797-16"><a href="fixed-income-securities.html#cb9797-16" aria-hidden="true" tabindex="-1"></a>MacD <span class="ot">&lt;-</span> <span class="fu">sum</span>(dur<span class="sc">/</span>k)</span>
<span id="cb9797-17"><a href="fixed-income-securities.html#cb9797-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9797-18"><a href="fixed-income-securities.html#cb9797-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate ModD:</span></span>
<span id="cb9797-19"><a href="fixed-income-securities.html#cb9797-19" aria-hidden="true" tabindex="-1"></a>ModD <span class="ot">&lt;-</span> MacD<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>r<span class="sc">/</span>k)</span>
<span id="cb9797-20"><a href="fixed-income-securities.html#cb9797-20" aria-hidden="true" tabindex="-1"></a>ModD</span></code></pre></div>
<pre><code>## [1] 8.818999</code></pre>
<p>To calculate the convexity now, we construct the variables c1 and c2, where:</p>
<ul>
<li>c1 = <span class="math inline">\((t^2 + t)CF\)</span></li>
<li>c2 = <span class="math inline">\(P(1+r/k)^2\)</span></li>
</ul>
<p>Then, we calculate the period convexity adjustment as:</p>
<ul>
<li>Conv = <span class="math inline">\(c1\times PV-Adj / c2\)</span></li>
</ul>
<div class="sourceCode" id="cb9799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9799-1"><a href="fixed-income-securities.html#cb9799-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the convexity</span></span>
<span id="cb9799-2"><a href="fixed-income-securities.html#cb9799-2" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">=</span> (period<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> period)<span class="sc">*</span>cf</span>
<span id="cb9799-3"><a href="fixed-income-securities.html#cb9799-3" aria-hidden="true" tabindex="-1"></a>c2 <span class="ot">=</span> mv<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">+</span> r <span class="sc">/</span> k)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb9799-4"><a href="fixed-income-securities.html#cb9799-4" aria-hidden="true" tabindex="-1"></a>conv <span class="ot">=</span> c1 <span class="sc">*</span> <span class="dv">1</span><span class="sc">/</span>((<span class="dv">1</span> <span class="sc">+</span> r <span class="sc">/</span> k)<span class="sc">^</span>(<span class="sc">-</span>period)) <span class="sc">/</span> c2</span>
<span id="cb9799-5"><a href="fixed-income-securities.html#cb9799-5" aria-hidden="true" tabindex="-1"></a>convexity <span class="ot">=</span> <span class="fu">sum</span>(conv)</span>
<span id="cb9799-6"><a href="fixed-income-securities.html#cb9799-6" aria-hidden="true" tabindex="-1"></a>convexity</span></code></pre></div>
<pre><code>## [1] 402.8344</code></pre>
<p>We can now estimate the bond prices based on both the duration as well as the convexity. This is done using the following formulas. For the Duration we get:</p>
<p><span class="math display">\[
\triangle P = -D \times \triangle y \times P
\]</span></p>
<p>whereas the change in bond price is a function of the modified duration (which quantifies the <strong>impact of small changes in interest rates</strong> on the value of the fixed income instrument), the change in yield and the current bond price. This is intuitive as we obtain that the change in price depends on the change in yield as well as the duration, which measures the sensitivity related to the yield. Let’s now assume we increase the yield by 100 BP</p>
<div class="sourceCode" id="cb9801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9801-1"><a href="fixed-income-securities.html#cb9801-1" aria-hidden="true" tabindex="-1"></a>delta_y <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb9801-2"><a href="fixed-income-securities.html#cb9801-2" aria-hidden="true" tabindex="-1"></a>delta_P <span class="ot">&lt;-</span> <span class="sc">-</span>ModD<span class="sc">*</span>delta_y<span class="sc">*</span>mv</span>
<span id="cb9801-3"><a href="fixed-income-securities.html#cb9801-3" aria-hidden="true" tabindex="-1"></a>P_new <span class="ot">&lt;-</span> delta_P <span class="sc">+</span> mv</span>
<span id="cb9801-4"><a href="fixed-income-securities.html#cb9801-4" aria-hidden="true" tabindex="-1"></a>P_new</span></code></pre></div>
<pre><code>## [1] 1315.909</code></pre>
<p>We can also estimate the price changes using convexity. This is given by the formula:</p>
<p><span class="math display">\[
\triangle P = P\times [(-D \times \triangle y) + 0.5 \times C \times (\triangle y)^2]
\]</span></p>
<p>where C is the Convexity and the other terms are the same as defined above for duration.</p>
<div class="sourceCode" id="cb9803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9803-1"><a href="fixed-income-securities.html#cb9803-1" aria-hidden="true" tabindex="-1"></a>delta_P_C <span class="ot">&lt;-</span> mv<span class="sc">*</span>((<span class="sc">-</span>ModD<span class="sc">*</span>delta_y) <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>convexity<span class="sc">*</span>delta_y<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb9803-2"><a href="fixed-income-securities.html#cb9803-2" aria-hidden="true" tabindex="-1"></a>P_new_C <span class="ot">&lt;-</span> delta_P_C <span class="sc">+</span> mv</span>
<span id="cb9803-3"><a href="fixed-income-securities.html#cb9803-3" aria-hidden="true" tabindex="-1"></a>P_new_C</span></code></pre></div>
<pre><code>## [1] 1344.977</code></pre>
<p>We can now finally compare the results of the estimated bond prices and actual bond prices. For that, we just add the yield change into the formula above.</p>
<div class="sourceCode" id="cb9805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9805-1"><a href="fixed-income-securities.html#cb9805-1" aria-hidden="true" tabindex="-1"></a><span class="fu">market_value</span>(<span class="dv">11</span>, <span class="fl">0.0575</span>, <span class="fl">0.01391</span> <span class="sc">+</span> delta_y, <span class="dv">1000</span>, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 1323.208</code></pre>
<p>The full valuation estimates the bond price is 1323, which is in between our estimated price change based on duration only and duration plus convexity.</p>
<p>Since we now understand how the duration and convexity work, we can start to create <strong>functions based on them</strong>:</p>
<div class="sourceCode" id="cb9807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9807-1"><a href="fixed-income-securities.html#cb9807-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the standard pricing</span></span>
<span id="cb9807-2"><a href="fixed-income-securities.html#cb9807-2" aria-hidden="true" tabindex="-1"></a>Ti <span class="ot">=</span> <span class="dv">11</span></span>
<span id="cb9807-3"><a href="fixed-income-securities.html#cb9807-3" aria-hidden="true" tabindex="-1"></a>C <span class="ot">=</span> <span class="fl">0.0575</span></span>
<span id="cb9807-4"><a href="fixed-income-securities.html#cb9807-4" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="fl">0.01391</span></span>
<span id="cb9807-5"><a href="fixed-income-securities.html#cb9807-5" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb9807-6"><a href="fixed-income-securities.html#cb9807-6" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb9807-7"><a href="fixed-income-securities.html#cb9807-7" aria-hidden="true" tabindex="-1"></a>delta_y <span class="ot">=</span> <span class="fl">0.01</span></span>
<span id="cb9807-8"><a href="fixed-income-securities.html#cb9807-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9807-9"><a href="fixed-income-securities.html#cb9807-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a duration and convexity function</span></span>
<span id="cb9807-10"><a href="fixed-income-securities.html#cb9807-10" aria-hidden="true" tabindex="-1"></a>duration_convexity <span class="ot">&lt;-</span> <span class="cf">function</span>(Ti, C, r, N, k, mv, delta_y, <span class="at">convex_opt =</span> F, <span class="at">price_change =</span> F){</span>
<span id="cb9807-11"><a href="fixed-income-securities.html#cb9807-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Baselines</span></span>
<span id="cb9807-12"><a href="fixed-income-securities.html#cb9807-12" aria-hidden="true" tabindex="-1"></a>  period <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, k<span class="sc">*</span>Ti, <span class="dv">1</span>)</span>
<span id="cb9807-13"><a href="fixed-income-securities.html#cb9807-13" aria-hidden="true" tabindex="-1"></a>  cf <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(C<span class="sc">/</span>k, k<span class="sc">*</span>Ti <span class="sc">-</span><span class="dv">1</span>), C<span class="sc">/</span>k<span class="sc">+</span>N)</span>
<span id="cb9807-14"><a href="fixed-income-securities.html#cb9807-14" aria-hidden="true" tabindex="-1"></a>  cf_PV <span class="ot">&lt;-</span>  cf<span class="sc">/</span> ((<span class="dv">1</span> <span class="sc">+</span> r <span class="sc">/</span> k)<span class="sc">^</span>(<span class="sc">-</span>period))</span>
<span id="cb9807-15"><a href="fixed-income-securities.html#cb9807-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Durations</span></span>
<span id="cb9807-16"><a href="fixed-income-securities.html#cb9807-16" aria-hidden="true" tabindex="-1"></a>  dur <span class="ot">&lt;-</span> period<span class="sc">*</span>cf_PV<span class="sc">/</span>mv</span>
<span id="cb9807-17"><a href="fixed-income-securities.html#cb9807-17" aria-hidden="true" tabindex="-1"></a>  MacD <span class="ot">&lt;-</span> <span class="fu">sum</span>(dur<span class="sc">/</span>k)</span>
<span id="cb9807-18"><a href="fixed-income-securities.html#cb9807-18" aria-hidden="true" tabindex="-1"></a>  ModD <span class="ot">&lt;-</span> MacD<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>r<span class="sc">/</span>k)</span>
<span id="cb9807-19"><a href="fixed-income-securities.html#cb9807-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convexity</span></span>
<span id="cb9807-20"><a href="fixed-income-securities.html#cb9807-20" aria-hidden="true" tabindex="-1"></a>  c1 <span class="ot">=</span> (period<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>period)<span class="sc">*</span>cf</span>
<span id="cb9807-21"><a href="fixed-income-securities.html#cb9807-21" aria-hidden="true" tabindex="-1"></a>  c2 <span class="ot">=</span> mv<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>r<span class="sc">/</span>k)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb9807-22"><a href="fixed-income-securities.html#cb9807-22" aria-hidden="true" tabindex="-1"></a>  conv <span class="ot">=</span> c1<span class="sc">*</span><span class="dv">1</span><span class="sc">/</span>((<span class="dv">1</span> <span class="sc">+</span> r <span class="sc">/</span> k)<span class="sc">^</span>(<span class="sc">-</span>period)) <span class="sc">/</span> c2</span>
<span id="cb9807-23"><a href="fixed-income-securities.html#cb9807-23" aria-hidden="true" tabindex="-1"></a>  convexity <span class="ot">=</span> <span class="fu">sum</span>(conv)</span>
<span id="cb9807-24"><a href="fixed-income-securities.html#cb9807-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the price changes </span></span>
<span id="cb9807-25"><a href="fixed-income-securities.html#cb9807-25" aria-hidden="true" tabindex="-1"></a>  Price_Dur <span class="ot">&lt;-</span> <span class="sc">-</span>ModD<span class="sc">*</span>delta_y<span class="sc">*</span>mv <span class="sc">+</span> mv</span>
<span id="cb9807-26"><a href="fixed-income-securities.html#cb9807-26" aria-hidden="true" tabindex="-1"></a>  Price_Conv <span class="ot">&lt;-</span> mv<span class="sc">*</span>((<span class="sc">-</span>ModD<span class="sc">*</span>delta_y) <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>convexity<span class="sc">*</span>delta_y<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> mv</span>
<span id="cb9807-27"><a href="fixed-income-securities.html#cb9807-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9807-28"><a href="fixed-income-securities.html#cb9807-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If statement</span></span>
<span id="cb9807-29"><a href="fixed-income-securities.html#cb9807-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(convex_opt <span class="sc">==</span> F <span class="sc">&amp;</span> price_change <span class="sc">==</span> F){</span>
<span id="cb9807-30"><a href="fixed-income-securities.html#cb9807-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(ModD)</span>
<span id="cb9807-31"><a href="fixed-income-securities.html#cb9807-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9807-32"><a href="fixed-income-securities.html#cb9807-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9807-33"><a href="fixed-income-securities.html#cb9807-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (convex_opt <span class="sc">==</span> T <span class="sc">&amp;</span> price_change <span class="sc">==</span> F){</span>
<span id="cb9807-34"><a href="fixed-income-securities.html#cb9807-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(convexity)</span>
<span id="cb9807-35"><a href="fixed-income-securities.html#cb9807-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9807-36"><a href="fixed-income-securities.html#cb9807-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9807-37"><a href="fixed-income-securities.html#cb9807-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (convex_opt <span class="sc">==</span> F <span class="sc">&amp;</span> price_change <span class="sc">==</span> T){</span>
<span id="cb9807-38"><a href="fixed-income-securities.html#cb9807-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(Price_Dur)</span>
<span id="cb9807-39"><a href="fixed-income-securities.html#cb9807-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9807-40"><a href="fixed-income-securities.html#cb9807-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9807-41"><a href="fixed-income-securities.html#cb9807-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb9807-42"><a href="fixed-income-securities.html#cb9807-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(Price_Conv)</span>
<span id="cb9807-43"><a href="fixed-income-securities.html#cb9807-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9807-44"><a href="fixed-income-securities.html#cb9807-44" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb9808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9808-1"><a href="fixed-income-securities.html#cb9808-1" aria-hidden="true" tabindex="-1"></a><span class="fu">duration_convexity</span>(Ti, C, r, N, k, mv, delta_y, <span class="at">convex_opt =</span> F, <span class="at">price_change =</span> F)</span></code></pre></div>
<pre><code>## [1] 8.818999</code></pre>
<div class="sourceCode" id="cb9810"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9810-1"><a href="fixed-income-securities.html#cb9810-1" aria-hidden="true" tabindex="-1"></a><span class="fu">duration_convexity</span>(Ti, C, r, N, k, mv, delta_y, <span class="at">convex_opt =</span> T, <span class="at">price_change =</span> F)</span></code></pre></div>
<pre><code>## [1] 402.8344</code></pre>
<p>Now, we can again calculate both estimations</p>
<div class="sourceCode" id="cb9812"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9812-1"><a href="fixed-income-securities.html#cb9812-1" aria-hidden="true" tabindex="-1"></a><span class="fu">duration_convexity</span>(Ti, C, r, N, k, mv, delta_y, <span class="at">convex_opt =</span> F, <span class="at">price_change =</span> T)</span></code></pre></div>
<pre><code>## [1] 1315.909</code></pre>
<div class="sourceCode" id="cb9814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9814-1"><a href="fixed-income-securities.html#cb9814-1" aria-hidden="true" tabindex="-1"></a><span class="fu">duration_convexity</span>(Ti, C, r, N, k, mv, delta_y, <span class="at">convex_opt =</span> T, <span class="at">price_change =</span> T)</span></code></pre></div>
<pre><code>## [1] 1344.977</code></pre>
<p>As we can see, both options deliver the identical result.</p>
</div>
<div id="price-and-yield-full-valuation-and-approximations" class="section level3" number="5.4.6">
<h3><span class="header-section-number">5.4.6</span> Price and Yield: Full Valuation and Approximations</h3>
<p>We now have figured out ways to compute the exact as well as the approximate functions to estimate the Bond Price based on the yield and other functions. In order to understand how duration and convexity stack up compared to a full valuation of the bond at different yields.</p>
<div class="sourceCode" id="cb9816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9816-1"><a href="fixed-income-securities.html#cb9816-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the standard pricing</span></span>
<span id="cb9816-2"><a href="fixed-income-securities.html#cb9816-2" aria-hidden="true" tabindex="-1"></a>Ti <span class="ot">=</span> <span class="dv">11</span></span>
<span id="cb9816-3"><a href="fixed-income-securities.html#cb9816-3" aria-hidden="true" tabindex="-1"></a>C <span class="ot">=</span> <span class="fl">0.0575</span></span>
<span id="cb9816-4"><a href="fixed-income-securities.html#cb9816-4" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="fl">0.01391</span></span>
<span id="cb9816-5"><a href="fixed-income-securities.html#cb9816-5" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb9816-6"><a href="fixed-income-securities.html#cb9816-6" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb9816-7"><a href="fixed-income-securities.html#cb9816-7" aria-hidden="true" tabindex="-1"></a>delta_y <span class="ot">=</span> <span class="fl">0.01</span></span>
<span id="cb9816-8"><a href="fixed-income-securities.html#cb9816-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9816-9"><a href="fixed-income-securities.html#cb9816-9" aria-hidden="true" tabindex="-1"></a>delta_y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.06391</span>, <span class="fl">0.05391</span>, <span class="fl">0.001</span>)</span>
<span id="cb9816-10"><a href="fixed-income-securities.html#cb9816-10" aria-hidden="true" tabindex="-1"></a>full_change <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(delta_y))</span>
<span id="cb9816-11"><a href="fixed-income-securities.html#cb9816-11" aria-hidden="true" tabindex="-1"></a>mod_D_change <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(delta_y))</span>
<span id="cb9816-12"><a href="fixed-income-securities.html#cb9816-12" aria-hidden="true" tabindex="-1"></a>conv_change <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(delta_y))</span>
<span id="cb9816-13"><a href="fixed-income-securities.html#cb9816-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9816-14"><a href="fixed-income-securities.html#cb9816-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(delta_y)){</span>
<span id="cb9816-15"><a href="fixed-income-securities.html#cb9816-15" aria-hidden="true" tabindex="-1"></a>  full_change[i] <span class="ot">&lt;-</span> <span class="fu">market_value</span>(Ti, C, r <span class="sc">+</span> delta_y[i], N, k)</span>
<span id="cb9816-16"><a href="fixed-income-securities.html#cb9816-16" aria-hidden="true" tabindex="-1"></a>  mod_D_change <span class="ot">&lt;-</span> <span class="fu">duration_convexity</span>(Ti, C, r, N, k, mv, delta_y, <span class="at">convex_opt =</span> F, <span class="at">price_change =</span> T)</span>
<span id="cb9816-17"><a href="fixed-income-securities.html#cb9816-17" aria-hidden="true" tabindex="-1"></a>  conv_change <span class="ot">&lt;-</span> <span class="fu">duration_convexity</span>(Ti, C, r, N, k, mv, delta_y, <span class="at">convex_opt =</span> T, <span class="at">price_change =</span> T)</span>
<span id="cb9816-18"><a href="fixed-income-securities.html#cb9816-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9816-19"><a href="fixed-income-securities.html#cb9816-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9816-20"><a href="fixed-income-securities.html#cb9816-20" aria-hidden="true" tabindex="-1"></a>df_yields <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(r<span class="sc">+</span>delta_y, full_change, mod_D_change, conv_change))</span>
<span id="cb9816-21"><a href="fixed-income-securities.html#cb9816-21" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_yields) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Yield&quot;</span>, <span class="st">&quot;Full Valuation Est&quot;</span>, <span class="st">&quot;Duration Est&quot;</span>, <span class="st">&quot;Dur + Convexity Est&quot;</span>)</span>
<span id="cb9816-22"><a href="fixed-income-securities.html#cb9816-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9816-23"><a href="fixed-income-securities.html#cb9816-23" aria-hidden="true" tabindex="-1"></a>df_yields <span class="sc">%&gt;%</span>  <span class="fu">gather</span>(Treasury, Return, <span class="st">`</span><span class="at">Full Valuation Est</span><span class="st">`</span><span class="sc">:</span> <span class="st">`</span><span class="at">Dur + Convexity Est</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9816-24"><a href="fixed-income-securities.html#cb9816-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Yield, <span class="at">y =</span> Return, <span class="at">color =</span> Treasury)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb9816-25"><a href="fixed-income-securities.html#cb9816-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Bond Yield Estimate w.r.t Yield - Actual, Duration and Convexity Estimates&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9816-26"><a href="fixed-income-securities.html#cb9816-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Value&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Yield&quot;</span>) <span class="sc">+</span></span>
<span id="cb9816-27"><a href="fixed-income-securities.html#cb9816-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;goldenrod&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9816-28"><a href="fixed-income-securities.html#cb9816-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;violetred4&quot;</span>, <span class="st">&quot;khaki3&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9816-29"><a href="fixed-income-securities.html#cb9816-29" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9816-30"><a href="fixed-income-securities.html#cb9816-30" aria-hidden="true" tabindex="-1"></a><span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9816-31"><a href="fixed-income-securities.html#cb9816-31" aria-hidden="true" tabindex="-1"></a><span class="at">lineheight=</span><span class="fl">1.2</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9816-32"><a href="fixed-income-securities.html#cb9816-32" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9816-33"><a href="fixed-income-securities.html#cb9816-33" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9816-34"><a href="fixed-income-securities.html#cb9816-34" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9816-35"><a href="fixed-income-securities.html#cb9816-35" aria-hidden="true" tabindex="-1"></a><span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9816-36"><a href="fixed-income-securities.html#cb9816-36" aria-hidden="true" tabindex="-1"></a><span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9816-37"><a href="fixed-income-securities.html#cb9816-37" aria-hidden="true" tabindex="-1"></a><span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span>  <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">&#39;Swiss Government Bonds&#39;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">color=</span><span class="st">&#39;Difference in Yield&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-251-1.png" width="672" /></p>
<p>Great, we now have written functions to calculate the bond price based on the parameters of interest and were able to calculate the bond price estimates based on the three most common functions. Based on them, we were able to draw an approximation of bond returns.</p>
</div>
</div>
<div id="interest-rate-derivative-models" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Interest Rate Derivative Models</h2>
<p>Lastly, we can look at financial products whose payoff and subsequent payoff depends on interest rates. These are also called <strong>Interest Rate derivative models</strong>. The basic products include interest rate swaps, forward rate agreements, callable and puttable bonds or bond options (such as CBs, which we discover in the next part).</p>
<p>In order to do so, we will look at four distinct models to price interest rate derivatives. We have already encountered models which aim at capturing term structures of interest rates, and the main ideas of these models can be transferred to the case of interest rate derivative pricing.</p>
<div id="black-model" class="section level3" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Black Model</h3>
<p>The Black model (Black, 1976) was developed to price options on futures contracts. Futures options grant the holder the right to enter into a contract at a predetermined price (denoted as strike price or exercise price, X) on a specified date (maturity, T). In this model, we keep the assumptions of the Black-Scholes model, except that the underlying is the futures price instead of the spot price. Hence, we assume that the futures price (F) follows a geometric Brownian motion:</p>
<p><span class="math display">\[
dF = \mu Fdt + \sigma FdW
\]</span></p>
<p>Black’s formula for a European futures call option is as follows:</p>
<p><span class="math display">\[
c = e^{-rT}[FN(d_1) - XN(d_2)]
\]</span></p>
<p>whereas:</p>
<p><span class="math display">\[
\begin{align}
d_1 &amp;= \frac{ln(F/X) + \frac{\sigma^2}{2}T}{\sigma\sqrt{T}}\\
d_2 &amp;= \frac{ln(F/X) - \frac{\sigma^2}{2}T}{\sigma\sqrt{T}}
\end{align}
\]</span></p>
<p>Based on this, we can also define the price of a put option as:</p>
<p><span class="math display">\[
p = e^{-rT}[XN(-d_2) - FN(-d_1)]
\]</span></p>
<p>In order to price an interest rate derivative with the Black model, we can simply use the <code>fOptions</code> package and its function called <code>GBSOption</code>, which is just the usual Black Scholes formula for the option pricing process.</p>
<div class="sourceCode" id="cb9817"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9817-1"><a href="fixed-income-securities.html#cb9817-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s quickly look at the function</span></span>
<span id="cb9817-2"><a href="fixed-income-securities.html#cb9817-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;fOptions&quot;</span>)</span></code></pre></div>
<pre><code>## 
## The downloaded binary packages are in
##  /var/folders/97/v7mhh7_10r54n7qdx4ykd6wc0000gn/T//RtmpSFmz9w/downloaded_packages</code></pre>
<div class="sourceCode" id="cb9819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9819-1"><a href="fixed-income-securities.html#cb9819-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fOptions)</span>
<span id="cb9819-2"><a href="fixed-income-securities.html#cb9819-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9819-3"><a href="fixed-income-securities.html#cb9819-3" aria-hidden="true" tabindex="-1"></a>GBSOption</span></code></pre></div>
<pre><code>## function (TypeFlag = c(&quot;c&quot;, &quot;p&quot;), S, X, Time, r, b, sigma, title = NULL, 
##     description = NULL) 
## {
##     TypeFlag = TypeFlag[1]
##     d1 = (log(S/X) + (b + sigma * sigma/2) * Time)/(sigma * sqrt(Time))
##     d2 = d1 - sigma * sqrt(Time)
##     if (TypeFlag == &quot;c&quot;) 
##         result = S * exp((b - r) * Time) * CND(d1) - X * exp(-r * 
##             Time) * CND(d2)
##     if (TypeFlag == &quot;p&quot;) 
##         result = X * exp(-r * Time) * CND(-d2) - S * exp((b - 
##             r) * Time) * CND(-d1)
##     param = list()
##     param$TypeFlag = TypeFlag
##     param$S = S
##     param$X = X
##     param$Time = Time
##     param$r = r
##     param$b = b
##     param$sigma = sigma
##     if (is.null(title)) 
##         title = &quot;Black Scholes Option Valuation&quot;
##     if (is.null(description)) 
##         description = as.character(date())
##     new(&quot;fOPTION&quot;, call = match.call(), parameters = param, price = result, 
##         title = title, description = description)
## }
## &lt;bytecode: 0x7f7e6cee3630&gt;
## &lt;environment: namespace:fOptions&gt;</code></pre>
<p>As we can see, when we want to compute <span class="math inline">\(d_1\)</span> for the European call, then we can see the importance of the parameter <strong>b</strong> in the calculation. This factor is how we can decide which model we want to use. In essence, these options are ready for b:</p>
<ul>
<li>b = r: BS Options Model</li>
<li>b = r-q: Merton’s stock option model with continuous dividend yield q (= currency option model)</li>
<li>b = 0: Black’s futures option model</li>
</ul>
<p>That’s all there is to state. We can now just take a fictional example. Let’s say we want to calculat a call with strike 120, current price 100, 5 years maturity, 5% interest, b equal to zero and sigma of 0.2</p>
<div class="sourceCode" id="cb9821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9821-1"><a href="fixed-income-securities.html#cb9821-1" aria-hidden="true" tabindex="-1"></a><span class="fu">GBSOption</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">120</span>, <span class="dv">100</span>, <span class="dv">5</span>, <span class="fl">0.05</span>, <span class="dv">0</span>, <span class="fl">0.2</span>)</span></code></pre></div>
<pre><code>## 
## Title:
##  Black Scholes Option Valuation 
## 
## Call:
##  GBSOption(TypeFlag = &quot;c&quot;, S = 120, X = 100, Time = 5, r = 0.05, 
##      b = 0, sigma = 0.2)
## 
## Parameters:
##           Value:
##  TypeFlag c     
##  S        120   
##  X        100   
##  Time     5     
##  r        0.05  
##  b        0     
##  sigma    0.2   
## 
## Option Price:
##  24.16356 
## 
## Description:
##  Thu Feb 24 17:52:02 2022</code></pre>
<p>Consequently, we can see that the option price is approximately 24.</p>
</div>
<div id="pricing-interest-rate-caps-with-black" class="section level3" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Pricing Interest Rate Caps with Black</h3>
<p>Rate caps are interest rate derivatives in which the holder (buyer) gets payments over a certain period of time if the interest rate exceeds a given threshold. Conversely, floors are options in which the buyer gets payments if the interest rate is below a given threshold. As such, caps and floors are efficient products to <strong>hedge against interest rate volatility</strong>. The payoff of a cap (with one unit of notional amount) at the end of the nth period is as follows:</p>
<p><span class="math display">\[
\tau\max(L_{n-1}-X,0)
\]</span></p>
<p>whereas <span class="math inline">\(\tau\)</span> defines the interval between two maturity dates. This is also referred to as a <strong>caplet</strong>, whereas X is an underlying. Apparently, the payoff will either be 0 (in case that the interest rate strike X is higher than the interest rate observed) or <span class="math inline">\(L_{n-1}-X\)</span> (in case that X is smaller than the interest rate). If we assume that the derivative follows a LIBOR curve, and that the LIBOR is given as a random variable that has lognormal distribution and the volatility is <span class="math inline">\(\sigma_{n-1}\)</span>, then we can apply the formulas:</p>
<p><span class="math display">\[
c_n = \tau_ne^{-r\tau n}[F_{n-1}N(d_1) - XN(d_2)]
\]</span></p>
<p>whereas:</p>
<p><span class="math display">\[
\begin{align}
d_1 &amp;= \frac{ln(F_{n-1}/X) + \frac{\sigma^2_{n-1}}{2}\tau(n-1)}{\sigma_{n-1}\sqrt{\tau(n-1)}}\\
d_2 &amp;= \frac{ln(F_{n-1}/X) - \frac{\sigma^2_{n-1}}{2}\tau(n-1)}{\sigma_{n-1}\sqrt{\tau(n-1)}}
\end{align}
\]</span></p>
<p>here, <span class="math inline">\(F_{n-1}\)</span> is the forward LIBOR rate between <span class="math inline">\(\tau(n-1)\)</span> and <span class="math inline">\(\tau n\)</span>, and r is the risk-free spot log return with maturity <span class="math inline">\(\tau n\)</span>. This is nothing else than our usual Black / Scholes formula, accounting for a maturity period and given the remaining DOF.</p>
<p>Once we have valued a caplet, we can continue this for each of the maturities. We then need to sum their prices and aggregate them to obtain the <strong>overall price of the interest rate cap</strong>.</p>
<p>Let’s see an example to understand this in depth. We have to pay USD LIBOR for 6 months to a business partner between May 2014 and November 2014. A caplet is an easy way to avoid the interest rate risk. Assume that we have a caplet on the LIBOR rate with 2.5% strike price (using the usual terminology). This means that if the LIBOR rate is higher then 2.5%, we will receive the difference in cash. If, for example, the LIBOR rate turns out to be 3% in May, our payoff on one unit of notional amount is 0.5*max(3% -2.5%, 0). Assuming that the LIBOR rate follows the geometric Brownian motion with 20% volatility, the forward rate between May 1st and November 1st is 2.2%, and the spot rate is 2%. In this case, we have that:</p>
<ul>
<li>X = 0.025</li>
<li>F = 0.022</li>
<li><span class="math inline">\(\tau\)</span> = 0.5</li>
<li><span class="math inline">\(\sigma\)</span> = 0.2</li>
<li>r = 0.02</li>
</ul>
<p>Now, let’s see how to price the caplet. There is nothing new in it; we can simply use the Black-Scholes formula. It is clear that we need to set <span class="math inline">\(S = F_{n-1}\)</span>, Time = 0.5, and b = 0.</p>
<div class="sourceCode" id="cb9823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9823-1"><a href="fixed-income-securities.html#cb9823-1" aria-hidden="true" tabindex="-1"></a><span class="fu">GBSOption</span>(<span class="st">&quot;c&quot;</span>, <span class="fl">0.022</span>, <span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.02</span>, <span class="dv">0</span>, <span class="fl">0.2</span>)</span></code></pre></div>
<pre><code>## 
## Title:
##  Black Scholes Option Valuation 
## 
## Call:
##  GBSOption(TypeFlag = &quot;c&quot;, S = 0.022, X = 0.025, Time = 0.5, r = 0.02, 
##      b = 0, sigma = 0.2)
## 
## Parameters:
##           Value:
##  TypeFlag c     
##  S        0.022 
##  X        0.025 
##  Time     0.5   
##  r        0.02  
##  b        0     
##  sigma    0.2   
## 
## Option Price:
##  0.0003269133 
## 
## Description:
##  Thu Feb 24 17:52:02 2022</code></pre>
<p>The price of the option is 0.0003269133. We still need to multiply it with τ = 0.5, which makes it 0.0001634567.</p>
<p>A cap is simply a sum of caplets, but we can combine them with different parameters if needed. Let’s say we need a cap that pays if the LIBOR rate goes above 2.5% in the first 3 months, or if it is higher than 2% in the following 3 months. The forward LIBOR rate can also be different in the May and August period (let’s say it is 2.1%), and in the August and November period (let’s say it is 2.2%). We simply price both caplets one by one and add their prices:</p>
<div class="sourceCode" id="cb9825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9825-1"><a href="fixed-income-securities.html#cb9825-1" aria-hidden="true" tabindex="-1"></a><span class="fu">GBSOption</span>(<span class="st">&quot;c&quot;</span>, <span class="fl">0.021</span>, <span class="fl">0.025</span>, <span class="fl">0.25</span>, <span class="fl">0.02</span>, <span class="dv">0</span>, <span class="fl">0.2</span>)</span></code></pre></div>
<pre><code>## 
## Title:
##  Black Scholes Option Valuation 
## 
## Call:
##  GBSOption(TypeFlag = &quot;c&quot;, S = 0.021, X = 0.025, Time = 0.25, 
##      r = 0.02, b = 0, sigma = 0.2)
## 
## Parameters:
##           Value:
##  TypeFlag c     
##  S        0.021 
##  X        0.025 
##  Time     0.25  
##  r        0.02  
##  b        0     
##  sigma    0.2   
## 
## Option Price:
##  3.743394e-05 
## 
## Description:
##  Thu Feb 24 17:52:02 2022</code></pre>
<div class="sourceCode" id="cb9827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9827-1"><a href="fixed-income-securities.html#cb9827-1" aria-hidden="true" tabindex="-1"></a><span class="fu">GBSOption</span>(<span class="st">&quot;c&quot;</span>, <span class="fl">0.022</span>, <span class="fl">0.02</span>, <span class="fl">0.25</span>, <span class="fl">0.02</span>, <span class="dv">0</span>, <span class="fl">0.2</span>)</span></code></pre></div>
<pre><code>## 
## Title:
##  Black Scholes Option Valuation 
## 
## Call:
##  GBSOption(TypeFlag = &quot;c&quot;, S = 0.022, X = 0.02, Time = 0.25, r = 0.02, 
##      b = 0, sigma = 0.2)
## 
## Parameters:
##           Value:
##  TypeFlag c     
##  S        0.022 
##  X        0.02  
##  Time     0.25  
##  r        0.02  
##  b        0     
##  sigma    0.2   
## 
## Option Price:
##  0.002179862 
## 
## Description:
##  Thu Feb 24 17:52:02 2022</code></pre>
<p>Now, we need to multiply both with τ = 0.25 and take the sum of their prices:</p>
<div class="sourceCode" id="cb9829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9829-1"><a href="fixed-income-securities.html#cb9829-1" aria-hidden="true" tabindex="-1"></a>(<span class="fl">3.743394e-05</span> <span class="sc">+</span> <span class="fl">0.002179862</span> ) <span class="sc">*</span> <span class="fl">0.25</span></span></code></pre></div>
<pre><code>## [1] 0.000554324</code></pre>
<p>Pricing a floor is very similar. First, we divide the asset’s cash flows into single payments, called floorlets. Then, we determine the value of each floorlet with the help of the Black model; the only difference is that floorlets are not call but put options. Finally, we add up the prices of the floorlets to get the value of the floor.</p>
<p>As such, this is a simple model to compute caps and floors for forward rate interest agreements.</p>
</div>
</div>
<div id="short-rate-models" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Short Rate Models</h2>
<p>Black’s model is applicable when we can assume that the future value of the underlying asset has lognormal distribution. Another approach to value interest rate derivatives is by modeling the <strong>term structure of interest rates</strong>. Here, we continue by presenting two basic interest rate models and their main characteristics. Two of the most common short rate models are the <strong>Vasicek</strong> and Cox, Ingersoll, and Ross <strong>(CIR)</strong> models. These models generate a term structure of zero coupon prices. Both of these models assume a risk-neutral process for the short rate r with one source of uncertainty. Specifically,</p>
<ul>
<li>the drift and volatility parameters depend only on the short rate r and not on time.</li>
</ul>
<p>Another common feature of these two models is that they <strong>exhibit mean reversion of the short rate</strong>. The difference between the two models is in how they handle volatility.</p>
<div id="vasicek" class="section level3" number="5.6.1">
<h3><span class="header-section-number">5.6.1</span> Vasicek</h3>
<div id="relation-of-interest-rate-parameters" class="section level4" number="5.6.1.1">
<h4><span class="header-section-number">5.6.1.1</span> Relation of interest rate parameters</h4>
<p>The Vasicek model for changes in the short interest rate r is stochastic and of the following form:</p>
<p><span class="math display">\[
dr = a(b-r)dt + \sigma_rdz
\]</span></p>
<p>where a very small change in the short rate (dr) in the time increment dt is <strong>pulled back to the mean level b at a rate of a</strong>. The second term is the volatility of the short rate and it involves <strong>uncertainty dz</strong>. dz is a <strong>normally distributed variable with zero mean and variance dt</strong>. We assume that the short rate r is the <strong>instantaneous rate at time t appropriate for continuous compounding</strong>.</p>
<p>Based on this, we can create simulation studies which portray the relationship between the interest rate increment and its underlying functional parameters.</p>
<div class="sourceCode" id="cb9831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9831-1"><a href="fixed-income-securities.html#cb9831-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the vasicek function</span></span>
<span id="cb9831-2"><a href="fixed-income-securities.html#cb9831-2" aria-hidden="true" tabindex="-1"></a>vasicek <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha, beta, sigma, <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">r0 =</span> <span class="fl">0.05</span>){</span>
<span id="cb9831-3"><a href="fixed-income-securities.html#cb9831-3" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb9831-4"><a href="fixed-income-securities.html#cb9831-4" aria-hidden="true" tabindex="-1"></a>  v[<span class="dv">1</span>] <span class="ot">&lt;-</span> r0</span>
<span id="cb9831-5"><a href="fixed-income-securities.html#cb9831-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){</span>
<span id="cb9831-6"><a href="fixed-income-securities.html#cb9831-6" aria-hidden="true" tabindex="-1"></a>    v[i] <span class="ot">&lt;-</span> v[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> alpha <span class="sc">*</span> (beta <span class="sc">-</span> v[i <span class="sc">-</span> <span class="dv">1</span>]) <span class="sc">+</span> sigma <span class="sc">*</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb9831-7"><a href="fixed-income-securities.html#cb9831-7" aria-hidden="true" tabindex="-1"></a>         }</span>
<span id="cb9831-8"><a href="fixed-income-securities.html#cb9831-8" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(v) </span>
<span id="cb9831-9"><a href="fixed-income-securities.html#cb9831-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9831-10"><a href="fixed-income-securities.html#cb9831-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9831-11"><a href="fixed-income-securities.html#cb9831-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data frame</span></span>
<span id="cb9831-12"><a href="fixed-income-securities.html#cb9831-12" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">4</span>, <span class="fu">vasicek</span>(<span class="fl">0.05</span>, <span class="fl">0.065</span>, <span class="fl">0.0003</span>))</span>
<span id="cb9831-13"><a href="fixed-income-securities.html#cb9831-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9831-14"><a href="fixed-income-securities.html#cb9831-14" aria-hidden="true" tabindex="-1"></a>r_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(r, <span class="fu">seq</span>(<span class="fu">ymd</span>(<span class="st">&#39;2002-04-07&#39;</span>),<span class="fu">ymd</span>(<span class="st">&#39;2015-03-01&#39;</span>), <span class="at">by =</span> <span class="fu">as.difftime</span>(<span class="fu">weeks</span>(<span class="dv">1</span>)))))</span></code></pre></div>
<pre><code>## Warning in base::cbind(...): number of rows of result is not a multiple of vector length (arg 2)</code></pre>
<div class="sourceCode" id="cb9833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9833-1"><a href="fixed-income-securities.html#cb9833-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(r_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Sim1&quot;</span>, <span class="st">&quot;Sim2&quot;</span>, <span class="st">&quot;Sim3&quot;</span>, <span class="st">&quot;Sim4&quot;</span>, <span class="st">&quot;Time&quot;</span>)</span>
<span id="cb9833-2"><a href="fixed-income-securities.html#cb9833-2" aria-hidden="true" tabindex="-1"></a>r_df <span class="ot">&lt;-</span> r_df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Time =</span> <span class="fu">as.Date</span>(Time))</span>
<span id="cb9833-3"><a href="fixed-income-securities.html#cb9833-3" aria-hidden="true" tabindex="-1"></a>r_df <span class="ot">&lt;-</span> r_df[<span class="sc">!</span><span class="fu">duplicated</span>(r_df[<span class="fu">c</span>(<span class="st">&#39;Time&#39;</span>)]),]</span>
<span id="cb9833-4"><a href="fixed-income-securities.html#cb9833-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9833-5"><a href="fixed-income-securities.html#cb9833-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the plot</span></span>
<span id="cb9833-6"><a href="fixed-income-securities.html#cb9833-6" aria-hidden="true" tabindex="-1"></a>r_df <span class="sc">%&gt;%</span> </span>
<span id="cb9833-7"><a href="fixed-income-securities.html#cb9833-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Sim1), <span class="at">color =</span> <span class="st">&quot;Sim1&quot;</span>) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb9833-8"><a href="fixed-income-securities.html#cb9833-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> r_df<span class="sc">$</span>Time, <span class="at">y =</span> r_df<span class="sc">$</span>Sim2, <span class="at">color =</span> <span class="st">&quot;Sim2&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9833-9"><a href="fixed-income-securities.html#cb9833-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(r_df<span class="sc">$</span>Time, r_df<span class="sc">$</span>Sim3, <span class="at">color =</span> <span class="st">&quot;Sim3&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9833-10"><a href="fixed-income-securities.html#cb9833-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(r_df<span class="sc">$</span>Time, r_df<span class="sc">$</span>Sim4, <span class="at">color =</span> <span class="st">&quot;Sim4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9833-11"><a href="fixed-income-securities.html#cb9833-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Vasicek Model estimation of the interest rate&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9833-12"><a href="fixed-income-securities.html#cb9833-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Value&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Time&quot;</span>) <span class="sc">+</span></span>
<span id="cb9833-13"><a href="fixed-income-securities.html#cb9833-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;goldenrod&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9833-14"><a href="fixed-income-securities.html#cb9833-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;violetred4&quot;</span>, <span class="st">&quot;khaki3&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9833-15"><a href="fixed-income-securities.html#cb9833-15" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9833-16"><a href="fixed-income-securities.html#cb9833-16" aria-hidden="true" tabindex="-1"></a><span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9833-17"><a href="fixed-income-securities.html#cb9833-17" aria-hidden="true" tabindex="-1"></a><span class="at">lineheight=</span><span class="fl">1.2</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9833-18"><a href="fixed-income-securities.html#cb9833-18" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9833-19"><a href="fixed-income-securities.html#cb9833-19" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9833-20"><a href="fixed-income-securities.html#cb9833-20" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9833-21"><a href="fixed-income-securities.html#cb9833-21" aria-hidden="true" tabindex="-1"></a><span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9833-22"><a href="fixed-income-securities.html#cb9833-22" aria-hidden="true" tabindex="-1"></a><span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9833-23"><a href="fixed-income-securities.html#cb9833-23" aria-hidden="true" tabindex="-1"></a><span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span></code></pre></div>
<pre><code>## Warning: Use of `r_df$Time` is discouraged. Use `Time` instead.</code></pre>
<pre><code>## Warning: Use of `r_df$Sim2` is discouraged. Use `Sim2` instead.</code></pre>
<pre><code>## Warning: Use of `r_df$Time` is discouraged. Use `Time` instead.</code></pre>
<pre><code>## Warning: Use of `r_df$Sim3` is discouraged. Use `Sim3` instead.</code></pre>
<pre><code>## Warning: Use of `r_df$Time` is discouraged. Use `Time` instead.</code></pre>
<pre><code>## Warning: Use of `r_df$Sim4` is discouraged. Use `Sim4` instead.</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-257-1.png" width="672" /></p>
<p>This is the general formula for the interest rate model according to Vasicek. We can now take a step ahead and look at its sensitivity towards its individual parameters.</p>
<div id="sensitivity-towards-volatility" class="section level5" number="5.6.1.1.1">
<h5><span class="header-section-number">5.6.1.1.1</span> Sensitivity towards volatility</h5>
<div class="sourceCode" id="cb9840"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9840-1"><a href="fixed-income-securities.html#cb9840-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sensivity towards volatility</span></span>
<span id="cb9840-2"><a href="fixed-income-securities.html#cb9840-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.0002</span>, <span class="fl">0.0004</span>), <span class="cf">function</span>(sigma){<span class="fu">vasicek</span>(<span class="fl">0.02</span>, <span class="fl">0.065</span>, sigma)})</span>
<span id="cb9840-3"><a href="fixed-income-securities.html#cb9840-3" aria-hidden="true" tabindex="-1"></a>r_df_vola <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(r, <span class="fu">seq</span>(<span class="fu">ymd</span>(<span class="st">&#39;2002-04-07&#39;</span>),<span class="fu">ymd</span>(<span class="st">&#39;2015-03-01&#39;</span>), <span class="at">by =</span> <span class="fu">as.difftime</span>(<span class="fu">weeks</span>(<span class="dv">1</span>)))))</span></code></pre></div>
<pre><code>## Warning in base::cbind(...): number of rows of result is not a multiple of vector length (arg 2)</code></pre>
<div class="sourceCode" id="cb9842"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9842-1"><a href="fixed-income-securities.html#cb9842-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(r_df_vola) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Vola1&quot;</span>, <span class="st">&quot;Vola2&quot;</span>, <span class="st">&quot;Vola3&quot;</span>, <span class="st">&quot;Time&quot;</span>)</span>
<span id="cb9842-2"><a href="fixed-income-securities.html#cb9842-2" aria-hidden="true" tabindex="-1"></a>r_df_vola <span class="ot">&lt;-</span> r_df_vola <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Time =</span> <span class="fu">as.Date</span>(Time))</span>
<span id="cb9842-3"><a href="fixed-income-securities.html#cb9842-3" aria-hidden="true" tabindex="-1"></a>r_df_vola <span class="ot">&lt;-</span> r_df_vola[<span class="sc">!</span><span class="fu">duplicated</span>(r_df_vola[<span class="fu">c</span>(<span class="st">&#39;Time&#39;</span>)]),]</span>
<span id="cb9842-4"><a href="fixed-income-securities.html#cb9842-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9842-5"><a href="fixed-income-securities.html#cb9842-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the plot</span></span>
<span id="cb9842-6"><a href="fixed-income-securities.html#cb9842-6" aria-hidden="true" tabindex="-1"></a>r_df_vola <span class="sc">%&gt;%</span> </span>
<span id="cb9842-7"><a href="fixed-income-securities.html#cb9842-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Vola1, <span class="at">color =</span> <span class="st">&quot;Vola1&quot;</span>)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb9842-8"><a href="fixed-income-securities.html#cb9842-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> r_df_vola<span class="sc">$</span>Time, <span class="at">y =</span> r_df_vola<span class="sc">$</span>Vola2, <span class="at">color =</span> <span class="st">&quot;Vola2&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9842-9"><a href="fixed-income-securities.html#cb9842-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(r_df_vola<span class="sc">$</span>Time, r_df_vola<span class="sc">$</span>Vola3, <span class="at">color =</span> <span class="st">&quot;Vola3&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9842-10"><a href="fixed-income-securities.html#cb9842-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Vasicek Model estimation of the interest rate - dependence on volatility&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9842-11"><a href="fixed-income-securities.html#cb9842-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Value&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Yield&quot;</span>) <span class="sc">+</span></span>
<span id="cb9842-12"><a href="fixed-income-securities.html#cb9842-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;goldenrod&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9842-13"><a href="fixed-income-securities.html#cb9842-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;violetred4&quot;</span>, <span class="st">&quot;khaki3&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9842-14"><a href="fixed-income-securities.html#cb9842-14" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9842-15"><a href="fixed-income-securities.html#cb9842-15" aria-hidden="true" tabindex="-1"></a><span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9842-16"><a href="fixed-income-securities.html#cb9842-16" aria-hidden="true" tabindex="-1"></a><span class="at">lineheight=</span><span class="fl">1.2</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9842-17"><a href="fixed-income-securities.html#cb9842-17" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9842-18"><a href="fixed-income-securities.html#cb9842-18" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9842-19"><a href="fixed-income-securities.html#cb9842-19" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9842-20"><a href="fixed-income-securities.html#cb9842-20" aria-hidden="true" tabindex="-1"></a><span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9842-21"><a href="fixed-income-securities.html#cb9842-21" aria-hidden="true" tabindex="-1"></a><span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9842-22"><a href="fixed-income-securities.html#cb9842-22" aria-hidden="true" tabindex="-1"></a><span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span></code></pre></div>
<pre><code>## Warning: Use of `r_df_vola$Time` is discouraged. Use `Time` instead.</code></pre>
<pre><code>## Warning: Use of `r_df_vola$Vola2` is discouraged. Use `Vola2` instead.</code></pre>
<pre><code>## Warning: Use of `r_df_vola$Time` is discouraged. Use `Time` instead.</code></pre>
<pre><code>## Warning: Use of `r_df_vola$Vola3` is discouraged. Use `Vola3` instead.</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-258-1.png" width="672" /></p>
<p>As we can see, an increasing volatility creates larger spikes and valleys. This is to be expected, given that the term is additive. As such, the higher the volatility, the more it will circle around its long-term average, which is 0.065. If the volatility parameter is set to zero, the additive term falls out of the equation. Since r0 is lower than beta and alpha &gt; 0, we will see that the Value of the short rate will always converge to the beta value since, once that r0 = beta, the first term of the equation is also equal to zero. Then we have an addition of two zero terms and the previous r0 term, which is equal to beta. Hence, with <strong>volatility set to zero, the Vasicek model will always converge to the beta as long-term average</strong>.</p>
</div>
<div id="sensitivity-towards-alpha" class="section level5" number="5.6.1.1.2">
<h5><span class="header-section-number">5.6.1.1.2</span> Sensitivity towards alpha</h5>
<p>We can do the same for differernt alphas</p>
<div class="sourceCode" id="cb9847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9847-1"><a href="fixed-income-securities.html#cb9847-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sensivity towards alpha</span></span>
<span id="cb9847-2"><a href="fixed-income-securities.html#cb9847-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="fl">0.002</span>, <span class="fl">0.02</span>, <span class="fl">0.2</span>), <span class="cf">function</span>(alpha){<span class="fu">set.seed</span>(<span class="dv">2014</span>); <span class="fu">vasicek</span>(alpha, <span class="fl">0.065</span>, <span class="fl">0.0002</span>)})</span>
<span id="cb9847-3"><a href="fixed-income-securities.html#cb9847-3" aria-hidden="true" tabindex="-1"></a>r_df_alpha <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(r, <span class="fu">seq</span>(<span class="fu">ymd</span>(<span class="st">&#39;2002-04-07&#39;</span>),<span class="fu">ymd</span>(<span class="st">&#39;2015-03-01&#39;</span>), <span class="at">by =</span> <span class="fu">as.difftime</span>(<span class="fu">weeks</span>(<span class="dv">1</span>)))))</span></code></pre></div>
<pre><code>## Warning in base::cbind(...): number of rows of result is not a multiple of vector length (arg 2)</code></pre>
<div class="sourceCode" id="cb9849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9849-1"><a href="fixed-income-securities.html#cb9849-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(r_df_alpha) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Alpha1&quot;</span>, <span class="st">&quot;Alpha2&quot;</span>, <span class="st">&quot;Alpha3&quot;</span>, <span class="st">&quot;Time&quot;</span>)</span>
<span id="cb9849-2"><a href="fixed-income-securities.html#cb9849-2" aria-hidden="true" tabindex="-1"></a>r_df_alpha <span class="ot">&lt;-</span> r_df_alpha <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Time =</span> <span class="fu">as.Date</span>(Time))</span>
<span id="cb9849-3"><a href="fixed-income-securities.html#cb9849-3" aria-hidden="true" tabindex="-1"></a>r_df_alpha <span class="ot">&lt;-</span> r_df_alpha[<span class="sc">!</span><span class="fu">duplicated</span>(r_df_alpha[<span class="fu">c</span>(<span class="st">&#39;Time&#39;</span>)]),]</span>
<span id="cb9849-4"><a href="fixed-income-securities.html#cb9849-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the plot</span></span>
<span id="cb9849-5"><a href="fixed-income-securities.html#cb9849-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9849-6"><a href="fixed-income-securities.html#cb9849-6" aria-hidden="true" tabindex="-1"></a>r_df_alpha <span class="sc">%&gt;%</span> </span>
<span id="cb9849-7"><a href="fixed-income-securities.html#cb9849-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Alpha1, <span class="at">color =</span> <span class="st">&quot;Alpha1&quot;</span>)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb9849-8"><a href="fixed-income-securities.html#cb9849-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> r_df_alpha<span class="sc">$</span>Time, <span class="at">y =</span> r_df_alpha<span class="sc">$</span>Alpha2, <span class="at">color =</span> <span class="st">&quot;Alpha2&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9849-9"><a href="fixed-income-securities.html#cb9849-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(r_df_alpha<span class="sc">$</span>Time, r_df_alpha<span class="sc">$</span>Alpha3, <span class="at">color =</span> <span class="st">&quot;Alpha3&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9849-10"><a href="fixed-income-securities.html#cb9849-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Vasicek Model estimation of the interest rate - dependence on alphas&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9849-11"><a href="fixed-income-securities.html#cb9849-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Value&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Yield&quot;</span>) <span class="sc">+</span></span>
<span id="cb9849-12"><a href="fixed-income-securities.html#cb9849-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;goldenrod&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9849-13"><a href="fixed-income-securities.html#cb9849-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;violetred4&quot;</span>, <span class="st">&quot;khaki3&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9849-14"><a href="fixed-income-securities.html#cb9849-14" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9849-15"><a href="fixed-income-securities.html#cb9849-15" aria-hidden="true" tabindex="-1"></a><span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9849-16"><a href="fixed-income-securities.html#cb9849-16" aria-hidden="true" tabindex="-1"></a><span class="at">lineheight=</span><span class="fl">1.2</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9849-17"><a href="fixed-income-securities.html#cb9849-17" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9849-18"><a href="fixed-income-securities.html#cb9849-18" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9849-19"><a href="fixed-income-securities.html#cb9849-19" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9849-20"><a href="fixed-income-securities.html#cb9849-20" aria-hidden="true" tabindex="-1"></a><span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9849-21"><a href="fixed-income-securities.html#cb9849-21" aria-hidden="true" tabindex="-1"></a><span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9849-22"><a href="fixed-income-securities.html#cb9849-22" aria-hidden="true" tabindex="-1"></a><span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span></code></pre></div>
<pre><code>## Warning: Use of `r_df_alpha$Time` is discouraged. Use `Time` instead.</code></pre>
<pre><code>## Warning: Use of `r_df_alpha$Alpha2` is discouraged. Use `Alpha2` instead.</code></pre>
<pre><code>## Warning: Use of `r_df_alpha$Time` is discouraged. Use `Time` instead.</code></pre>
<pre><code>## Warning: Use of `r_df_alpha$Alpha3` is discouraged. Use `Alpha3` instead.</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-259-1.png" width="672" /></p>
<p>As one can observe, an increase in alpha is associated with a quicker convergence towards the long-term average. The higher alpha, the quicker the convergence. This is also intuitive, given that alpha is the multiplicative term of the difference between beta and r. If this is positive, then a larger alpha implies a steeper increase (= stronger first derivative).</p>
</div>
<div id="sensitivity-towards-beta" class="section level5" number="5.6.1.1.3">
<h5><span class="header-section-number">5.6.1.1.3</span> Sensitivity towards beta</h5>
<p>Lastly, let’s look at the beta value.</p>
<div class="sourceCode" id="cb9854"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9854-1"><a href="fixed-income-securities.html#cb9854-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sensivity towards alpha</span></span>
<span id="cb9854-2"><a href="fixed-income-securities.html#cb9854-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="fl">0.055</span>, <span class="fl">0.065</span>, <span class="fl">0.095</span>), <span class="cf">function</span>(beta){<span class="fu">set.seed</span>(<span class="dv">2014</span>); <span class="fu">vasicek</span>(<span class="fl">0.02</span>, beta, <span class="fl">0.0002</span>)})</span>
<span id="cb9854-3"><a href="fixed-income-securities.html#cb9854-3" aria-hidden="true" tabindex="-1"></a>r_df_beta <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(r, <span class="fu">seq</span>(<span class="fu">ymd</span>(<span class="st">&#39;2002-04-07&#39;</span>),<span class="fu">ymd</span>(<span class="st">&#39;2015-03-01&#39;</span>), <span class="at">by =</span> <span class="fu">as.difftime</span>(<span class="fu">weeks</span>(<span class="dv">1</span>)))))</span></code></pre></div>
<pre><code>## Warning in base::cbind(...): number of rows of result is not a multiple of vector length (arg 2)</code></pre>
<div class="sourceCode" id="cb9856"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9856-1"><a href="fixed-income-securities.html#cb9856-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(r_df_beta) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Beta1&quot;</span>, <span class="st">&quot;Beta2&quot;</span>, <span class="st">&quot;Beta3&quot;</span>, <span class="st">&quot;Time&quot;</span>)</span>
<span id="cb9856-2"><a href="fixed-income-securities.html#cb9856-2" aria-hidden="true" tabindex="-1"></a>r_df_beta <span class="ot">&lt;-</span> r_df_beta <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Time =</span> <span class="fu">as.Date</span>(Time))</span>
<span id="cb9856-3"><a href="fixed-income-securities.html#cb9856-3" aria-hidden="true" tabindex="-1"></a>r_df_beta <span class="ot">&lt;-</span> r_df_beta[<span class="sc">!</span><span class="fu">duplicated</span>(r_df_beta[<span class="fu">c</span>(<span class="st">&#39;Time&#39;</span>)]),]</span>
<span id="cb9856-4"><a href="fixed-income-securities.html#cb9856-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the plot</span></span>
<span id="cb9856-5"><a href="fixed-income-securities.html#cb9856-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9856-6"><a href="fixed-income-securities.html#cb9856-6" aria-hidden="true" tabindex="-1"></a>r_df_beta <span class="sc">%&gt;%</span> </span>
<span id="cb9856-7"><a href="fixed-income-securities.html#cb9856-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Beta1, <span class="at">color =</span> <span class="st">&quot;Beta1&quot;</span>)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb9856-8"><a href="fixed-income-securities.html#cb9856-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> r_df_beta<span class="sc">$</span>Time, <span class="at">y =</span> r_df_beta<span class="sc">$</span>Beta2, <span class="at">color =</span> <span class="st">&quot;Beta2&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9856-9"><a href="fixed-income-securities.html#cb9856-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(r_df_beta<span class="sc">$</span>Time, r_df_beta<span class="sc">$</span>Beta3, <span class="at">color =</span> <span class="st">&quot;Beta3&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9856-10"><a href="fixed-income-securities.html#cb9856-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Vasicek Model estimation of the interest rate - dependence on betas&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9856-11"><a href="fixed-income-securities.html#cb9856-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Value&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Time&quot;</span>) <span class="sc">+</span></span>
<span id="cb9856-12"><a href="fixed-income-securities.html#cb9856-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;goldenrod&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9856-13"><a href="fixed-income-securities.html#cb9856-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;violetred4&quot;</span>, <span class="st">&quot;khaki3&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9856-14"><a href="fixed-income-securities.html#cb9856-14" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9856-15"><a href="fixed-income-securities.html#cb9856-15" aria-hidden="true" tabindex="-1"></a><span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9856-16"><a href="fixed-income-securities.html#cb9856-16" aria-hidden="true" tabindex="-1"></a><span class="at">lineheight=</span><span class="fl">1.2</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9856-17"><a href="fixed-income-securities.html#cb9856-17" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9856-18"><a href="fixed-income-securities.html#cb9856-18" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9856-19"><a href="fixed-income-securities.html#cb9856-19" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9856-20"><a href="fixed-income-securities.html#cb9856-20" aria-hidden="true" tabindex="-1"></a><span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9856-21"><a href="fixed-income-securities.html#cb9856-21" aria-hidden="true" tabindex="-1"></a><span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9856-22"><a href="fixed-income-securities.html#cb9856-22" aria-hidden="true" tabindex="-1"></a><span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span></code></pre></div>
<pre><code>## Warning: Use of `r_df_beta$Time` is discouraged. Use `Time` instead.</code></pre>
<pre><code>## Warning: Use of `r_df_beta$Beta2` is discouraged. Use `Beta2` instead.</code></pre>
<pre><code>## Warning: Use of `r_df_beta$Time` is discouraged. Use `Time` instead.</code></pre>
<pre><code>## Warning: Use of `r_df_beta$Beta3` is discouraged. Use `Beta3` instead.</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-260-1.png" width="672" /></p>
<p>As expected, the beta values define the level of the long-term average. As such, a larger beta implies a greater difference term in the first equation. Since the long-term average will converge at the respective beta value, the differences are accordingly.</p>
</div>
</div>
<div id="density-of-the-rate-parameter" class="section level4" number="5.6.1.2">
<h4><span class="header-section-number">5.6.1.2</span> Density of the rate parameter</h4>
<p>The authors show that the Vasicek model follows a normal distribution with the first two moments defined as:</p>
<p><span class="math display">\[
E[r|r_t] =r_te^{-a(t-s)} + b(1-e^{-a(t-s)})
\]</span></p>
<p>as well as:</p>
<p><span class="math display">\[
var(r|r_t) = \frac{\sigma^2}{2a}(1-e^{-2a(t-s)})
\]</span></p>
<p>Based on these moments, we can define the probability distribution based on individual parameter combinations.</p>
<div class="sourceCode" id="cb9861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9861-1"><a href="fixed-income-securities.html#cb9861-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb9861-2"><a href="fixed-income-securities.html#cb9861-2" aria-hidden="true" tabindex="-1"></a>vas_pdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x, a, b, sigma, t, s, <span class="at">r0 =</span> <span class="fl">0.02</span>){</span>
<span id="cb9861-3"><a href="fixed-income-securities.html#cb9861-3" aria-hidden="true" tabindex="-1"></a>  mean <span class="ot">&lt;-</span>r0<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>a<span class="sc">*</span>(t<span class="sc">-</span>s))<span class="sc">+</span>b<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>a<span class="sc">*</span>(t<span class="sc">-</span>s)))</span>
<span id="cb9861-4"><a href="fixed-income-securities.html#cb9861-4" aria-hidden="true" tabindex="-1"></a>  var <span class="ot">&lt;-</span> sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>a)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>a<span class="sc">*</span>(t<span class="sc">-</span>s)))</span>
<span id="cb9861-5"><a href="fixed-income-securities.html#cb9861-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dnorm</span>(x, <span class="at">mean =</span> mean, <span class="at">sd =</span> var)</span>
<span id="cb9861-6"><a href="fixed-income-securities.html#cb9861-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9861-7"><a href="fixed-income-securities.html#cb9861-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9861-8"><a href="fixed-income-securities.html#cb9861-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the x variable</span></span>
<span id="cb9861-9"><a href="fixed-income-securities.html#cb9861-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="at">length =</span> <span class="dv">2000</span>)</span>
<span id="cb9861-10"><a href="fixed-income-securities.html#cb9861-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">xpd =</span> T ,<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb9861-11"><a href="fixed-income-securities.html#cb9861-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9861-12"><a href="fixed-income-securities.html#cb9861-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the different y variables</span></span>
<span id="cb9861-13"><a href="fixed-income-securities.html#cb9861-13" aria-hidden="true" tabindex="-1"></a>y_st <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">15</span>), <span class="cf">function</span>(t){<span class="fu">set.seed</span>(<span class="dv">2014</span>); <span class="fu">vas_pdf</span>(x, <span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.12</span>, t, <span class="dv">0</span>, <span class="fl">0.02</span>)})</span>
<span id="cb9861-14"><a href="fixed-income-securities.html#cb9861-14" aria-hidden="true" tabindex="-1"></a>y_a <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">2</span>, .<span class="dv">3</span>, .<span class="dv">4</span>), <span class="cf">function</span>(a){<span class="fu">set.seed</span>(<span class="dv">2014</span>); <span class="fu">vas_pdf</span>(x, a, <span class="fl">0.05</span>, <span class="fl">0.12</span>, <span class="dv">7</span>, <span class="dv">0</span>, <span class="fl">0.02</span>)})</span>
<span id="cb9861-15"><a href="fixed-income-securities.html#cb9861-15" aria-hidden="true" tabindex="-1"></a>y_b <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.12</span>, <span class="fl">0.16</span>, <span class="fl">0.19</span>), <span class="cf">function</span>(b){<span class="fu">set.seed</span>(<span class="dv">2014</span>); <span class="fu">vas_pdf</span>(x, <span class="fl">0.1</span>, b, <span class="fl">0.12</span>, <span class="dv">7</span>, <span class="dv">0</span>, <span class="fl">0.02</span>)})</span>
<span id="cb9861-16"><a href="fixed-income-securities.html#cb9861-16" aria-hidden="true" tabindex="-1"></a>y_sigma <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.12</span>, <span class="fl">0.16</span>, <span class="fl">0.19</span>), <span class="cf">function</span>(sigma){<span class="fu">set.seed</span>(<span class="dv">2014</span>); <span class="fu">vas_pdf</span>(x, <span class="fl">0.1</span>, <span class="fl">0.05</span>, sigma, <span class="dv">7</span>, <span class="dv">0</span>, <span class="fl">0.02</span>)})</span>
<span id="cb9861-17"><a href="fixed-income-securities.html#cb9861-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9861-18"><a href="fixed-income-securities.html#cb9861-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9861-19"><a href="fixed-income-securities.html#cb9861-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data frames </span></span>
<span id="cb9861-20"><a href="fixed-income-securities.html#cb9861-20" aria-hidden="true" tabindex="-1"></a>xy_st <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(y_st, x))</span>
<span id="cb9861-21"><a href="fixed-income-securities.html#cb9861-21" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(xy_st) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Delta_T = 2&quot;</span>, <span class="st">&quot;Delta_T = 4&quot;</span>, <span class="st">&quot;Delta_T = 8&quot;</span>, <span class="st">&quot;Delta_T = 15&quot;</span>, <span class="st">&quot;x&quot;</span>)</span>
<span id="cb9861-22"><a href="fixed-income-securities.html#cb9861-22" aria-hidden="true" tabindex="-1"></a>xy_a <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(y_a,x))</span>
<span id="cb9861-23"><a href="fixed-income-securities.html#cb9861-23" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(xy_a) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a = 0.1&quot;</span>, <span class="st">&quot;a = 0.2&quot;</span>, <span class="st">&quot;a = 0.3&quot;</span>, <span class="st">&quot;a = 0.4&quot;</span>, <span class="st">&quot;x&quot;</span>)</span>
<span id="cb9861-24"><a href="fixed-income-securities.html#cb9861-24" aria-hidden="true" tabindex="-1"></a>xy_b <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>( y_b, x))</span>
<span id="cb9861-25"><a href="fixed-income-securities.html#cb9861-25" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(xy_b) <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">&quot;b = 0.1&quot;</span>, <span class="st">&quot;b = 0.12&quot;</span>, <span class="st">&quot;b = 0.16&quot;</span>, <span class="st">&quot;b = 0.19&quot;</span>, <span class="st">&quot;x&quot;</span>)</span>
<span id="cb9861-26"><a href="fixed-income-securities.html#cb9861-26" aria-hidden="true" tabindex="-1"></a>xy_sigma <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(y_sigma, x))</span>
<span id="cb9861-27"><a href="fixed-income-securities.html#cb9861-27" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(xy_sigma) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;s = 0.1&quot;</span>, <span class="st">&quot;s = 0.12&quot;</span>, <span class="st">&quot;s = 0.16&quot;</span>, <span class="st">&quot;s = 0.19&quot;</span>, <span class="st">&quot;x&quot;</span>)</span>
<span id="cb9861-28"><a href="fixed-income-securities.html#cb9861-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9861-29"><a href="fixed-income-securities.html#cb9861-29" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> xy_st <span class="sc">%&gt;%</span> </span>
<span id="cb9861-30"><a href="fixed-income-securities.html#cb9861-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="st">`</span><span class="at">Delta_T = 2</span><span class="st">`</span>, <span class="at">color =</span> <span class="st">&quot;Delta_T = 2&quot;</span>)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb9861-31"><a href="fixed-income-securities.html#cb9861-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_st<span class="sc">$</span>x , <span class="at">y =</span> xy_st<span class="sc">$</span><span class="st">`</span><span class="at">Delta_T = 4</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;Delta_T = 4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9861-32"><a href="fixed-income-securities.html#cb9861-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_st<span class="sc">$</span>x  , <span class="at">y =</span> xy_st<span class="sc">$</span><span class="st">`</span><span class="at">Delta_T = 8</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;Delta_T = 8&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9861-33"><a href="fixed-income-securities.html#cb9861-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_st<span class="sc">$</span>x  , <span class="at">y =</span> xy_st<span class="sc">$</span><span class="st">`</span><span class="at">Delta_T = 15</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;Delta_T = 15&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9861-34"><a href="fixed-income-securities.html#cb9861-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;CIR Model estimation - dependence on Time&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9861-35"><a href="fixed-income-securities.html#cb9861-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;PDF&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Yield&quot;</span>) <span class="sc">+</span></span>
<span id="cb9861-36"><a href="fixed-income-securities.html#cb9861-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;goldenrod&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9861-37"><a href="fixed-income-securities.html#cb9861-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;violetred4&quot;</span>, <span class="st">&quot;khaki3&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9861-38"><a href="fixed-income-securities.html#cb9861-38" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9861-39"><a href="fixed-income-securities.html#cb9861-39" aria-hidden="true" tabindex="-1"></a><span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9861-40"><a href="fixed-income-securities.html#cb9861-40" aria-hidden="true" tabindex="-1"></a><span class="at">lineheight=</span><span class="fl">1.2</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9861-41"><a href="fixed-income-securities.html#cb9861-41" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9861-42"><a href="fixed-income-securities.html#cb9861-42" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9861-43"><a href="fixed-income-securities.html#cb9861-43" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9861-44"><a href="fixed-income-securities.html#cb9861-44" aria-hidden="true" tabindex="-1"></a><span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9861-45"><a href="fixed-income-securities.html#cb9861-45" aria-hidden="true" tabindex="-1"></a><span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9861-46"><a href="fixed-income-securities.html#cb9861-46" aria-hidden="true" tabindex="-1"></a><span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb9861-47"><a href="fixed-income-securities.html#cb9861-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9861-48"><a href="fixed-income-securities.html#cb9861-48" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> xy_a <span class="sc">%&gt;%</span> </span>
<span id="cb9861-49"><a href="fixed-income-securities.html#cb9861-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="st">`</span><span class="at">a = 0.1</span><span class="st">`</span>, <span class="at">color =</span> <span class="st">&quot;a = 0.1&quot;</span>)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb9861-50"><a href="fixed-income-securities.html#cb9861-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_a<span class="sc">$</span>x , <span class="at">y =</span> xy_a<span class="sc">$</span><span class="st">`</span><span class="at">a = 0.2</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;a = 0.2&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9861-51"><a href="fixed-income-securities.html#cb9861-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_a<span class="sc">$</span>x  , <span class="at">y =</span> xy_a<span class="sc">$</span><span class="st">`</span><span class="at">a = 0.3</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;a = 0.3&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9861-52"><a href="fixed-income-securities.html#cb9861-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_a<span class="sc">$</span>x  , <span class="at">y =</span> xy_a<span class="sc">$</span><span class="st">`</span><span class="at">a = 0.4</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;a = 0.4&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9861-53"><a href="fixed-income-securities.html#cb9861-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;CIR Model estimation - dependence on alpha&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9861-54"><a href="fixed-income-securities.html#cb9861-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;PDF&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Yield&quot;</span>) <span class="sc">+</span></span>
<span id="cb9861-55"><a href="fixed-income-securities.html#cb9861-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;goldenrod&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9861-56"><a href="fixed-income-securities.html#cb9861-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;violetred4&quot;</span>, <span class="st">&quot;khaki3&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9861-57"><a href="fixed-income-securities.html#cb9861-57" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9861-58"><a href="fixed-income-securities.html#cb9861-58" aria-hidden="true" tabindex="-1"></a><span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9861-59"><a href="fixed-income-securities.html#cb9861-59" aria-hidden="true" tabindex="-1"></a><span class="at">lineheight=</span><span class="fl">1.2</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9861-60"><a href="fixed-income-securities.html#cb9861-60" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9861-61"><a href="fixed-income-securities.html#cb9861-61" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9861-62"><a href="fixed-income-securities.html#cb9861-62" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9861-63"><a href="fixed-income-securities.html#cb9861-63" aria-hidden="true" tabindex="-1"></a><span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9861-64"><a href="fixed-income-securities.html#cb9861-64" aria-hidden="true" tabindex="-1"></a><span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9861-65"><a href="fixed-income-securities.html#cb9861-65" aria-hidden="true" tabindex="-1"></a><span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb9861-66"><a href="fixed-income-securities.html#cb9861-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9861-67"><a href="fixed-income-securities.html#cb9861-67" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> xy_b <span class="sc">%&gt;%</span> </span>
<span id="cb9861-68"><a href="fixed-income-securities.html#cb9861-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="st">`</span><span class="at">b = 0.1</span><span class="st">`</span>, <span class="at">color =</span> <span class="st">&quot;b = 0.1&quot;</span>)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb9861-69"><a href="fixed-income-securities.html#cb9861-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_b<span class="sc">$</span>x , <span class="at">y =</span> xy_b<span class="sc">$</span><span class="st">`</span><span class="at">b = 0.12</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;b = 0.12&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9861-70"><a href="fixed-income-securities.html#cb9861-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_b<span class="sc">$</span>x  , <span class="at">y =</span> xy_b<span class="sc">$</span><span class="st">`</span><span class="at">b = 0.16</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;b = 0.16&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9861-71"><a href="fixed-income-securities.html#cb9861-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_b<span class="sc">$</span>x  , <span class="at">y =</span> xy_b<span class="sc">$</span><span class="st">`</span><span class="at">b = 0.19</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;b = 0.19&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9861-72"><a href="fixed-income-securities.html#cb9861-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;CIR Model estimation - dependence on beta&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9861-73"><a href="fixed-income-securities.html#cb9861-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;PDF&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Yield&quot;</span>) <span class="sc">+</span></span>
<span id="cb9861-74"><a href="fixed-income-securities.html#cb9861-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;goldenrod&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9861-75"><a href="fixed-income-securities.html#cb9861-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;violetred4&quot;</span>, <span class="st">&quot;khaki3&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9861-76"><a href="fixed-income-securities.html#cb9861-76" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9861-77"><a href="fixed-income-securities.html#cb9861-77" aria-hidden="true" tabindex="-1"></a><span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9861-78"><a href="fixed-income-securities.html#cb9861-78" aria-hidden="true" tabindex="-1"></a><span class="at">lineheight=</span><span class="fl">1.2</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9861-79"><a href="fixed-income-securities.html#cb9861-79" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9861-80"><a href="fixed-income-securities.html#cb9861-80" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9861-81"><a href="fixed-income-securities.html#cb9861-81" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9861-82"><a href="fixed-income-securities.html#cb9861-82" aria-hidden="true" tabindex="-1"></a><span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9861-83"><a href="fixed-income-securities.html#cb9861-83" aria-hidden="true" tabindex="-1"></a><span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9861-84"><a href="fixed-income-securities.html#cb9861-84" aria-hidden="true" tabindex="-1"></a><span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb9861-85"><a href="fixed-income-securities.html#cb9861-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9861-86"><a href="fixed-income-securities.html#cb9861-86" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> xy_sigma <span class="sc">%&gt;%</span> </span>
<span id="cb9861-87"><a href="fixed-income-securities.html#cb9861-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="st">`</span><span class="at">s = 0.1</span><span class="st">`</span>, <span class="at">color =</span> <span class="st">&quot;s = 0.1&quot;</span>)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb9861-88"><a href="fixed-income-securities.html#cb9861-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_sigma<span class="sc">$</span>x , <span class="at">y =</span> xy_sigma<span class="sc">$</span><span class="st">`</span><span class="at">s = 0.12</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;s = 0.12&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9861-89"><a href="fixed-income-securities.html#cb9861-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_sigma<span class="sc">$</span>x  , <span class="at">y =</span> xy_sigma<span class="sc">$</span><span class="st">`</span><span class="at">s = 0.16</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;s = 0.16&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9861-90"><a href="fixed-income-securities.html#cb9861-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_sigma<span class="sc">$</span>x  , <span class="at">y =</span> xy_sigma<span class="sc">$</span><span class="st">`</span><span class="at">s = 0.19</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;s = 0.19&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9861-91"><a href="fixed-income-securities.html#cb9861-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;CIR Model estimation - dependence on sigma&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9861-92"><a href="fixed-income-securities.html#cb9861-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;PDF&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Yield&quot;</span>) <span class="sc">+</span></span>
<span id="cb9861-93"><a href="fixed-income-securities.html#cb9861-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;goldenrod&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9861-94"><a href="fixed-income-securities.html#cb9861-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;violetred4&quot;</span>, <span class="st">&quot;khaki3&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9861-95"><a href="fixed-income-securities.html#cb9861-95" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9861-96"><a href="fixed-income-securities.html#cb9861-96" aria-hidden="true" tabindex="-1"></a><span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9861-97"><a href="fixed-income-securities.html#cb9861-97" aria-hidden="true" tabindex="-1"></a><span class="at">lineheight=</span><span class="fl">1.2</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9861-98"><a href="fixed-income-securities.html#cb9861-98" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9861-99"><a href="fixed-income-securities.html#cb9861-99" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9861-100"><a href="fixed-income-securities.html#cb9861-100" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9861-101"><a href="fixed-income-securities.html#cb9861-101" aria-hidden="true" tabindex="-1"></a><span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9861-102"><a href="fixed-income-securities.html#cb9861-102" aria-hidden="true" tabindex="-1"></a><span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9861-103"><a href="fixed-income-securities.html#cb9861-103" aria-hidden="true" tabindex="-1"></a><span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb9861-104"><a href="fixed-income-securities.html#cb9861-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9861-105"><a href="fixed-income-securities.html#cb9861-105" aria-hidden="true" tabindex="-1"></a>st <span class="sc">+</span> a <span class="sc">+</span> b <span class="sc">+</span> sig <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-261-1.png" width="576" /></p>
<p>We can observe again the following:</p>
<ul>
<li>beta only has an impact on the location, but not on the variance, of the long-term average rate</li>
<li>an increasing alpha will converge quicker at the long-term average</li>
<li>An increase in time will increase the spread of the rate</li>
<li>higher volatility increases the spread, apparently</li>
</ul>
</div>
<div id="calculation-of-zcb-rates-and-yield-curve" class="section level4" number="5.6.1.3">
<h4><span class="header-section-number">5.6.1.3</span> Calculation of ZCB rates and yield curve</h4>
<p>With Vasicek, the Price of a ZCB at time t can be calculated as:</p>
<p><span class="math display">\[
P_{t,s} = A_{t,s}e^{-B_{t,s}, r_t}
\]</span></p>
<p>where rt is the value of the short rate at time t,</p>
<p><span class="math display">\[
B_{t,s} = \frac{1-e^{-a(s-t)}}{a}
\]</span></p>
<p>as well as</p>
<p><span class="math display">\[
A_t = exp\left[\frac{(B_{t,s} - (s-t))(a^2b-\frac{\sigma_r^2}{2})}{a^2} - \frac{\sigma_r^2B_{t,s}}{4a}\right]
\]</span></p>
<p>Based on this, we can determine the following relationship between the bond prices and the yield curve:</p>
<p><span class="math display">\[
R(r,T) = - \frac{1}{s-t}\ln P(t,T)
\]</span></p>
<p>In essence, <span class="math inline">\(A_t\)</span> is a level parameter and <span class="math inline">\(B_{t,s}\)</span> is a drift parameter depending on t and s (so the difference between two periods). In their paper, the authors estimate a = 0.1779, b = 0.0866, and <span class="math inline">\(\sigma_r\)</span> = 0.02. Using r = 0.07, we can compute the ZCB Price after Vasicek</p>
<div class="sourceCode" id="cb9862"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9862-1"><a href="fixed-income-securities.html#cb9862-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs</span></span>
<span id="cb9862-2"><a href="fixed-income-securities.html#cb9862-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fl">0.1779</span></span>
<span id="cb9862-3"><a href="fixed-income-securities.html#cb9862-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fl">0.0866</span></span>
<span id="cb9862-4"><a href="fixed-income-securities.html#cb9862-4" aria-hidden="true" tabindex="-1"></a>sigma_r <span class="ot">&lt;-</span> <span class="fl">0.02</span></span>
<span id="cb9862-5"><a href="fixed-income-securities.html#cb9862-5" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">0.07</span></span>
<span id="cb9862-6"><a href="fixed-income-securities.html#cb9862-6" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">10</span> </span>
<span id="cb9862-7"><a href="fixed-income-securities.html#cb9862-7" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb9862-8"><a href="fixed-income-securities.html#cb9862-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9862-9"><a href="fixed-income-securities.html#cb9862-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Vasicek as function</span></span>
<span id="cb9862-10"><a href="fixed-income-securities.html#cb9862-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9862-11"><a href="fixed-income-securities.html#cb9862-11" aria-hidden="true" tabindex="-1"></a>Vas_Spot <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, sigma_r, r, s, t, <span class="at">get_vola =</span> F){</span>
<span id="cb9862-12"><a href="fixed-income-securities.html#cb9862-12" aria-hidden="true" tabindex="-1"></a>  B_t <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(a <span class="sc">==</span> <span class="dv">0</span>, T, (<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>a<span class="sc">*</span>(s<span class="sc">-</span>t)))<span class="sc">/</span>a)</span>
<span id="cb9862-13"><a href="fixed-income-securities.html#cb9862-13" aria-hidden="true" tabindex="-1"></a>  A_t <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(a <span class="sc">==</span> <span class="dv">0</span>, <span class="fu">exp</span>(sigma_r<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> s<span class="sc">^</span><span class="dv">3</span> <span class="sc">/</span> <span class="dv">6</span>), <span class="fu">exp</span>((B_t <span class="sc">-</span> (s<span class="sc">-</span>t))<span class="sc">*</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>b<span class="sc">-</span>sigma_r<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span>a<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> (sigma_r<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>B_t)<span class="sc">/</span>(<span class="dv">4</span><span class="sc">*</span>a)))</span>
<span id="cb9862-14"><a href="fixed-income-securities.html#cb9862-14" aria-hidden="true" tabindex="-1"></a>  P_t <span class="ot">=</span> A_t<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>B_t<span class="sc">*</span>r)       </span>
<span id="cb9862-15"><a href="fixed-income-securities.html#cb9862-15" aria-hidden="true" tabindex="-1"></a>  R <span class="ot">=</span> <span class="fu">ifelse</span>((s<span class="sc">-</span>t) <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="sc">-</span><span class="fu">log</span>(P_t) <span class="sc">/</span> (s<span class="sc">-</span>t), r)</span>
<span id="cb9862-16"><a href="fixed-income-securities.html#cb9862-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9862-17"><a href="fixed-income-securities.html#cb9862-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (get_vola <span class="sc">==</span> F) {</span>
<span id="cb9862-18"><a href="fixed-income-securities.html#cb9862-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(P_t)</span>
<span id="cb9862-19"><a href="fixed-income-securities.html#cb9862-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9862-20"><a href="fixed-income-securities.html#cb9862-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb9862-21"><a href="fixed-income-securities.html#cb9862-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(R)</span>
<span id="cb9862-22"><a href="fixed-income-securities.html#cb9862-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9862-23"><a href="fixed-income-securities.html#cb9862-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9862-24"><a href="fixed-income-securities.html#cb9862-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9862-25"><a href="fixed-income-securities.html#cb9862-25" aria-hidden="true" tabindex="-1"></a><span class="fu">Vas_Spot</span>(a, b, sigma_r, r, s, t, <span class="at">get_vola =</span> F)</span></code></pre></div>
<pre><code>## [1] 0.4688846</code></pre>
<div class="sourceCode" id="cb9864"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9864-1"><a href="fixed-income-securities.html#cb9864-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Vas_Spot</span>(a, b, sigma_r, r, s, t, <span class="at">get_vola =</span> T)</span></code></pre></div>
<pre><code>## [1] 0.07573986</code></pre>
<p>As we can see, the Price change of a ZCB in the Vasicek model is 0.468*Price of the actual ZCB with an underlying volatility of the zero yield of 0.076.</p>
</div>
</div>
<div id="cox-ingersoll-and-ross---cir-model" class="section level3" number="5.6.2">
<h3><span class="header-section-number">5.6.2</span> Cox, Ingersoll, and Ross - CIR Model</h3>
<p>The Cox, Ingersoll, and Ross (CIR) model is another commonly used interest rate model. The difference between CIR and Vasicek is that the <strong>former assumes the volatility depends also on the square root of the short rate.</strong></p>
<p>The CIR model is as follows:</p>
<p><span class="math display">\[
dr = a(b-r)dt + \sigma\sqrt{r}dz
\]</span></p>
<p>Presuming that <span class="math inline">\(\sigma_r = \sigma\sqrt{r}\)</span>, we assume a higher volatility here.</p>
<p>As is apparent, the long-term average will again be beta and the drift parameter is alpha. The major difference lays in the fact that the volatility term is not constant. Rather, it is proportional to the square root of the interest rate. Due to this difference, we understand that the probability distribution of the short rates follows a <span class="math inline">\(\chi^2\)</span> distribution with n degrees of freedom and m denoting the drift parameter. As such, we define the interest rate as:</p>
<p><span class="math display">\[
f[r|r_t] = 2c\chi^2_{2q+2,2u}[2cr]
\]</span></p>
<p>whereas <span class="math inline">\(c = \frac{2a}{\sigma^2(1-e^{-a(t-s)})}\)</span>, <span class="math inline">\(u = cr_te^{-a(t-s)}\)</span> and <span class="math inline">\(q = \frac{2ab}{\sigma^2}-1\)</span>.</p>
<div id="density-of-the-rate-parameter-1" class="section level4" number="5.6.2.1">
<h4><span class="header-section-number">5.6.2.1</span> Density of the rate parameter</h4>
<p>The authors show that the CIR model follows a <span class="math inline">\(\chi^2\)</span> distribution with the first two moments defined as:</p>
<p><span class="math display">\[
E[r|r_t] =r_te^{-a(t-s)} + b(1-e^{-a(t-s)})
\]</span></p>
<p>as well as:</p>
<p><span class="math display">\[
var(r|r_t) = \frac{\sigma^2r_t}{a}(e^{-a(t-s)} - e^{-2a(t-s)}) + \frac{\sigma^2b}{2a}(1-e^{-a(t-s)})^2 
\]</span></p>
<p>Based on these moments, we can again define the probability distribution based on individual parameter combinations.</p>
<div class="sourceCode" id="cb9866"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9866-1"><a href="fixed-income-securities.html#cb9866-1" aria-hidden="true" tabindex="-1"></a>cir_pdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x, a, b, sigma, t, s, <span class="at">r0 =</span> <span class="fl">0.02</span>){</span>
<span id="cb9866-2"><a href="fixed-income-securities.html#cb9866-2" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">=</span> (<span class="dv">2</span><span class="sc">*</span>a<span class="sc">*</span>b)<span class="sc">/</span>(sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb9866-3"><a href="fixed-income-securities.html#cb9866-3" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">=</span> (<span class="dv">2</span><span class="sc">*</span>a)<span class="sc">/</span>(sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>a<span class="sc">*</span>(t<span class="sc">-</span>s))))</span>
<span id="cb9866-4"><a href="fixed-income-securities.html#cb9866-4" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">=</span> c<span class="sc">*</span>r0<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>a<span class="sc">*</span>(t<span class="sc">-</span>s))</span>
<span id="cb9866-5"><a href="fixed-income-securities.html#cb9866-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span><span class="sc">*</span>c<span class="sc">*</span><span class="fu">dchisq</span>(<span class="dv">2</span><span class="sc">*</span>c<span class="sc">*</span>x, <span class="dv">2</span><span class="sc">*</span>q<span class="sc">+</span><span class="dv">2</span>, <span class="at">ncp =</span> <span class="dv">2</span><span class="sc">*</span>u)</span>
<span id="cb9866-6"><a href="fixed-income-securities.html#cb9866-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9866-7"><a href="fixed-income-securities.html#cb9866-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9866-8"><a href="fixed-income-securities.html#cb9866-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the x variable</span></span>
<span id="cb9866-9"><a href="fixed-income-securities.html#cb9866-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="at">length =</span> <span class="dv">2000</span>)</span>
<span id="cb9866-10"><a href="fixed-income-securities.html#cb9866-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">xpd =</span> T ,<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb9866-11"><a href="fixed-income-securities.html#cb9866-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9866-12"><a href="fixed-income-securities.html#cb9866-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the different y variables</span></span>
<span id="cb9866-13"><a href="fixed-income-securities.html#cb9866-13" aria-hidden="true" tabindex="-1"></a>y_st <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">15</span>), <span class="cf">function</span>(t){<span class="fu">set.seed</span>(<span class="dv">2014</span>); <span class="fu">cir_pdf</span>(x, <span class="fl">0.3</span>, <span class="fl">0.05</span>, <span class="fl">0.12</span>, t, <span class="dv">0</span>, <span class="fl">0.05</span>)})</span>
<span id="cb9866-14"><a href="fixed-income-securities.html#cb9866-14" aria-hidden="true" tabindex="-1"></a>y_a <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">4</span>, .<span class="dv">6</span>, .<span class="dv">8</span>), <span class="cf">function</span>(a){<span class="fu">set.seed</span>(<span class="dv">2014</span>); <span class="fu">cir_pdf</span>(x, a, <span class="fl">0.05</span>, <span class="fl">0.12</span>, <span class="dv">7</span>, <span class="dv">0</span>, <span class="fl">0.05</span>)})</span>
<span id="cb9866-15"><a href="fixed-income-securities.html#cb9866-15" aria-hidden="true" tabindex="-1"></a>y_b <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.12</span>, <span class="fl">0.16</span>, <span class="fl">0.19</span>), <span class="cf">function</span>(b){<span class="fu">set.seed</span>(<span class="dv">2014</span>); <span class="fu">cir_pdf</span>(x, <span class="fl">0.3</span>, b, <span class="fl">0.12</span>, <span class="dv">7</span>, <span class="dv">0</span>, <span class="fl">0.05</span>)})</span>
<span id="cb9866-16"><a href="fixed-income-securities.html#cb9866-16" aria-hidden="true" tabindex="-1"></a>y_sigma <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.03</span>, .<span class="dv">05</span>, .<span class="dv">11</span>), <span class="cf">function</span>(sigma){<span class="fu">set.seed</span>(<span class="dv">2014</span>); <span class="fu">cir_pdf</span>(x, <span class="fl">0.3</span>, <span class="fl">0.05</span>, sigma, <span class="dv">7</span>, <span class="dv">0</span>, <span class="fl">0.05</span>)})</span>
<span id="cb9866-17"><a href="fixed-income-securities.html#cb9866-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9866-18"><a href="fixed-income-securities.html#cb9866-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data frames </span></span>
<span id="cb9866-19"><a href="fixed-income-securities.html#cb9866-19" aria-hidden="true" tabindex="-1"></a>xy_st <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(y_st, x))</span>
<span id="cb9866-20"><a href="fixed-income-securities.html#cb9866-20" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(xy_st) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Delta_T = 1&quot;</span>, <span class="st">&quot;Delta_T = 2&quot;</span>, <span class="st">&quot;Delta_T = 5&quot;</span>, <span class="st">&quot;Delta_T = 15&quot;</span>, <span class="st">&quot;x&quot;</span>)</span>
<span id="cb9866-21"><a href="fixed-income-securities.html#cb9866-21" aria-hidden="true" tabindex="-1"></a>xy_a <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(y_a,x))</span>
<span id="cb9866-22"><a href="fixed-income-securities.html#cb9866-22" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(xy_a) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a = 0.2&quot;</span>, <span class="st">&quot;a = 0.4&quot;</span>, <span class="st">&quot;a = 0.6&quot;</span>, <span class="st">&quot;a = 0.8&quot;</span>, <span class="st">&quot;x&quot;</span>)</span>
<span id="cb9866-23"><a href="fixed-income-securities.html#cb9866-23" aria-hidden="true" tabindex="-1"></a>xy_b <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>( y_b, x))</span>
<span id="cb9866-24"><a href="fixed-income-securities.html#cb9866-24" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(xy_b) <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">&quot;b = 0.1&quot;</span>, <span class="st">&quot;b = 0.12&quot;</span>, <span class="st">&quot;b = 0.16&quot;</span>, <span class="st">&quot;b = 0.19&quot;</span>, <span class="st">&quot;x&quot;</span>)</span>
<span id="cb9866-25"><a href="fixed-income-securities.html#cb9866-25" aria-hidden="true" tabindex="-1"></a>xy_sigma <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(y_sigma, x))</span>
<span id="cb9866-26"><a href="fixed-income-securities.html#cb9866-26" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(xy_sigma) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;s = 0.01&quot;</span>, <span class="st">&quot;s = 0.03&quot;</span>, <span class="st">&quot;s = 0.05&quot;</span>, <span class="st">&quot;s = 0.1&quot;</span>, <span class="st">&quot;x&quot;</span>)</span>
<span id="cb9866-27"><a href="fixed-income-securities.html#cb9866-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9866-28"><a href="fixed-income-securities.html#cb9866-28" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> xy_st <span class="sc">%&gt;%</span> </span>
<span id="cb9866-29"><a href="fixed-income-securities.html#cb9866-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="st">`</span><span class="at">Delta_T = 1</span><span class="st">`</span>, <span class="at">color =</span> <span class="st">&quot;Delta_T = 1&quot;</span>)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb9866-30"><a href="fixed-income-securities.html#cb9866-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_st<span class="sc">$</span>x , <span class="at">y =</span> xy_st<span class="sc">$</span><span class="st">`</span><span class="at">Delta_T = 2</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;Delta_T = 2&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9866-31"><a href="fixed-income-securities.html#cb9866-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_st<span class="sc">$</span>x  , <span class="at">y =</span> xy_st<span class="sc">$</span><span class="st">`</span><span class="at">Delta_T = 5</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;Delta_T = 5&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9866-32"><a href="fixed-income-securities.html#cb9866-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_st<span class="sc">$</span>x  , <span class="at">y =</span> xy_st<span class="sc">$</span><span class="st">`</span><span class="at">Delta_T = 15</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;Delta_T = 15&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9866-33"><a href="fixed-income-securities.html#cb9866-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;CIR Model estimation - dependence on Time&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9866-34"><a href="fixed-income-securities.html#cb9866-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;PDF&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Yield&quot;</span>) <span class="sc">+</span></span>
<span id="cb9866-35"><a href="fixed-income-securities.html#cb9866-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;goldenrod&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9866-36"><a href="fixed-income-securities.html#cb9866-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;violetred4&quot;</span>, <span class="st">&quot;khaki3&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9866-37"><a href="fixed-income-securities.html#cb9866-37" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9866-38"><a href="fixed-income-securities.html#cb9866-38" aria-hidden="true" tabindex="-1"></a><span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9866-39"><a href="fixed-income-securities.html#cb9866-39" aria-hidden="true" tabindex="-1"></a><span class="at">lineheight=</span><span class="fl">1.2</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9866-40"><a href="fixed-income-securities.html#cb9866-40" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9866-41"><a href="fixed-income-securities.html#cb9866-41" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9866-42"><a href="fixed-income-securities.html#cb9866-42" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9866-43"><a href="fixed-income-securities.html#cb9866-43" aria-hidden="true" tabindex="-1"></a><span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9866-44"><a href="fixed-income-securities.html#cb9866-44" aria-hidden="true" tabindex="-1"></a><span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9866-45"><a href="fixed-income-securities.html#cb9866-45" aria-hidden="true" tabindex="-1"></a><span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb9866-46"><a href="fixed-income-securities.html#cb9866-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9866-47"><a href="fixed-income-securities.html#cb9866-47" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> xy_a <span class="sc">%&gt;%</span> </span>
<span id="cb9866-48"><a href="fixed-income-securities.html#cb9866-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="st">`</span><span class="at">a = 0.2</span><span class="st">`</span>, <span class="at">color =</span> <span class="st">&quot;a = 0.2&quot;</span>)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb9866-49"><a href="fixed-income-securities.html#cb9866-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_a<span class="sc">$</span>x , <span class="at">y =</span> xy_a<span class="sc">$</span><span class="st">`</span><span class="at">a = 0.4</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;a = 0.4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9866-50"><a href="fixed-income-securities.html#cb9866-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_a<span class="sc">$</span>x  , <span class="at">y =</span> xy_a<span class="sc">$</span><span class="st">`</span><span class="at">a = 0.6</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;a = 0.6&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9866-51"><a href="fixed-income-securities.html#cb9866-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_a<span class="sc">$</span>x  , <span class="at">y =</span> xy_a<span class="sc">$</span><span class="st">`</span><span class="at">a = 0.8</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;a = 0.8&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9866-52"><a href="fixed-income-securities.html#cb9866-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;CIR Model estimation - dependence on alpha&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9866-53"><a href="fixed-income-securities.html#cb9866-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;PDF&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Yield&quot;</span>) <span class="sc">+</span></span>
<span id="cb9866-54"><a href="fixed-income-securities.html#cb9866-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;goldenrod&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9866-55"><a href="fixed-income-securities.html#cb9866-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;violetred4&quot;</span>, <span class="st">&quot;khaki3&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9866-56"><a href="fixed-income-securities.html#cb9866-56" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9866-57"><a href="fixed-income-securities.html#cb9866-57" aria-hidden="true" tabindex="-1"></a><span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9866-58"><a href="fixed-income-securities.html#cb9866-58" aria-hidden="true" tabindex="-1"></a><span class="at">lineheight=</span><span class="fl">1.2</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9866-59"><a href="fixed-income-securities.html#cb9866-59" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9866-60"><a href="fixed-income-securities.html#cb9866-60" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9866-61"><a href="fixed-income-securities.html#cb9866-61" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9866-62"><a href="fixed-income-securities.html#cb9866-62" aria-hidden="true" tabindex="-1"></a><span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9866-63"><a href="fixed-income-securities.html#cb9866-63" aria-hidden="true" tabindex="-1"></a><span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9866-64"><a href="fixed-income-securities.html#cb9866-64" aria-hidden="true" tabindex="-1"></a><span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb9866-65"><a href="fixed-income-securities.html#cb9866-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9866-66"><a href="fixed-income-securities.html#cb9866-66" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> xy_b <span class="sc">%&gt;%</span> </span>
<span id="cb9866-67"><a href="fixed-income-securities.html#cb9866-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="st">`</span><span class="at">b = 0.1</span><span class="st">`</span>, <span class="at">color =</span> <span class="st">&quot;b = 0.1&quot;</span>)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb9866-68"><a href="fixed-income-securities.html#cb9866-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_b<span class="sc">$</span>x , <span class="at">y =</span> xy_b<span class="sc">$</span><span class="st">`</span><span class="at">b = 0.12</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;b = 0.12&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9866-69"><a href="fixed-income-securities.html#cb9866-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_b<span class="sc">$</span>x  , <span class="at">y =</span> xy_b<span class="sc">$</span><span class="st">`</span><span class="at">b = 0.16</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;b = 0.16&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9866-70"><a href="fixed-income-securities.html#cb9866-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_b<span class="sc">$</span>x  , <span class="at">y =</span> xy_b<span class="sc">$</span><span class="st">`</span><span class="at">b = 0.19</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;b = 0.19&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9866-71"><a href="fixed-income-securities.html#cb9866-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;CIR Model estimation - dependence on beta&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9866-72"><a href="fixed-income-securities.html#cb9866-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;PDF&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Yield&quot;</span>) <span class="sc">+</span></span>
<span id="cb9866-73"><a href="fixed-income-securities.html#cb9866-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;goldenrod&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9866-74"><a href="fixed-income-securities.html#cb9866-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;violetred4&quot;</span>, <span class="st">&quot;khaki3&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9866-75"><a href="fixed-income-securities.html#cb9866-75" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9866-76"><a href="fixed-income-securities.html#cb9866-76" aria-hidden="true" tabindex="-1"></a><span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9866-77"><a href="fixed-income-securities.html#cb9866-77" aria-hidden="true" tabindex="-1"></a><span class="at">lineheight=</span><span class="fl">1.2</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9866-78"><a href="fixed-income-securities.html#cb9866-78" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9866-79"><a href="fixed-income-securities.html#cb9866-79" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9866-80"><a href="fixed-income-securities.html#cb9866-80" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9866-81"><a href="fixed-income-securities.html#cb9866-81" aria-hidden="true" tabindex="-1"></a><span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9866-82"><a href="fixed-income-securities.html#cb9866-82" aria-hidden="true" tabindex="-1"></a><span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9866-83"><a href="fixed-income-securities.html#cb9866-83" aria-hidden="true" tabindex="-1"></a><span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb9866-84"><a href="fixed-income-securities.html#cb9866-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9866-85"><a href="fixed-income-securities.html#cb9866-85" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> xy_sigma <span class="sc">%&gt;%</span> </span>
<span id="cb9866-86"><a href="fixed-income-securities.html#cb9866-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="st">`</span><span class="at">s = 0.01</span><span class="st">`</span>, <span class="at">color =</span> <span class="st">&quot;s = 0.01&quot;</span>)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb9866-87"><a href="fixed-income-securities.html#cb9866-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_sigma<span class="sc">$</span>x , <span class="at">y =</span> xy_sigma<span class="sc">$</span><span class="st">`</span><span class="at">s = 0.03</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;s = 0.03&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9866-88"><a href="fixed-income-securities.html#cb9866-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_sigma<span class="sc">$</span>x  , <span class="at">y =</span> xy_sigma<span class="sc">$</span><span class="st">`</span><span class="at">s = 0.05</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;s = 0.05&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9866-89"><a href="fixed-income-securities.html#cb9866-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> xy_sigma<span class="sc">$</span>x  , <span class="at">y =</span> xy_sigma<span class="sc">$</span><span class="st">`</span><span class="at">s = 0.1</span><span class="st">`</span>,  <span class="at">color =</span> <span class="st">&quot;s = 0.1&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9866-90"><a href="fixed-income-securities.html#cb9866-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;CIR Model estimation - dependence on sigma&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9866-91"><a href="fixed-income-securities.html#cb9866-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;PDF&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Yield&quot;</span>) <span class="sc">+</span></span>
<span id="cb9866-92"><a href="fixed-income-securities.html#cb9866-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;goldenrod&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9866-93"><a href="fixed-income-securities.html#cb9866-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;violetred4&quot;</span>, <span class="st">&quot;khaki3&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9866-94"><a href="fixed-income-securities.html#cb9866-94" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9866-95"><a href="fixed-income-securities.html#cb9866-95" aria-hidden="true" tabindex="-1"></a><span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9866-96"><a href="fixed-income-securities.html#cb9866-96" aria-hidden="true" tabindex="-1"></a><span class="at">lineheight=</span><span class="fl">1.2</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9866-97"><a href="fixed-income-securities.html#cb9866-97" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9866-98"><a href="fixed-income-securities.html#cb9866-98" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9866-99"><a href="fixed-income-securities.html#cb9866-99" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9866-100"><a href="fixed-income-securities.html#cb9866-100" aria-hidden="true" tabindex="-1"></a><span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9866-101"><a href="fixed-income-securities.html#cb9866-101" aria-hidden="true" tabindex="-1"></a><span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9866-102"><a href="fixed-income-securities.html#cb9866-102" aria-hidden="true" tabindex="-1"></a><span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) </span>
<span id="cb9866-103"><a href="fixed-income-securities.html#cb9866-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9866-104"><a href="fixed-income-securities.html#cb9866-104" aria-hidden="true" tabindex="-1"></a>st <span class="sc">+</span> a <span class="sc">+</span> b <span class="sc">+</span> sig <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-263-1.png" width="576" /></p>
<p>Apart from the fact that we have the usual <span class="math inline">\(\chi^2\)</span> distribution present, we can observe the following:</p>
<ul>
<li>Increasing time again increases the spread</li>
<li>Smaller alphas decline the spread</li>
<li>beta values now change the mean as well as the density</li>
<li>an increasing volatility increases the spread of the rate</li>
</ul>
</div>
<div id="calculation-of-zcb-rates-and-yield-curve-1" class="section level4" number="5.6.2.2">
<h4><span class="header-section-number">5.6.2.2</span> Calculation of ZCB rates and yield curve</h4>
<p>Under the CIR model, the price of a zero coupon bond at time t is again:</p>
<p><span class="math display">\[
P_{t,s} = A_{t,s}e^{-B_{t,s}, r_t}
\]</span></p>
<p>whereas:</p>
<p><span class="math display">\[
B_{t,s} = \frac{2e_T}{(\gamma + a)e_T + 2\gamma}
\]</span></p>
<p><span class="math display">\[
A_{t,s} = \frac{2\gamma e^{\gamma + a}(s-t)/2}{((\gamma + a)e_T + 2\gamma)^{2ab/\sigma_r^2}}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\gamma = \sqrt{a^2 + 2\sigma^2}
\]</span></p>
<p><span class="math display">\[
e_T = e^{\gamma (s-t) } - 1
\]</span></p>
<p>As we can see, the model parameters are now dependent on an additional parameter <span class="math inline">\(\gamma\)</span>, which is a drift parameter for a poly volatility structure.</p>
<p>We can again calculate the price according to the CIR model configuration as follows:</p>
<div class="sourceCode" id="cb9867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9867-1"><a href="fixed-income-securities.html#cb9867-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs</span></span>
<span id="cb9867-2"><a href="fixed-income-securities.html#cb9867-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fl">0.1779</span></span>
<span id="cb9867-3"><a href="fixed-income-securities.html#cb9867-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fl">0.0866</span></span>
<span id="cb9867-4"><a href="fixed-income-securities.html#cb9867-4" aria-hidden="true" tabindex="-1"></a>sigma_r <span class="ot">&lt;-</span> <span class="fl">0.02</span></span>
<span id="cb9867-5"><a href="fixed-income-securities.html#cb9867-5" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">0.07</span></span>
<span id="cb9867-6"><a href="fixed-income-securities.html#cb9867-6" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">10</span> </span>
<span id="cb9867-7"><a href="fixed-income-securities.html#cb9867-7" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb9867-8"><a href="fixed-income-securities.html#cb9867-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9867-9"><a href="fixed-income-securities.html#cb9867-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Vasicek as function</span></span>
<span id="cb9867-10"><a href="fixed-income-securities.html#cb9867-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9867-11"><a href="fixed-income-securities.html#cb9867-11" aria-hidden="true" tabindex="-1"></a>CIR_Spot <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, sigma_r, r, s, t, <span class="at">get_vola =</span> F){</span>
<span id="cb9867-12"><a href="fixed-income-securities.html#cb9867-12" aria-hidden="true" tabindex="-1"></a>  c_t <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> sigma_r<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb9867-13"><a href="fixed-income-securities.html#cb9867-13" aria-hidden="true" tabindex="-1"></a>  e_t <span class="ot">&lt;-</span> <span class="fu">exp</span>(c_t<span class="sc">*</span>(s<span class="sc">-</span>t)) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb9867-14"><a href="fixed-income-securities.html#cb9867-14" aria-hidden="true" tabindex="-1"></a>  B_t <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">*</span>e_t)<span class="sc">/</span>((c_t <span class="sc">+</span> a)<span class="sc">*</span>e_t <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>c_t)</span>
<span id="cb9867-15"><a href="fixed-income-securities.html#cb9867-15" aria-hidden="true" tabindex="-1"></a>  A_t <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">*</span>c_t<span class="sc">*</span><span class="fu">exp</span>(c_t <span class="sc">+</span> a)<span class="sc">*</span>(s<span class="sc">-</span>t)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span>((c_t <span class="sc">+</span> a)<span class="sc">*</span>e_t <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>c_t)<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>a<span class="sc">*</span>b<span class="sc">/</span>sigma_r)</span>
<span id="cb9867-16"><a href="fixed-income-securities.html#cb9867-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9867-17"><a href="fixed-income-securities.html#cb9867-17" aria-hidden="true" tabindex="-1"></a>  P_t <span class="ot">=</span> A_t<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>B_t<span class="sc">*</span>r)       </span>
<span id="cb9867-18"><a href="fixed-income-securities.html#cb9867-18" aria-hidden="true" tabindex="-1"></a>  R <span class="ot">=</span> <span class="fu">ifelse</span>((s<span class="sc">-</span>t) <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="sc">-</span><span class="fu">log</span>(P_t) <span class="sc">/</span> (s<span class="sc">-</span>t), r)</span>
<span id="cb9867-19"><a href="fixed-income-securities.html#cb9867-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9867-20"><a href="fixed-income-securities.html#cb9867-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (get_vola <span class="sc">==</span> F) {</span>
<span id="cb9867-21"><a href="fixed-income-securities.html#cb9867-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(P_t)</span>
<span id="cb9867-22"><a href="fixed-income-securities.html#cb9867-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9867-23"><a href="fixed-income-securities.html#cb9867-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb9867-24"><a href="fixed-income-securities.html#cb9867-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(R)</span>
<span id="cb9867-25"><a href="fixed-income-securities.html#cb9867-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9867-26"><a href="fixed-income-securities.html#cb9867-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9867-27"><a href="fixed-income-securities.html#cb9867-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9867-28"><a href="fixed-income-securities.html#cb9867-28" aria-hidden="true" tabindex="-1"></a><span class="fu">CIR_Spot</span>(a, b, sigma_r, r, s, t, <span class="at">get_vola =</span> F)</span></code></pre></div>
<pre><code>## [1] 0.5633079</code></pre>
<div class="sourceCode" id="cb9869"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9869-1"><a href="fixed-income-securities.html#cb9869-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CIR_Spot</span>(a, b, sigma_r, r, s, t, <span class="at">get_vola =</span> T)</span></code></pre></div>
<pre><code>## [1] 0.05739288</code></pre>
<p>As we can see, the Price change of a ZCB in the CIR model is 0.5633079*Price of the actual ZCB with an underlying volatility of the zero yield of 0.05739288. Assuming a par value of 1000 US Dollars, we understand that the price of a 10-year ZCB is approximately 563.31 US Dollars.</p>
</div>
</div>
</div>
<div id="convertible-bonds" class="section level2" number="5.7">
<h2><span class="header-section-number">5.7</span> Convertible Bonds</h2>
<p>Let’s now consider a different form of bond, the so-called convertible bond (CB). CBs are called like this because they have a conversion feature. That is, they can be converted from a debt to an equity instrument. . Convertible bonds are hybrid financial instruments with complex features, because they have
characteristics of both debts and equities, and usually several equity options are embedded in this kind of contracts. The optimality of the conversion decision depends on equity price, future interest rate and default probability of the issuer.</p>
<div id="main-idea-of-cbs" class="section level3" number="5.7.1">
<h3><span class="header-section-number">5.7.1</span> Main Idea of CBs</h3>
<p>Due to their structure, they are often issued by companies with low credit ratings and high potential growth opportunities. These firms can <strong>lower their interest costs by giving the right</strong> to <strong>convert the bond into a specified number of shares</strong>. Accordingly, the argument for CBs is the following:</p>
<ul>
<li>Investors have the upside potential that they can acquire equity cheaply if the company takes off, while being protected with the cash flow payments of the bond</li>
<li>The company benefits since the conversion inadvertently decreases the leverage of the company. However, one drawdown is the stock dilusion at conversion</li>
</ul>
<p>As such, any CB has three stages: In-the-Money, At-the-Money as well as Out-of-the-Money CBs.</p>
<ul>
<li>In-the-Money CBs are identical to equity. This happens if the conversion price is lower than the equity price</li>
<li>At-the-Money CBs are both equity and debt. This happens if the conersion price is exactly the equity price</li>
<li>Out-of-the-Money CBs are considered debt. This happens if the conversion price is higher than the equity price</li>
</ul>
<p>Consequently, any CB acts like an option, with the downside risk equal to the bond price (including cash flows and final value, discounted) as well as a potentially limitless upside risk increasing with the share price. Let’s quickly consider how we can price such a CB. In order to do so, we expect you to be familiar with the usual Black-Scholes Model for options pricing. Although we will only consider this in later chapters, we will still give a short introduction to the subject at hand.</p>
<p>The main idea of pricing a CB is to price both the equity and debt part individually.</p>
</div>
<div id="individual-constituents-of-cbs" class="section level3" number="5.7.2">
<h3><span class="header-section-number">5.7.2</span> Individual constituents of CBs</h3>
<p>In order to be able to price CBs, we first need to consider what constitutes a CB and how its individual parts play along. Although there are a number of options for CBs, the one we are going to have a look at is a European CB. As with general options, this implies that execution is restricted to a specific date, rather than a time interval. Consequently, we can only execute this instrument at maturity.</p>
<p>In order to value a CB, we need to gather information on three distinct areas: <strong>Bond Parameters</strong>, which defines the underlying parameters of the bond value, <strong>Valuation Process</strong> (usually Black-Scholes to calculate the option value of conversion) as well as <strong>Date Parameters</strong>, which define the date parameters of the bond.</p>
<p><em>Bond Parameters</em> includes the following quantities:</p>
<ul>
<li>B: The face amount of the bond</li>
<li>M: The conversion ratio</li>
<li>CS: The Credit Spread (Difference of bid and ask price)</li>
<li>Id: Issue date of the bond</li>
<li>mD: Maturity Date of the bond (their difference equals t: the time until maturity)</li>
<li>e: Exercise option (either US or EU)</li>
</ul>
<p>Based on these parameters, thus, we can now specify the BS process to evaluate the option.</p>
<p><em>Valuation Process</em> includes the following quantities:</p>
<ul>
<li>S: The price of the underlying</li>
<li>vola: Volatility of the share price</li>
<li>DY: Dividend Yield</li>
<li>rff: Risk-Free Rate</li>
</ul>
<p>You can already see if you every got acquainted with options that these parameters are basically what you would also have when evaluating normal options. So, now we have created the pricing process, but we need to consider the actual trading times and quantities. We do so with the <strong>Date Parameters</strong>:</p>
<ul>
<li>settlementDays: The settlement days of eligibility</li>
<li>dayCounter: day counter convention (trading days each year - can have many values but usually 360)</li>
<li>period: interest compounding interval</li>
<li>businessDayConvention: usual business days in a trading week</li>
</ul>
<p>Based on these three parameters, we can create a CB. We deliberately chose this set-up because it follows exactly the set-up needed for the function <code>ConvertibleFixedCouponBond</code> of the <code>RQuantLib</code> package, which allows us to simply calculate Convertible Fixed Coupon Bonds, Convertible Floating Coupon Bonds, as well as Convertible Zero Coupon Bonds.</p>
<p>Consequently, let’s consider a 10-year CB with 1000.- par value. The coupon is 5.785% with semi-annual interest payment. The execution right is par at maturity to 5 shares of common stock. We just assume the interest rate to be at 2%. Further, the Credit Spread of the bond is 1.5%. The price of the stock is 15.-, its volatility 13% and has zero dividend yield.</p>
<div class="sourceCode" id="cb9871"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9871-1"><a href="fixed-income-securities.html#cb9871-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To create the function, we first need to consider the dates of interest</span></span>
<span id="cb9871-2"><a href="fixed-income-securities.html#cb9871-2" aria-hidden="true" tabindex="-1"></a>today <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">&quot;2021-12-05&quot;</span>)</span>
<span id="cb9871-3"><a href="fixed-income-securities.html#cb9871-3" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">tradeDate  =</span> today <span class="sc">-</span> <span class="dv">2</span>, <span class="at">settleDate =</span> today, <span class="at">dt =</span> <span class="fl">0.25</span>)</span>
<span id="cb9871-4"><a href="fixed-income-securities.html#cb9871-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Then, we create a times argument which tells the function how many times they need to repeat the functions below</span></span>
<span id="cb9871-5"><a href="fixed-income-securities.html#cb9871-5" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.1</span>)</span>
<span id="cb9871-6"><a href="fixed-income-securities.html#cb9871-6" aria-hidden="true" tabindex="-1"></a>dividendYield <span class="ot">&lt;-</span> <span class="fu">DiscountCurve</span>(params, <span class="fu">list</span>(<span class="at">flat =</span> <span class="fl">10e-6</span>), times)</span>
<span id="cb9871-7"><a href="fixed-income-securities.html#cb9871-7" aria-hidden="true" tabindex="-1"></a>riskFreeRate  <span class="ot">&lt;-</span> <span class="fu">DiscountCurve</span>(params, <span class="fu">list</span>(<span class="at">flat =</span> <span class="fl">0.02</span>), times)</span>
<span id="cb9871-8"><a href="fixed-income-securities.html#cb9871-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9871-9"><a href="fixed-income-securities.html#cb9871-9" aria-hidden="true" tabindex="-1"></a><span class="co"># We need to set the parameters as a list-based object</span></span>
<span id="cb9871-10"><a href="fixed-income-securities.html#cb9871-10" aria-hidden="true" tabindex="-1"></a><span class="co"># First, the bond parameters with a maturity date of 1900 days in the future</span></span>
<span id="cb9871-11"><a href="fixed-income-securities.html#cb9871-11" aria-hidden="true" tabindex="-1"></a>bondparams <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb9871-12"><a href="fixed-income-securities.html#cb9871-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">exercise =</span> <span class="st">&quot;eu&quot;</span>, </span>
<span id="cb9871-13"><a href="fixed-income-securities.html#cb9871-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">faceAmount =</span> <span class="dv">1000</span>, </span>
<span id="cb9871-14"><a href="fixed-income-securities.html#cb9871-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">creditSpread =</span> <span class="fl">0.015</span>, </span>
<span id="cb9871-15"><a href="fixed-income-securities.html#cb9871-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">conversionRatio =</span> <span class="dv">5</span>, </span>
<span id="cb9871-16"><a href="fixed-income-securities.html#cb9871-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">issueDate =</span> <span class="fu">as.Date</span>(today <span class="sc">+</span> <span class="dv">2</span>),</span>
<span id="cb9871-17"><a href="fixed-income-securities.html#cb9871-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">maturityDate =</span> <span class="fu">as.Date</span>(today <span class="sc">+</span> <span class="dv">1900</span>)</span>
<span id="cb9871-18"><a href="fixed-income-securities.html#cb9871-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9871-19"><a href="fixed-income-securities.html#cb9871-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9871-20"><a href="fixed-income-securities.html#cb9871-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Then the B/S process. We need to define both risk free and Dividend Yield like this b/c we need to set it equal throughout time. </span></span>
<span id="cb9871-21"><a href="fixed-income-securities.html#cb9871-21" aria-hidden="true" tabindex="-1"></a>process <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb9871-22"><a href="fixed-income-securities.html#cb9871-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">underlying =</span> <span class="dv">15</span>,</span>
<span id="cb9871-23"><a href="fixed-income-securities.html#cb9871-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">divYield =</span> dividendYield, </span>
<span id="cb9871-24"><a href="fixed-income-securities.html#cb9871-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">rff =</span> riskFreeRate, </span>
<span id="cb9871-25"><a href="fixed-income-securities.html#cb9871-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">volatility =</span> <span class="fl">0.13</span></span>
<span id="cb9871-26"><a href="fixed-income-securities.html#cb9871-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9871-27"><a href="fixed-income-securities.html#cb9871-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9871-28"><a href="fixed-income-securities.html#cb9871-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Lastly, the date specification</span></span>
<span id="cb9871-29"><a href="fixed-income-securities.html#cb9871-29" aria-hidden="true" tabindex="-1"></a>dateparams <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb9871-30"><a href="fixed-income-securities.html#cb9871-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">settlementDays =</span> <span class="dv">3</span>, </span>
<span id="cb9871-31"><a href="fixed-income-securities.html#cb9871-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">dayCounter =</span> <span class="st">&quot;ActualActual&quot;</span>, </span>
<span id="cb9871-32"><a href="fixed-income-securities.html#cb9871-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">period =</span> <span class="st">&quot;Semiannual&quot;</span>, </span>
<span id="cb9871-33"><a href="fixed-income-securities.html#cb9871-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">businessDayConvention =</span> <span class="st">&quot;Unadjusted&quot;</span></span>
<span id="cb9871-34"><a href="fixed-income-securities.html#cb9871-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9871-35"><a href="fixed-income-securities.html#cb9871-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9871-36"><a href="fixed-income-securities.html#cb9871-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, we can create the CB with fixed coupon payments by administering all the relevant information: </span></span>
<span id="cb9871-37"><a href="fixed-income-securities.html#cb9871-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9871-38"><a href="fixed-income-securities.html#cb9871-38" aria-hidden="true" tabindex="-1"></a>CB <span class="ot">&lt;-</span> <span class="fu">ConvertibleFixedCouponBond</span>(bondparams, <span class="at">coupon =</span> <span class="fl">0.05785</span>, process,</span>
<span id="cb9871-39"><a href="fixed-income-securities.html#cb9871-39" aria-hidden="true" tabindex="-1"></a>dateparams)</span>
<span id="cb9871-40"><a href="fixed-income-securities.html#cb9871-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9871-41"><a href="fixed-income-securities.html#cb9871-41" aria-hidden="true" tabindex="-1"></a>CB</span></code></pre></div>
<pre><code>## Concise summary of valuation for ConvertibleFixedCouponBond 
##  Net present value :  115.4129 
##        clean price :  115.37 
##        dirty price :  115.41 
##     accrued coupon :  0.047548 
##              yield :  0.025804 
##         cash flows : 
##        Date   Amount
##  2022-02-17   1.1412
##  2022-08-17   2.8687
##  2023-02-17   2.9163
##  2023-08-17   2.8687
##  2024-02-17   2.9142
##  2024-08-17   2.8767
##  2025-02-17   2.9103
##  2025-08-17   2.8687
##  2026-02-17   2.9163
##  2026-08-17   2.8687
##  2027-02-17   2.9163
##  2027-02-17 100.0000</code></pre>
<p>As we can see, the NPV of the CB is 105.8078, with an accrued coupon of 0.0475 and a Yield of 0.045. This implies that the CB has a value of 105.8078 given the assumptions made and the distributional characteristics of the B/S bond structure. The accrued coupon is the coupon adjusted for the exercising option. Further, the yield is calculated through the reverse formula for the bond price.</p>
<p>We can take one step further and assess how the price of the CB depends on certain parameters through the <code>sapply</code> function.</p>
<div class="sourceCode" id="cb9873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9873-1"><a href="fixed-income-securities.html#cb9873-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For vola</span></span>
<span id="cb9873-2"><a href="fixed-income-securities.html#cb9873-2" aria-hidden="true" tabindex="-1"></a>res_cb_vola <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="fl">0.9</span>,<span class="fl">0.01</span>), <span class="cf">function</span>(s) {</span>
<span id="cb9873-3"><a href="fixed-income-securities.html#cb9873-3" aria-hidden="true" tabindex="-1"></a>  process<span class="sc">$</span>volatility <span class="ot">=</span> s</span>
<span id="cb9873-4"><a href="fixed-income-securities.html#cb9873-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ConvertibleFixedCouponBond</span>(bondparams, <span class="at">coupon =</span> <span class="fl">0.05785</span>, process,</span>
<span id="cb9873-5"><a href="fixed-income-securities.html#cb9873-5" aria-hidden="true" tabindex="-1"></a>dateparams)<span class="sc">$</span>NPV</span>
<span id="cb9873-6"><a href="fixed-income-securities.html#cb9873-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb9873-7"><a href="fixed-income-securities.html#cb9873-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9873-8"><a href="fixed-income-securities.html#cb9873-8" aria-hidden="true" tabindex="-1"></a><span class="co"># For price</span></span>
<span id="cb9873-9"><a href="fixed-income-securities.html#cb9873-9" aria-hidden="true" tabindex="-1"></a>res_cb_price <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">40</span>,<span class="dv">1</span>), <span class="cf">function</span>(s) {</span>
<span id="cb9873-10"><a href="fixed-income-securities.html#cb9873-10" aria-hidden="true" tabindex="-1"></a>  process<span class="sc">$</span>underlying <span class="ot">=</span> s</span>
<span id="cb9873-11"><a href="fixed-income-securities.html#cb9873-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ConvertibleFixedCouponBond</span>(bondparams, <span class="at">coupon =</span> <span class="fl">0.05785</span>, process,</span>
<span id="cb9873-12"><a href="fixed-income-securities.html#cb9873-12" aria-hidden="true" tabindex="-1"></a>dateparams)<span class="sc">$</span>NPV</span>
<span id="cb9873-13"><a href="fixed-income-securities.html#cb9873-13" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb9873-14"><a href="fixed-income-securities.html#cb9873-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9873-15"><a href="fixed-income-securities.html#cb9873-15" aria-hidden="true" tabindex="-1"></a><span class="co"># For rf</span></span>
<span id="cb9873-16"><a href="fixed-income-securities.html#cb9873-16" aria-hidden="true" tabindex="-1"></a>res_cb_rf <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.01</span>), <span class="cf">function</span>(s) {</span>
<span id="cb9873-17"><a href="fixed-income-securities.html#cb9873-17" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">=</span> <span class="fu">DiscountCurve</span>(params, <span class="fu">list</span>(<span class="at">flat =</span> s), times)</span>
<span id="cb9873-18"><a href="fixed-income-securities.html#cb9873-18" aria-hidden="true" tabindex="-1"></a>  process<span class="sc">$</span>rff <span class="ot">=</span> s</span>
<span id="cb9873-19"><a href="fixed-income-securities.html#cb9873-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ConvertibleFixedCouponBond</span>(bondparams, <span class="at">coupon =</span> <span class="fl">0.05785</span>, process,</span>
<span id="cb9873-20"><a href="fixed-income-securities.html#cb9873-20" aria-hidden="true" tabindex="-1"></a>dateparams)<span class="sc">$</span>NPV</span>
<span id="cb9873-21"><a href="fixed-income-securities.html#cb9873-21" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb9873-22"><a href="fixed-income-securities.html#cb9873-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9873-23"><a href="fixed-income-securities.html#cb9873-23" aria-hidden="true" tabindex="-1"></a><span class="co"># For bond params credit spread</span></span>
<span id="cb9873-24"><a href="fixed-income-securities.html#cb9873-24" aria-hidden="true" tabindex="-1"></a>res_cb_cs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.005</span>), <span class="cf">function</span>(s) {</span>
<span id="cb9873-25"><a href="fixed-income-securities.html#cb9873-25" aria-hidden="true" tabindex="-1"></a>  bondparams<span class="sc">$</span>creditSpread <span class="ot">=</span> s</span>
<span id="cb9873-26"><a href="fixed-income-securities.html#cb9873-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ConvertibleFixedCouponBond</span>(bondparams, <span class="at">coupon =</span> <span class="fl">0.05785</span>, process,</span>
<span id="cb9873-27"><a href="fixed-income-securities.html#cb9873-27" aria-hidden="true" tabindex="-1"></a>dateparams)<span class="sc">$</span>NPV</span>
<span id="cb9873-28"><a href="fixed-income-securities.html#cb9873-28" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb9873-29"><a href="fixed-income-securities.html#cb9873-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9873-30"><a href="fixed-income-securities.html#cb9873-30" aria-hidden="true" tabindex="-1"></a><span class="co"># For conversion ratio</span></span>
<span id="cb9873-31"><a href="fixed-income-securities.html#cb9873-31" aria-hidden="true" tabindex="-1"></a>res_cb_cr <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="dv">1</span>), <span class="cf">function</span>(s) {</span>
<span id="cb9873-32"><a href="fixed-income-securities.html#cb9873-32" aria-hidden="true" tabindex="-1"></a>  bondparams<span class="sc">$</span>conversionRatio <span class="ot">=</span> s</span>
<span id="cb9873-33"><a href="fixed-income-securities.html#cb9873-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ConvertibleFixedCouponBond</span>(bondparams, <span class="at">coupon =</span> <span class="fl">0.05785</span>, process,</span>
<span id="cb9873-34"><a href="fixed-income-securities.html#cb9873-34" aria-hidden="true" tabindex="-1"></a>dateparams)<span class="sc">$</span>NPV</span>
<span id="cb9873-35"><a href="fixed-income-securities.html#cb9873-35" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>Based on those values, we can easily plot the NPV. We just do this for one but we could potentially enlarge this to multiple options at once.</p>
<div class="sourceCode" id="cb9874"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9874-1"><a href="fixed-income-securities.html#cb9874-1" aria-hidden="true" tabindex="-1"></a>vola_CB <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="fl">0.9</span>,<span class="fl">0.01</span>), res_cb_vola))</span>
<span id="cb9874-2"><a href="fixed-income-securities.html#cb9874-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(vola_CB) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Volatility of Stock&quot;</span>, <span class="st">&quot;NPV CB&quot;</span>)</span>
<span id="cb9874-3"><a href="fixed-income-securities.html#cb9874-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9874-4"><a href="fixed-income-securities.html#cb9874-4" aria-hidden="true" tabindex="-1"></a>vola_CB <span class="sc">%&gt;%</span> </span>
<span id="cb9874-5"><a href="fixed-income-securities.html#cb9874-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">Volatility of Stock</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">NPV CB</span><span class="st">`</span>)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb9874-6"><a href="fixed-income-securities.html#cb9874-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;CB NPV value based on volatility&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9874-7"><a href="fixed-income-securities.html#cb9874-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Value NPV&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Volatility&quot;</span>) <span class="sc">+</span></span>
<span id="cb9874-8"><a href="fixed-income-securities.html#cb9874-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;goldenrod&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9874-9"><a href="fixed-income-securities.html#cb9874-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;violetred4&quot;</span>, <span class="st">&quot;khaki3&quot;</span>, <span class="st">&quot;lightsteelblue3&quot;</span>, <span class="st">&quot;dodgerblue4&quot;</span>, <span class="st">&quot;violetred4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb9874-10"><a href="fixed-income-securities.html#cb9874-10" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>, <span class="at">color=</span><span class="st">&quot;grey26&quot;</span>,</span>
<span id="cb9874-11"><a href="fixed-income-securities.html#cb9874-11" aria-hidden="true" tabindex="-1"></a><span class="at">hjust=</span><span class="fl">0.1</span>,</span>
<span id="cb9874-12"><a href="fixed-income-securities.html#cb9874-12" aria-hidden="true" tabindex="-1"></a><span class="at">lineheight=</span><span class="fl">1.2</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),</span>
<span id="cb9874-13"><a href="fixed-income-securities.html#cb9874-13" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb9874-14"><a href="fixed-income-securities.html#cb9874-14" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9874-15"><a href="fixed-income-securities.html#cb9874-15" aria-hidden="true" tabindex="-1"></a><span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9874-16"><a href="fixed-income-securities.html#cb9874-16" aria-hidden="true" tabindex="-1"></a><span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#f7f7f7&quot;</span>), <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9874-17"><a href="fixed-income-securities.html#cb9874-17" aria-hidden="true" tabindex="-1"></a><span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;grey26&quot;</span>, <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9874-18"><a href="fixed-income-securities.html#cb9874-18" aria-hidden="true" tabindex="-1"></a><span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span>  <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">&#39;Swiss Government Bonds&#39;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">color=</span><span class="st">&#39;Difference in Yield&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-267-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="inductive-statistics-and-regression-analysis-fundamentals.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="copulas.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/NikolasAnic/Quantitative-Finance-in-R/edit/master/05-Fixed_Income.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/NikolasAnic/Quantitative-Finance-in-R/blob/master/05-Fixed_Income.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
